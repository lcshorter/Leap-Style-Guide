WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:paste-resources', location = 'js/clipboard-access.js' */
define("confluence-paste/clipboard-access",["jquery","ajs","window","tinymce"],function(f,b,i,j){return function(){var g={initializeEditor:function(){b&&b.Rte&&b.Rte.BootstrapManager?b.Rte.BootstrapManager.addOnInitCallback(function(){var a=b.Rte.getEditor();a?i.MutationObserver&&!f.browser.webkit?(new MutationObserver(function(a){for(var d=0;d<a.length;d++){var b=a[d];if(b.addedNodes.length)for(var c=0;c<b.addedNodes.length;c++)if("img"===b.addedNodes[c].localName){i.setTimeout(g.pasteFromDataURL,
0);return}}})).observe(a.getDoc(),{childList:!0,subtree:!0}):a.onPaste.add(function(a,b){if(g.onPaste(b))return!0;j.dom.Event.cancel(b);return!1}):b.log("Could not getEditor from adapter")}):b.log("Could not initialize pasteHandler on Confluence.Editor")},pasteFromDataURL:function(){var a=f('img[src^="data:image"]:not(".editor-inline-macro")',j.activeEditor.getDoc());f.each(a,function(){var a=this.src,d,e;if(b.DarkFeatures.isEnabled("filestore.direct.upload")&&!b.DarkFeatures.isEnabled("filestore.direct.upload.force.disable")){var a=
a.split(","),c=atob(a[1]),h=c.length;d=c.length;for(a=new Uint8Array(h);h--;)a[h]=c.charCodeAt(h)}else{e="base64";a=a.substring(22,a.length);d=3*a.length/4;c=0;for(h=a.length-1;"="==a[h];h--)c++;d-=c}b.Confluence.Uploader.upload([g.createUploadFile(a,d,e)])});a.remove()},onPaste:function(a){return a&&a.clipboardData?g.pasteFromEvent(a):!0},showClipboardAccessError:function(){(new b.Dialog({width:400,closeOnOutsideClick:!0})).addPanel("alert",f("<div />",{text:"Your browser does not support pasting images from the clipboard."})).addButton("OK",
function(a){a.remove()}).show().updateHeight()},pasteFromEvent:function(a){if(a&&a.clipboardData){if(a.clipboardData.items){a=a.clipboardData.items[0];if(!a||"file"!=a.kind)return!0;a=a.getAsFile();a=g.createUploadFile(a,a.size);b.Confluence.Uploader.upload([a]);return!1}i.setTimeout(function(a){var b=f("img[src^='webkit-fake-url://']",j.activeEditor.getDoc());b.length&&(b.remove(),a.showClipboardAccessError())},0,this)}return!0},createUploadFile:function(a,b,d){var e=new Date,c=e.getMonth()+1;return{fileName:"image"+
e.getFullYear()+"-"+c+"-"+e.getDate()+"_"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds()+".png",fileSize:b,slice:function(b,c){return a.slice(b,b+c)},getAsBinary:function(){return a},getData:function(){return a},encoding:d}}};g.initializeEditor(f);return g}});require("confluence/module-exporter").safeRequire("confluence-paste/clipboard-access",function(f){require("ajs").toInit(f)});
}catch(e){WRMCB(e)};