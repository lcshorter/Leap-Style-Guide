WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/autocomplete-settings.js' */
define("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings",["ajs"],function(b){return{Settings:{},log:function(d){return function(e,f,a){var c=null!=a&&"object"!==typeof a;b.debug(d+" - "+e+" : "+(f||null)+(null!=a?c?" = "+a:" >":""));a&&!c&&b.debug(a)}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings","Confluence.Editor.Autocompleter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/autocomplete-util.js' */
define("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-util",["jquery","confluence-rest/confluence-rest"],function(k,f){var h=function(a,c,g,b,d){var e;a.statusMessage?e=[[{html:a.statusMessage,className:"error"}]]:(a=c?f.REST.makeRestMatrixFromSearchData(a):f.REST.makeRestMatrixFromData(a,b),e=f.REST.convertFromRest(a));g(e,c,function(a,b){d&&typeof d==="function"&&d(e,a,b)})};return{dropdownLink:function(a,c,g){return"<a href='#' class='"+(c||"")+"'><span class='icon "+(g||"")+"'></span><span>"+
a+"</span></a>"},getRestData:function(a,c,g,b,d,e,f){var i=c(b),j=a.settings.cacheManager,c=j.get(b);i?(a=k.ajax({type:"GET",url:i,data:g(a,b),dataType:"json",global:!1,timeout:5E3}),a.done(function(a){j.put(b,a)}),c?h(c,b,d,e,f):(a.done(function(a){h(a,b,d,e,f)}),a.fail(function(a,c){"timeout"==c&&h({statusMessage:"Timeout",query:b},b,d,e)}))):d([],b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-util","Confluence.Editor.Autocompleter.Util");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/autocomplete-control.js' */
define("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-control",["ajs","jquery","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings","document","confluence/property-panel"],function(c,g,z,A,t){var v=function(d,r){var a,e,h=z.log("Autocompleter.Control"),s=require("tinymce"),b={},p=d.selection,u=p.getRng(!0),n=u.startOffset,q=u.startContainer;e=q.nodeValue;var l=r.leadingChar,x=d.getDoc(),m=r.backWords||0,i=z.Settings[l||"["];a=!i||"undefined"===typeof i.preventStartNodes?
"div.code, a[href], img, pre":i.preventStartNodes;if(g("#autocomplete",x).length)return c.debug("init","Autocomplete already exists, returning null."),null;b.backWords=m;b.maxResults=r.maxResults||10;null==e&&(u.collapsed&&n&&q.childNodes[n-1])&&(q=q.childNodes[n-1],n=(e=q.nodeValue)&&e.length||0);var o="";if(null!=e)for(var o=(e+"").substring(0,n),k=q.previousSibling;k&&3===k.nodeType;)o=k.nodeValue+o,k=k.previousSibling;var k=[/([("'<\(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,
/(\/\/)$/],f;if(f=!m)if(f=o){a:{o+=l;f=0;for(var F=k.length;f<F;f++)if(k[f].test(o)){k=!0;break a}k=!1}f=!k}if(f)return h("init","Cursor is in wrong word location to start autocomplete, returning null."),null;if(g(q).closest(a).length)return h("init","Cursor is in wrong node to start autocomplete, returning null."),null;t&&t.current&&(t.shouldCreate=!1,t.destroy());!l&&null==e&&(c.debug("init","No text available for suggestion, range is",u),e="");b.getContainer=function(){return g("#autocomplete",
x)};a="";if(u.collapsed&&m&&e){a=q;e=n;k=function(b,j,c){!j.global&&(j=RegExp(j.source,"g"+"i".slice(0,j.ignoreCase)+"m".slice(0,j.multiLine)));c==null?c=b.length:c<0&&(c=0);for(var b=b.substring(0,c+1),c=-1,a=0,d;(d=j.exec(b))!=null;){c=d.index;j.lastIndex=++a}return c};for(o=0;o<m;o++){f=a.nodeValue.substring(0,e);for(e=k(f,/\s+/,e);-1==e;)if((f=a.previousSibling)&&3===f.nodeType)a=f,(f=f.nodeValue)&&(e=k(f,/\s+/,f.length));else{o=m;break}}e+=1;s.isIE&&1==m?(m=p.getRng(),m.moveStart("character",
e-n),m.select()):(m=p.getRng(!0),m.setStart(a,e),m.setEnd(q,n),p.setRng(m))}a=p.getContent({format:"text"}).replace("\n","");h("init","suggestionHtml",a);n=c("span").attr("id","autocomplete");l&&n.append(c("span").attr("id","autocomplete-trigger").text(l));l=c("span").attr("id","autocomplete-search-text");l.text(c.Rte.HIDDEN_CHAR);n.append(l);p.setNode(n[0]);var w=b.getContainer();b.previousSearchText="";b.settings=i;!1!==i.cache&&!i.cacheManager?i.cacheManager=new c.Confluence.localStorageCacheManager(i.ch):
!1===i.cache&&!i.cacheManager&&(i.cacheManager={get:g.noop,put:g.noop});i=g("#autocomplete-search-text",b.getContainer());l=g(x.createElement("span")).text(a||c.Rte.HIDDEN_CHAR);i.empty().append(l);p.select(l[0],!0);p.collapse();var B=function(c,j){if(b.onBeforeKey&&!b.onBeforeKey(j,b.text())){s.dom.Event.cancel(j);h("before","blocked by onBeforeKey: "+j.keyCode);return false}},C=function(c,j){var a=p.getRng(true),d=b.getContainer(),e=a.startContainer,a=e.parentNode;e.nodeType===3&&(a=a.parentNode);
var f=(e=a?a.parentNode:null)?e.parentNode:null,d=a!==d[0]&&e!==d[0]&&f!==d[0];if(j.keyCode===27||d){h("after","dying because of: "+(d?"outside search span":"escape pressed"));b.die()}else if(b.onAfterKey&&!b.onAfterKey(j,b.text())){s.dom.Event.cancel(j);h("after","blocked by onAfterKey: "+j.keyCode);return false}},D=function(c,a){if(b.onKeyPress&&!b.onKeyPress(a,b.text())){s.dom.Event.cancel(a);h("press","blocked by onKeyPress: "+a.keyCode);return false}},E=function(a,c){if(b.getContainer()[0]!=
c.target.parentNode){h("click","Clicked outside of autocomplete, closing.");b.die()}};d.onKeyDown.addToTop(B);d.onKeyUp.addToTop(C);d.onKeyPress.addToTop(D);d.onClick.addToTop(E);b.word="";r.keepAlias?h("init","No suggestion based on previous or selected text"):b.word=a;c.Rte.showElement(w[0]);i=s.DOM.getPos(w[0]);l=w.height();b.left=i.x;b.top=i.y+l;b.text=function(a){var d=g("#autocomplete-search-text",b.getContainer());if(a!=null){d.html(a);return this}a=c.escapeEntities(d.text());return a.replace(c.Rte.HIDDEN_CHAR,
"")};b.plainText=function(a){var d=g("#autocomplete-search-text",b.getContainer());if(a!=null){d.text(a);return this}a=d.text();return a.replace(c.Rte.HIDDEN_CHAR,"")};var y=function(a,c){var d=b.getContainer();return v.replaceWithTextAndGetRange(d,a,c)};b.replaceWithSelectedSearchText=function(){var a=b.text();h("replaceWithSelectedSearchText",a);y(a,false);return a};b.die=function(a){if(b.dying)c.debug("die","Already dying, returning.");else{b.dying=true;if(t)t.shouldCreate=true;if(b.getContainer().length){h("die",
"Tearing down autocomplete, cleaning up autocompleter");a=(a||r.backWords?"":b.settings.ch)+b.text();u=y(a,true)}setTimeout(function(){h("die","Removing autocomplete-control keyboard listeners.");d.onKeyDown.remove(B);d.onKeyUp.remove(C);d.onClick.remove(E);d.onKeyPress.remove(D)},1);c.Rte.unbindScroll("autocomplete");g(A).unbind("click.autocomplete-outside");this.onDeath&&this.onDeath()}};c.Rte.bindScroll("autocomplete",function(a){c.debug("scrolling:",a);if(c.Rte.isAnyPartShown(w))b.onScroll();
else b.die()});g(A).bind("click.autocomplete-outside",function(a){g(a.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||b.die()});c.Rte.getEditor().onBeforeExecCommand.add(function(a,c){c=="mceConfSavePage"&&b.die()});b.update=function(a){c.Rte.BookmarkManager.storeBookmark();y("",true);this.settings.update(this,a)};b.removeSpan=function(){b.getContainer().remove()};return b};v.removeOrphanedControl=function(){var d=g(c.Rte.getEditor().getDoc()),r=d.find("#autocomplete"),
a;if(!r.length)return null;a=d.find("#autocomplete-trigger").text();d=d.find("#autocomplete-search-text").text();v.replaceWithTextAndGetRange(r,d,!1);return{leadingChar:a,content:d}};v.replaceWithTextAndGetRange=function(d,g,a){if(d.length){var g=g||"",a=a||!g,e=c.Rte.getEditor(),h=d[0].parentNode,s=c.Rte.Content.getChildIndex(h,d[0]),b=a?1:0,a=e.selection.getRng(!0);a.setStart(h,s+b);a.setEnd(h,s+1);d.before(g||c.Rte.HIDDEN_CHAR).remove();e.selection.setRng(a);return a}c.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")};
return v});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-control","Confluence.Editor.Autocompleter.Control");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/autocomplete-manager.js' */
define("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","ajs jquery window confluence/input-driven-dropdown confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings confluence-editor/tinymce3/plugins/autocomplete/autocomplete-control".split(" "),function(e,j,p,q,h,k){h.log("Autocompleter.Manager");var c,a,n=function(m){c=k(e.Rte.getEditor(),m);if(!c)return false;e.trigger("synchrony.stop",{id:"confluence.autocomplete-plugin"});e.trigger("rte-autocomplete-on-start",
{triggerChar:c.settings.ch});var r=j(p).width(),i,g=function(b){var f=j("#autocomplete-dropdown"),d=c.getContainer(),a,m,g,h,l;f.length||(f=e("div").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));a=e.Position.spaceAboveBelow(e.Rte.getEditorFrame(),d);b.find("ol:has(a.menu-header)").addClass("top-menu-item");b.find("ol:empty").hide();f.append(b);g=e.Rte.Content.offset(d);h=Math.max(f.width()+g.left-r+10,0);m=g.left-h-0;b=b.outerHeight(true);l=b+10;
if(i){var k;k=i==1?a.above>=l:a.below>=l;k||(i=null)}if(!i)i=a.below>=l?2:a.above>=l?1:a.below>a.above?2:1;a=f.find(".autocomplete-dropdown-arrow");a.length||(a=j('<div class="autocomplete-dropdown-arrow"></div>'));if(i===1){a.addClass("autocomplete-dropdown-bottom-arrow").css({top:b-1});d=g.top-b-10}else{a.removeClass("autocomplete-dropdown-bottom-arrow").css("top","");d=g.top+d.height()+10}a.css({left:h}).appendTo(f);f.css({position:"absolute",top:d,left:m})};a=new q("inputdriven-dropdown",{onShow:function(b){e.trigger("rte-autocomplete-on-show",
{triggerChar:c.settings.ch});var a=e.Rte.getEditorFrame();a&&a.shim&&a.shim.hide();b.find("a.menu-header").unbind().click(function(b){b.preventDefault();c.die()});this.reset();c.settings.selectFirstItem&&b.find("a:not('.menu-header')").length&&e.dropDown.current.moveDown()},dropdownPlacement:g,onDeath:function(){j("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(b,a){b.preventDefault();var d=j.data(a[0],"properties");d&&typeof d.callback==="function"?d.callback(c):
d.className!=="menu-header"&&c.update(d);e.trigger("rte-autocomplete-on-select",{triggerChar:c.settings.ch,result:d});c.die()},moveHandler:function(b,a){var c=e.dropDown.current;b&&b.find("a").is(".menu-header")&&(a=="up"?c.moveUp():c.moveDown())},className:"autocomplete "+c.settings.dropDownClassName},getDataAndRunCallback:function(b){c&&c.settings.getDataAndRunCallback&&c.settings.getDataAndRunCallback(c,b,function(f,d,e,g){f.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",
name:c.settings.getHeaderText(c,b)}]);f.push(c.settings.getAdditionalLinks(c,b,e));a&&a.show(f,d,g||[d])})},dropDownDelay:c.settings.dropDownDelay});c.onBeforeKey=function(b,a){var c=require("tinymce");if(b.keyCode===40||b.keyCode===38||b.keyCode===13){c.dom.Event.cancel(b);return false}if(b.keyCode===27||b.keyCode===9||b.keyCode===8&&!a){this.die(b.keyCode===8);return false}return true};c.onKeyPress=function(b){var a=require("tinymce"),d=String.fromCharCode(j.browser.msie?b.keyCode:b.which);if(b.keyCode===
13){a.dom.Event.cancel(b);return false}e.indexOf(this.settings.endChars,d)!==-1&&c.die();return true};var h=/\S{2,}/;c.onAfterKey=function(b,f){if(b.keyCode===40||b.keyCode===38||b.keyCode===13){var d=e.dropDown.current;if(!d)return false;if(d.getFocusIndex()==-1&&b.keyCode===13){c.die();c=null;return true}if(!b.which)b.which=b.keyCode;return d.moveFocus(b)}if(!(d=b.keyCode===8&&!f))d=/[\u4E00-\u9FFF]/gi.test(f);(d||h.test(f))&&a.change(f,d);return true};c.onDeath=function(){if(a){a.remove();a.closing=
true}e.trigger("synchrony.start",{id:"confluence.autocomplete-plugin"});e.trigger("rte-autocomplete-on-death",{triggerChar:c.settings.ch})};c.onScroll=function(){a.dd&&g(a.dd.$)};a.change(c.text(),"force");return true},o={getInputDrivenDropdown:function(){return a},triggerListener:function(c,e){var i=require("tinymce");if(e.metaKey)return true;var g=j.browser.msie?e.keyCode:e.which;a&&a.closing&&(a=null);g=String.fromCharCode(g);!a&&g in h.Settings&&n({leadingChar:g})&&i.dom.Event.cancel(e);return true},
shortcutFired:function(e,h){var i=h?0:1;a&&a.closing&&(a=null);if(a){i=h?0:c.backWords+1;c.die();c=null}return n({leadingChar:e,backWords:i})},reattach:function(){var a=k.removeOrphanedControl();a&&o.shortcutFired(a.leadingChar)}};return o});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","Confluence.Editor.Autocompleter.Manager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/autocomplete/editor_plugin_src",["tinymce","confluence/legacy-editor-global-AVOID-IF-POSSIBLE","ajs"],function(a,b,c){return{init:function(a){b.Autocompleter.Settings={};a.onPostRender.add(function(){c.debug("Autocomplete enabled, adding keyPress listener");a.onKeyPress.addToTop(b.Autocompleter.Manager.triggerListener);c.trigger("ready-editor-autocomplete")});a.onUndo.add(b.Autocompleter.Manager.reattach);a.onRedo.add(b.Autocompleter.Manager.reattach)},getInfo:function(){return{longname:"Auto Complete",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/autocomplete/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.AutoComplete",a);b.PluginManager.add("autocomplete",b.plugins.AutoComplete)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-link/autocomplete-settings-links.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-link/autocomplete-settings-links","jquery ajs confluence-link-browser/link-object confluence-link-browser/link-adapter confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/unescape-entities".split(" "),function(m,d,g,j,e,h){return function(){var i=e.Autocompleter,k=function(a){return a?d.contextPath()+"/rest/prototype/1/search.json":d.Meta.get("remote-user")?d.contextPath()+"/rest/prototype/1/session/history.json":null},l=function(a,
b){var c={"max-results":a.maxResults};if(b){c.query=h(b);c.search="name";c.preferredSpaceKey=d.Meta.get("space-key")}return c};e.Autocompleter.Settings["["]={ch:"[",cache:false,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:true,getHeaderText:function(){return "Link suggestions"},getAdditionalLinks:function(a,b,c){if(b){a="Search for &lsquo;{0}&rsquo;";a=d.format(a,b)}else a="Search";
var f=e.LinkBrowser,a=[{className:"search-for",name:a,href:"#",callback:function(a){a.replaceWithSelectedSearchText();a=f.open({panelKey:f.SEARCH_PANEL});a.doSearch(a.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:i.Util.dropdownLink("Insert web link","dropdown-prevent-highlight","editor-icon"),callback:function(a){a.replaceWithSelectedSearchText();f.open({panelKey:f.WEBLINK_PANEL})}}];c&&c(b,a);return a},getDataAndRunCallback:function(a,
b,c){e.Autocompleter.Util.getRestData(a,k,l,b,c,"content",function(a,b,c){if(b){var e;if(!(e=a.length<2)){a=a[1][0].restObj;a=a.type==="page"?a.space.key==d.Meta.get("space-key")&&a.title.toLowerCase()===b.toLowerCase():false;e=!a}e&&c.push({className:"insert-create-page-link",html:i.Util.dropdownLink("Insert link to create page","dropdown-prevent-highlight","editor-icon"),callback:function(a){var c=h(b),c=g.createLinkToNewPage(c,d.Meta.get("space-key"));a.update(c)}})}})},
update:function(a,b){b.restObj&&(b=g.fromREST(b.restObj));j.setLink(b)}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-link/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-link/editor_plugin_src",["tinymce","confluence-editor/tinymce3/plugins/autocomplete-link/autocomplete-settings-links","confluence/legacy-editor-global-AVOID-IF-POSSIBLE"],function(a,b,c){return{init:function(a){a.addCommand("mceConfAutocompleteLink",function(){c.Autocompleter.Manager.shortcutFired("[")});a.addShortcut("ctrl+shift+k",a.getLang("AutoComplete"),"mceConfAutocompleteLink");b()},getInfo:function(){return{longname:"Auto Complete Link",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/autocomplete-link/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.AutoCompleteLink",a);b.PluginManager.add("autocompletelink",b.plugins.AutoCompleteLink)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-media/autocomplete-settings-media.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-media/autocomplete-settings-media","jquery ajs confluence-editor/utils/attachments-insert-utils tinymce confluence/macro-js-overrides confluence-rest/confluence-rest confluence/legacy-editor-global-AVOID-IF-POSSIBLE".split(" "),function(j,d,k,h,i,l,f){return function(){var m=function(c){var b=d.params.attachmentSourceContentId||d.Meta.get("content-id");return c?d.contextPath()+"/rest/prototype/1/search.json":+b?d.contextPath()+"/rest/prototype/1/content/"+
b+"/attachments.json":null},n=function(c,b){var a=d.MacroBrowser.getMacroMetadata("view-file")?[]:["image","word","excel","pdf","powerpoint","multimedia"];return b?{type:"attachment",attachmentType:a,search:"name","max-results":c.maxResults,query:b}:{attachmentType:a,"max-results":c.maxResults}};f.Autocompleter.Settings["!"]={ch:"!",cache:false,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:true,getHeaderText:function(){return d.MacroBrowser.getMacroMetadata("view-file")?"File suggestions":
"Media suggestions"},getAdditionalLinks:function(){var c="Open file library";return[{className:"dropdown-insert-image",html:f.Autocompleter.Util.dropdownLink(c,"dropdown-prevent-highlight","editor-icon"),callback:function(b){b.replaceWithSelectedSearchText();f.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:f.Autocompleter.Util.dropdownLink("Insert other media",
"dropdown-prevent-highlight","editor-icon"),callback:function(b){b.replaceWithSelectedSearchText();h.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(c,b,a){f.Autocompleter.Util.getRestData(c,m,n,b,a,"attachment")},update:function(c,b){d.trigger("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:b});var a=b.restObj,e=l.REST.wikiLink(a),f=a&&a.title||b.name;if(a.thumbnailLink){e.destination&&e.destination.replace(/^\^/,
"");a=j.extend({filename:f,contentId:b.ownerId||a.ownerId},e.params);h.confluence.ImageUtils.insertFromProperties(a)}else{var i=!!d.MacroBrowser.getMacroMetadata("view-file"),g=a.contentType;i&&(!(g&&g==="application/x-shockwave-flash")||g&&(g==="audio/mp3"||g==="video/mp4")||a.niceType!=="Multimedia")?k.insertFilePlaceholder({name:f,page:a.parentTitle,space:a.space?a.space.key:"",date:a.datePath,ownerId:a.ownerId}):this._insertFile(f,b,e)}},_insertFile:function(c,b,a){var e;switch(b.restObj.niceType){case "PDF Document":e=
"viewpdf";break;case "Word Document":e="viewdoc";break;case "Excel Spreadsheet":e="viewxls";break;case "PowerPoint Presentation":e="viewppt";break;case "Multimedia":e="multimedia"}c={page:a.destination.substring(0,a.destination.indexOf("^")),name:c};i.get("viewdoc").beforeParamsRetrieved(c);c.page||delete c.page;e={contentId:d.Meta.get("content-id")||"0",macro:{name:e,params:c,body:""}};h.confluence.MacroUtils.insertMacro(e)}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/autocomplete-media/autocomplete-settings-media");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-media/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-media/editor_plugin_src",["tinymce","confluence/legacy-editor-global-AVOID-IF-POSSIBLE","confluence-editor/tinymce3/plugins/autocomplete-media/autocomplete-settings-media"],function(a,b,c){return{init:function(a){a.addCommand("mceConfAutocompleteImage",function(){b.Autocompleter.Manager.shortcutFired("!")});a.addShortcut("ctrl+shift+m",a.getLang("AutoComplete"),"mceConfAutocompleteImage");c()},getInfo:function(){return{longname:"Auto Complete Media",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/autocomplete-media/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.AutoCompleteMedia",a);b.PluginManager.add("autocompletemedia",b.plugins.AutoCompleteMedia)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-media/autocomplete-analytics-media.js' */
require(["ajs"],function(a){a.bind("init.rte",function(){a.bind("rte-autocomplete-on-show",function(d,c){"!"===c.triggerChar&&a.trigger("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})});a.bind("rte-autocomplete-on-insert",function(d,c){if("!"===c.triggerChar){var b=c.selectedFile;b&&b.name&&(b={extension:b.name.split(".").pop(),type:"media"},a.trigger("analytics",{name:"confluence.editor.autocomplete.insert",data:b}))}})});a.bind("rte-destroyed",function(){a.unbind("rte-autocomplete-on-insert");
a.unbind("rte-autocomplete-on-show")})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-macro/autocomplete-settings-macros.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-macro/autocomplete-settings-macros",["jquery","underscore","ajs","tinymce","confluence/legacy-editor-global-AVOID-IF-POSSIBLE"],function(h,n,b,e,d){return function(){function j(c){h("#autocomplete-dropdown .top-menu-item").spin(c)}var f=function(c,a){var g=a.presetMacroMetadata;c.replaceWithSelectedSearchText();g?b.MacroBrowser.hasRequiredParameters(g)||g.alwaysShowConfig?e.confluence.macrobrowser.macroBrowserToolbarButtonClicked(a):(b.Rte.BookmarkManager.storeBookmark(),
e.confluence.MacroUtils.insertMacro({contentId:b.Meta.get("content-id")||"0",macro:{name:g.macroName,body:""}})):e.confluence.macrobrowser.macroBrowserToolbarButtonClicked(a)},k=function(c){if(c.hidden&&!b.MacroBrowser.isHiddenMacroShown(c))return null;var a={className:"autocomplete-macro-"+c.macroName,callback:function(b){f(b,{ignoreEditorSelection:!0,presetMacroMetadata:c})}};c.icon?(a.name=c.title,a.href="#",a.icon=(c.icon.relative?b.params.staticResourceUrlPrefix:"")+c.icon.location):a.html=d.Autocompleter.Util.dropdownLink(c.title);
return a};d.Autocompleter.Settings["{"]={ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return "Macro suggestions"},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:d.Autocompleter.Util.dropdownLink("Open macro browser","dropdown-prevent-highlight","editor-icon"),callback:function(b){var a=b.text();f(b,{searchText:a})}}]},
getDataAndRunCallback:function(c,a,g){function e(a){a.preventDefault();a.stopPropagation();b.trigger("analytics",{name:"autocomplete-macrobrowser.load-retry"});b.MacroBrowser.reset();b.MacroBrowser.preLoadMacro();i.getDataAndRunCallback.apply(i,f)}var d=b.MacroBrowser.getMetadataPromise(),i=this,f=arguments;i.alreadyBinded||(i.alreadyBinded=!0,d.always(function(){var d;if(a){d=[];for(var e=b.MacroBrowser.searchSummaries(a,{keywordsField:"keywordsNoDesc"}),f=0,o=e.length;f<o;f++){var l=k(e[f]);if(l&&
d.push(l)==c.maxResults)break}}else{var p=b.MacroBrowser.metadataList,m=[];h("#macro-insert-list li").each(function(){var b=h(this),a=n.find(p,function(a){return a.macroName===b.attr("data-macro-name")});a&&(a=k(a))&&m.push(a)});d=m}j(!1);g([d],a);i.alreadyBinded=!1}),d.fail(function(){b.trigger("analytics",{name:"autocomplete-macrobrowser.fail-to-load"});b.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:"Failed to get macro details",body:'<p><a id="macro-retry-link" href="#">'+
"Try again"+"</a></p>"});h("#macro-retry-link").click(e);h("#autocomplete-dropdown ol:nth(1)").show()}));"pending"===d.state()&&(g([],a),j(!0))},update:function(){throw Error("All items in the Macro Autocomplete dropdown must have a callback function");}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-macro/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-macro/editor_plugin_src",["tinymce","confluence-editor/tinymce3/plugins/autocomplete-macro/autocomplete-settings-macros"],function(b,a){return{init:function(){a()},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/autocomplete-macro/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.AutoCompleteMacro",b);a.PluginManager.add("autocompletemacro",a.plugins.AutoCompleteMacro)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/searchreplace/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/searchreplace/editor_plugin_src",["jquery","ajs","confluence/legacy-editor-global-AVOID-IF-POSSIBLE","document","tinymce"],function(f,g,c,l,e){var i=null,j=!1,h=function(c,b){b.preventDefault();b.stopPropagation()},m=function(c,b){h(c,b);var a=b.which;a||(a=b.charCode?b.charCode:b.keyCode);48>a||i.push(a)},k=function(c){var b=f("#rte-button-searchreplace a");b.length&&(c?b.unbind("click",!1):b.bind("click",!1))};return{init:function(d){d.addCommand("mceSearchReplaceToolbar",
function(){if(!j){j=!0;var b=f("#rte-button-searchreplace"),a=!b.hasClass("active"),d=f("body"),d=!d.hasClass("no-tools")||d.hasClass("no-tools-toolbars-visible");a?(b.addClass("active"),c.searchManager||(c.searchManager=new c.SearchManager("searchreplace")),f(l).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:c.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:d,onVisible:function(){var a;a=g.Rte.getEditor();a.onKeyDown.remove(m);a.onKeyPress.remove(h);a.onKeyUp.remove(h);
var b="";for(a=0;a<i.length;a++){var d;d=i[a];if(d>65535){d=d-65536;d=String.fromCharCode(55296+(d>>10),56320+(d&1023))}else d=String.fromCharCode(d);b=b+d}a=b.toLowerCase();c.searchManager.onVisible(a);k(true);j=false;c.searchManager.initialised=true}}).trigger("enableContextToolbarRow.Toolbar"),b=g.Rte.getEditor(),i=[],b.onKeyDown.add(m),b.onKeyPress.add(h),b.onKeyUp.add(h),c.searchManager.init(),k(!1)):(b.removeClass("active"),c.searchManager.onHide(),f(l).trigger("removeContextToolbarRow.Toolbar",
{id:"searchreplace",animate:d,onHide:function(){f(l).trigger("contextToolbarRowRemoved.Toolbar");k(!0);j=!1;c.searchManager.initialised=!1}}),k(!1),e.isGecko||frames.wysiwygTextarea_ifr.focus(),e.activeEditor.focus())}});d.addCommand("mceConfSearch",function(b,a){c.searchManager&&(a=a||{},a.backwards&&!e.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button")?c.searchManager.focus():!a.backwards&&!e.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button")?
c.searchManager.focus():c.searchManager.find(a.backwards,a.onFound,a.onNotFound))});d.addCommand("mceConfReplace",function(b,a){c.searchManager&&(a=a||{},e.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?c.searchManager.replace(a.onFound,a.onNotFound):a.onInactive&&a.onInactive())});d.addCommand("mceConfReplaceAll",function(b,a){c.searchManager&&(a=a||{},e.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&c.searchManager.replaceAll(a.onReplaced,
a.onNotReplaced))});d.addCommand("mceConfSearchClose",function(){c.searchManager&&d.execCommand("mceSearchReplaceToolbar",!1,null)});d.addButton("searchreplace",{title:"searchreplace.search_desc",cmd:"mceSearchReplaceToolbar"});e.isIE8||d.addShortcut("ctrl+f","searchreplace.search_desc",function(){c.searchManager&&c.searchManager.isVisible()?c.searchManager.focus():d.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",
authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:e.majorVersion+"."+e.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/searchreplace/editor_plugin_src",function(f){var g=require("tinymce");g.create("tinymce.plugins.AtlassianSearchReplacePlugin",f);g.PluginManager.add("searchreplace",g.plugins.AtlassianSearchReplacePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/searchreplace/searchreplace.js' */
define("confluence-editor/tinymce3/plugins/searchreplace/searchreplace",["jquery","tinymce","confluence/api/browser","confluence-editor/tinymce3/plugins/searchreplace/search-ms-edge","confluence/editor-notifications"],function(j,d,w,u,s){var v=w(window.navigator.userAgent),q=function(a){var b=null,c=null,h=null,j=null,l=null,o=function(d,m){m.content=m.content.replace(RegExp('<mark data-searching class="find-current">',"g"),"");m.content=m.content.replace(RegExp("</mark>","g"),"")};return{initialised:!1,
find:function(d,m,a){var i=b.getFindInput().val();(d=h.findText(i,!0,d))&&m?m():!d&&a&&a()},replace:function(d,a){var c=b.getFindInput(),i=b.getReplaceInput(),p="";i&&(p=i.val());(c=h.replaceText(c.val(),p,!0))&&d?d():!c&&a&&a()},replaceAll:function(d,a){var c=b.getFindInput(),i=b.getReplaceInput(),p="";i&&(p=i.val());(c=h.replaceAll(c.val(),p))&&d?d():!c&&a&&a()},focus:function(){b.focusFindTextBox()},isVisible:function(){return null!=b},init:function(){b=q.UI(a,j,l);c=new q.MarkManager;c.addListener(b);
h=null;h=d.isIE?new q.implIE(b):new q.impl(b,c);d.activeEditor.undoManager.onAdd.add(o)},onVisible:function(d){if(null!=d&&0<d.length){var a=b.getFindInput(),c=a.val();a.val(c+d)}b.onVisible()},onHide:function(){j=b.getFindInput().val();l=b.getReplaceInput().val();h.destroy();h=null;b.destroy();b=null;c.destroy();c=null;d.activeEditor.undoManager.onAdd.remove(o)},_clearSavedValues:function(){l=j=null}}};q.utils={moveCursorToEnd:function(a){if(d.isIE)a=a.createTextRange(),a.execCommand("SelectAll"),
a.move("textedit"),a.select();else if(d.isGecko){var b=j(a).val().length;a.setSelectionRange(b,b)}},createTextRange:function(d,b){return d.selection?d.selection.createRange():b.getBody().createTextRange()}};q.impl=function(a,b){var c=new d.html.Writer,h=b,j=-1,l=function(a,b,i){function c(){h.markCurrentlySelectedRange();return!0}function k(){h.removeCurrentMark(!0);d.activeEditor.selection.isCollapsed()||d.activeEditor.selection.collapse();return!1}if(!a)return!1;var e=d.activeEditor,g=e.selection,
f=e.getWin();h.isCursorAtCurrentMark()&&(g=h.selectCurrentMark());g.isCollapsed()||g.collapse(i);if(d.isGecko)return f.find(a,!1,i)?c():b?(g.select(e.getBody(),!1),g.collapse(!i),l(a,!1,i)):k();if(v.isMSEdge()){if(a=u.search(g,a,j,e.getBody(),i),j=a[1],a[0])return c()}else return f.find(a,!1,i,!0,!1,!1,!1)?c():k()},o=function(a){var b=d.activeEditor;c.text(a);b.selection.setContent(c.getContent(),{format:"raw"});c.reset();b.selection.collapse(!0)},n={};n.findText=l;n.replaceText=function(a,b,i){if(!h.hasCurrentMark())return l(a,
i);(b=h.replaceCurrentMark(b))&&d.activeEditor.selection.select(b);return l(a,i)};n.replaceAll=function(a,b){var i=d.activeEditor,c=i.selection,k=i.getWin();h.removeCurrentMark(!1);i.execCommand("selectAll");i.selection.collapse(!0);var e=0;if(v.isMSEdge())for(k=-1;;)if(k=u.search(c,a,k,i.getBody(),!1),k[0])k=k[1],o(b),e++;else break;else for(;k.find(a,!1,!1,!1,!1,!1,!1);)o(b),e++;i.undoManager.add();0===e?s.notify("info",i.getLang("searchreplace_dlg.notfound")):1===e?s.notify("success",i.getLang("searchreplace_dlg.allreplacedsingular")):
1<e&&(i=i.getLang("searchreplace_dlg.allreplacedplural"),s.notify("success",i.replace("{0}",e)));return e};n.destroy=function(){c=h=null};return n};q.implIE=function(a){var b={},c=a,h=null,t=new d.html.Writer,l=q.utils.createTextRange,o=function(a,p,k){if(!a)return!1;var e=d.activeEditor,g=e.getDoc(),f=b.storedRange=b.storedRange||g.body.createTextRange();e.focus();h&&h.select();e.selection.collapse(!k);m();k&&h&&(g=g.body.createTextRange(),g.moveToElementText(j("p:first",e.getBody())[0]),f.setEndPoint("StartToStart",
g),g=h.text,g.length&&(g=g.replace(/s+$/,""),g.length&&f.moveEnd("character",-g.length)),g=f.text.length,f.moveEnd("word",-1),f.text.length>=g&&f.moveEnd("character",-1),f.select(),f.collapse(!1));h=null;if(f.findText(a,k?-1:1,0))return f.scrollIntoView(),a=f,a.pasteHTML('<mark data-searching class="find-current">'+a.htmlText+"</mark>"),c.marked(),p=d.activeEditor,p.onChange.add(n),p.onBeforeSetContent.add(n),f=a,f.select(),h=f,!0;if(p)return e.selection.select(d.activeEditor.getBody(),!0),e.selection.collapse(!k),
o(a,!1,k);b.storedRange=null},n=function(){m()},m=function(){var a=d.activeEditor;a.onChange.remove(n);a.onBeforeSetContent.remove(n);var a=d.activeEditor,b=j("mark",a.getDoc());if(b.length){var k=!1,e=a.selection.getRng(!0).commonAncestorContainer;j(e).closest("mark").length&&(k=!0);b.each(function(a,f){var e=j(f);e.contents().each(function(a,f){e.before(f)})}).remove();k&&a.execCommand("RemoveFormat")}c.markRemoved()},r=function(){m()};b.findText=o;b.replaceText=function(a,b,c){var e=d.activeEditor;
if(h){var g=e.getDoc().createTextNode(b),f=j("mark",e.getDoc());f.parent()[0].replaceChild(g,f[0]);e.undoManager.add();f=e.getDoc().createElement("mark");f.setAttribute("class","current");f.dataset.searching=!0;g.parentNode.insertBefore(f,g);f.appendChild(e.getDoc().createTextNode(b));f.parentNode.removeChild(g)}return o(a,c)};b.replaceAll=function(a,b){var c=d.activeEditor,e=c.selection;c.getWin();var g=c.undoManager,f=c.getDoc();m();e.select(c.getBody(),!1);e.collapse(!0);c.focus();f=l(f,c);for(e=
0;f.findText(a,1,0);)f.scrollIntoView(),f.select(),t.text(b),c.selection.setContent(t.getContent(),{format:"raw"}),t.reset(),e++,f.moveStart("character",b.length);g.add();0==e?s.notify("info",c.getLang("searchreplace_dlg.notfound")):1==e?s.notify("success",c.getLang("searchreplace_dlg.allreplacedsingular")):1<e&&(c=c.getLang("searchreplace_dlg.allreplacedplural"),s.notify("success",c.replace("{0}",e)));return e};b.destroy=function(){d.activeEditor.onBeforeGetContent.remove(r);m();t=h=c=null};d.activeEditor.onBeforeGetContent.add(r);
return b};q.UI=function(a,b,c){var h=null,t=q.utils.moveCursorToEnd;d.activeEditor&&(d.activeEditor.plugins&&d.activeEditor.plugins.customtoolbar)&&(h=d.activeEditor.plugins.customtoolbar.getToolbarRow(a));var l=function(){var a=j(".toolbar-find-input",h);return!a.length?null:a},o=function(){var a=j(".toolbar-replace-input",h);return!a.length?null:a},n=function(a){a?(d.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),d.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):
(d.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),d.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},m=function(a){var d=l(),f;f=j(".search-toolbar-find-next-button",h).closest(".aui-button");f=f.length?f:null;f.toggleClass("default-action",a&&0<d.val().length)},r=function(a){var b=d.activeEditor.plugins.customtoolbar;a?b.enableToolbarButton("search-toolbar-replace-button"):b.disableToolbarButton("search-toolbar-replace-button")},
i=function(a){var b=d.activeEditor.plugins.customtoolbar;a?b.enableToolbarButton("search-toolbar-replaceall-button"):b.disableToolbarButton("search-toolbar-replaceall-button")},a={};a.getFindInput=l;a.getReplaceInput=o;a.focusFindTextBox=function(){top.focus();l().focus()};a.onVisible=function(){var a=l();a.focus();0<a.val().length&&(t(a[0]),n(!0),i(!0))};a.destroy=function(){};a.marked=function(){r(!0)};a.markRemoved=function(){r(!1)};var p=l(),k=!1;b&&b.length&&(p.val(b),k=!0);c&&c.length&&o().val(c);
b=function(a,b){a&&(d.isIE9?a[0].attachEvent("onpropertychange",b):a.bind(d.isIE8?"propertychange":"input",b))};c=l();b(c,function(a){if(a.type==="input"||a.type==="propertychange"){a=l();a=a!=null&&a.val().length>0;n(a);m(a)}});b(c,function(){var a=l();i(a&&a.val())});j(h).focusin(function(){m(true)}).focusout(function(){m(false)});c.focus(function(){m(true)});n(k);i(k);r(!1);return a};q.MarkManager=function(){var a=null,b=new d.html.Writer,c=null,h=[],q=function(){n()},l=function(){if(!a)return null;
var f=d.activeEditor;f.selection.select(a[0]);return f.selection},o=function(f){e();if(m(a,f)||c&&d.activeEditor.selection.getRng(!0).toString()==c)c=a=null,j.each(h,function(a,f){f.markRemoved()})},n=function(){e();j("mark",d.activeEditor.getDoc()).each(function(a,b){m(j(b),!1)});c=a=null;j.each(h,function(a,b){b.markRemoved()})},m=function(a,b){var c=d.activeEditor.selection.getRng(!0);if(!a)return!1;var e=a[0];if(c.intersectsNode)c=c.intersectsNode(e);else{var h=d.activeEditor.getDoc().createRange();
h.selectNodeContents(e);c=0>=c.compareBoundaryPoints(Range.START_TO_END,h)||0<=c.compareBoundaryPoints(Range.END_TO_START,h)?!1:!0}var g=null,i=null;a.contents().each(function(b,c){a.before(c);g||(g=c);i=c});if(c||b)c=d.activeEditor.selection.getRng(!0),c.setStartBefore(g),c.setEndAfter(i),b||c.collapse(!1),d.activeEditor.selection.setRng(c);a.remove();return!0},r=function(){if(a)return!0;if(c)return d.activeEditor.selection.getRng(!0).toString()==c},i=function(){n()},p=function(){e();j.each(h,function(a,
b){b.markRemoved()})},k=function(a){var b=d.activeEditor;b.onChange.add(q);b.onBeforeSetContent.add(q);a&&(b.onClick.add(p),b.onDblClick.add(p))},e=function(){var a=d.activeEditor;a.onChange.remove(q);a.onBeforeSetContent.remove(q);a.onClick.remove(p);a.onDblClick.remove(p)},g={markCurrentlySelectedRange:function(){var b=d.activeEditor;if(a){var e=b.selection.getBookmark();o(!1);b.selection.moveToBookmark(e)}c=null;e=b.selection.getRng(!0);a=j('<mark data-searching class="find-current"></mark>',b.getDoc());
try{e.surroundContents(a[0]),k(!1)}catch(g){1==g.code&&(c=e.toString(),a=null,k(!0))}j.each(h,function(a,b){b.marked()});c||l().collapse()}};g.removeCurrentMark=o;g.removeAllMarks=n;g.selectCurrentMark=l;g.isCursorAtCurrentMark=function(){if(!a)return!1;var b=d.activeEditor.selection;b.isCollapsed()||b.collapse();var c=b.getRng(!0);if(3===c.startContainer.nodeType)return c.startContainer.parentNode.normalize(),c.startContainer.nextSibling===a[0]||c.startContainer.previousSibling===a[0];if(1===c.startContainer.nodeType)return b=
c.startContainer.childNodes,c=c.startOffset,0<c&&b[c-1]===a[0]||c+1<b.length&&b[c+1===a[0]]?!0:!1};g.hasCurrentMark=r;g.replaceCurrentMark=function(c){var e;a||!r()?e=!1:(e=d.activeEditor,b.text(c),e.selection.setContent(b.getContent(),{format:"raw"}),b.reset(),e.undoManager.add(),o(!1),e=!0);if(e||!a)return null;var g=[];a.contents().each(function(a,b){g.push(b)});o(!1);e=d.activeEditor;for(var c=j(g[0]).before(e.getDoc().createTextNode(c))[0].previousSibling,h=g.length-1;0<=h;h--)j(g[h]).remove();
e.undoManager.add();return c};g.addListener=function(a){h.push(a)};g.destroy=function(){o(!0);d.activeEditor.onBeforeGetContent.remove(i)};d.activeEditor.onBeforeGetContent.add(i);return g};return q});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/searchreplace/searchreplace","Confluence.Editor.SearchManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/searchreplace/search-toolbar.js' */
define("confluence-editor/tinymce3/plugins/searchreplace/search-toolbar",["jquery","tinymce","confluence/legacy-editor-global-AVOID-IF-POSSIBLE"],function(f,b,d){return{initContextToolbars:function(r,c){var h=function(a){if(b.isIE)a=a.createTextRange(),a.execCommand("SelectAll"),a.move("textedit"),a.select();else if(b.isGecko){var c=f(a).val().length;a.setSelectionRange(c,c)}},g=function(a){top.focus();b.activeEditor.plugins.customtoolbar.focusToolbarButton(a)},e=function(){top.focus();var a=f("#search-toolbar-find-text");
a.focus();h(a[0])},i=function(){top.focus();var a=f("#search-toolbar-replace-text");a.focus();h(a[0])},k=function(){b.isIE&&frames.wysiwygTextarea_ifr.focus();if(b.isIE||b.isGecko){var a=b.activeEditor;a.focus();a.selection.select(a.getBody());a.selection.collapse(!1);a.focus()}},l=new d.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:c.getLang("searchreplace_dlg.findlabel"),name:"find",keydown:function(a){!b.isIE8&&(a.ctrlKey||b.isMac&&a.metaKey)&&70===a.which?a.preventDefault():13===
a.which?(a.preventDefault(),b.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:e,onNotFound:e},{skip_undo:!0})):27===a.which&&(a.preventDefault(),b.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0}))},cssClass:"toolbar-find-input"}),m=new d.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:c.getLang("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(a){!b.isIE8&&(a.ctrlKey||b.isMac&&a.metaKey)&&70===a.which?a.preventDefault():13===
a.which?(a.preventDefault(),b.activeEditor.execCommand("mceConfReplace",!1,{onFound:i,onNotFound:e,onInactive:function(){b.activeEditor.execCommand("mceConfSearch",false,{backwards:false,onFound:i,onNotFound:e},{skip_undo:true})}},{skip_undo:!0})):27===a.which&&(a.preventDefault(),b.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0}))},cssClass:"toolbar-replace-input"}),n=new d.Toolbar.Components.TextButton({text:c.getLang("searchreplace_dlg.findprevious"),click:function(){c.execCommand("mceConfSearch",
!1,{backwards:!0,onFound:function(){top.focus();g("search-toolbar-find-previous-button")},onNotFound:e},{skip_undo:!0})},textClass:"search-toolbar-find-previous-button"}),j=new d.Toolbar.Components.TextButton({text:b.isIE?c.getLang("searchreplace_dlg.findlabel"):c.getLang("searchreplace_dlg.findnext"),click:function(){c.execCommand("mceConfSearch",!1,{backwards:!1,onFound:function(){top.focus();g("search-toolbar-find-next-button")},onNotFound:e},{skip_undo:!0})},textClass:"search-toolbar-find-next-button"}),
o=new d.Toolbar.Components.TextButton({text:c.getLang("searchreplace_dlg.replace"),click:function(){c.execCommand("mceConfReplace",!1,{onFound:function(){top.focus();g("search-toolbar-replace-button")},onNotFound:e},{skip_undo:!0})},textClass:"search-toolbar-replace-button"}),p=new d.Toolbar.Components.TextButton({text:c.getLang("searchreplace_dlg.replaceall"),click:function(){c.execCommand("mceConfReplaceAll",!1,{onReplaced:k,onNotReplaced:e})},textClass:"search-toolbar-replaceall-button"}),q=new d.Toolbar.Components.Button({text:c.getLang("searchreplace_dlg.close"),
iconClass:"icon-close",click:function(){c.execCommand("mceConfSearchClose",!1,null)}});return{Buttons:[new d.Toolbar.Components.Group([q],{groupClass:"close"}),new d.Toolbar.Components.Group([l,m],{groupClass:"no-separator"}),new d.Toolbar.Components.Group(b.isIE?[j]:[n,j]),new d.Toolbar.Components.Group([o,p])]}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/searchreplace/search-toolbar",function(f){var b=require("jquery"),d=require("document");b(d).bind("initContextToolbars.Toolbar",function(b,c){Confluence.Editor.searchToolbar=f.initContextToolbars(b,c)})});
}catch(e){WRMCB(e)};