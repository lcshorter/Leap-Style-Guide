WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/flextofullsize/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/flextofullsize/editor_plugin_src",["jquery","window","tinymce"],function(a,e,h){var i,g,c=function(){var d=a("#wysiwyg").is(":hidden")?a("#preview"):a("#wysiwyg");g=d.find("iframe");var b=a("#header-precursor"),c=a(e).height(),f=b.offset().top+b.height()+a("#header").height();a("#content.edit").height(c-f);setTimeout(function(){if(a("#preview").is(":hidden"))g.height(0).height(d.height());else{a("#content.edit").height("auto");var b=a("#savebar-container").height();
f+=a("#editor-precursor").height()+a("#conflict-wrapper").height();g.height(c-f-b-4)}},1)};return{init:function(d){d.onInit.add(function(){var b;a(d.getBody()).addClass("fullsize");if(h.isIE||h.isOpera)b=d.getWin(),i=a(b.parent),b=a(b.parent.document),a("body").css({overflow:"hidden"}),i.bind("resize.resizeplugin",function(){c()}),b.bind("messageClose",function(){setTimeout(c,0)}),b.bind("resize.resizeplugin",function(a,b){c(b&&b.height)}),b.bind("mode-changed",function(){c()}),d.onChange.add(function(){c()}),
d.onInit.add(function(){c()})})},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/flextofullsize/editor_plugin_src",function(a){var e=require("tinymce");e.create("tinymce.plugins.flextofullsizeplugin",a);e.PluginManager.add("flextofullsize",e.plugins.flextofullsizeplugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'i18n/translations.i18n.js' */
define("confluence-editor/i18n/translations.i18n",["ajs"],function(a){return{popup_blocked:"The browser has blocked a popup opened by the Editor.",ctrl_key:"Ctrl",shift_key:"Shift",searchreplace:{search_desc:"Find",replace_desc:"Find/Replace"},searchreplace_dlg:{allreplacedplural:"{0} replacements were made",allreplacedsingular:"1 replacement was made",
notfound:"No replacements were made",findlabel:"Find",replacelabel:"Replace",findnext:"Next",findprevious:"Previous",replace:"Replace",replaceall:"Replace all",close:"Close"},
advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"Emoticons"},emotions_dlg:{title:"Insert emoticon",desc:"Emoticons",smile:"Smile :)",sad:"Sad :(",tongue:"Tongue :p",biggrin:"Big grin :D",wink:"Wink ;)",
thumbs_up:"Thumbs up (y)",thumbs_down:"Thumbs down (n)",information:"Info (i)",check:"Tick (/)",error:"Error (x)",warning:"Warning (!)",add:"Plus (+)",forbidden:"Minus (-)",help_16:"Question mark (?)",
lightbulb_on:"Lightbulb on (on)",lightbulb:"Lightbulb off (off)",star_yellow:"Yellow star (*y)",star_red:"Red star (*r)",star_green:"Green star (*g)",star_blue:"Blue star (*b)",heart:"Heart \u003c3",broken_heart:"Broken heart \u003c/3"},confluence:{conf_macro_browser:"Macro",
conf_macro_browser_desc:"Insert macro",conf_image:"Image",confimage_desc:"Insert image",conf_file:"Files and images",confifile_desc:"Insert files and images",conf_link:"Link",conflink_desc:"Insert link",conf_table:"Table",
conf_wikimarkup:"Markup",conf_wikimarkup_desc:"Insert markup",conf_wikimarkup_errors:"Wiki markup conversion errors",conf_wikimarkup_timeout:"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.",conf_wikimarkup_hint:"Hint: you can also enter wiki markup directly in the editor, where it will be formatted as you type.",conf_wikimarkup_markdown_label:"Markdown",
conf_wikimarkup_confluence_label:"Confluence wiki",conf_shortcuts_help_desc:"Keyboard shortcuts help",conf_insert_button_title:"Insert"},table:{desc:"Insert table",row_before_desc:"Insert row before",row_after_desc:"Insert row after",delete_row_desc:"Remove row",
numbering_column_desc:"Insert numbering column",responsive:"Responsive",responsive_tooltip:"Table columns get wider as you add content. Drag column borders to set width relative to each other and the page.",fixed_width:"Fixed width",fixed_width_tooltip:"Drag column borders to set width. The table always appears at the width you set.",col_before_desc:"Insert column before",col_after_desc:"Insert column after",col_copy_desc:"Copy table column",
col_paste_desc:"Paste table column",col_cut_desc:"Cut table column",delete_col_desc:"Remove column",split_cells_desc:"Split merged table cells",merge_cells_desc:"Merge table cells",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"Paste table row",
paste_row_after_desc:"Paste row after",cut_row_desc:"Cut table row",copy_row_desc:"Copy table row",del:"Remove table",row:"Row",col:"Column",cell:"Cell",row_highlight:"Heading row",col_highlight:"Heading column",selection_highlight:"Change cell colour",
invalid_table_field:"Rows and columns must both be numbers greater than zero.",table_more_heading:"Table settings",cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",row_after_desc_shortcut:"Alt+\u2193"},
advanced:{style_select:"tinymce.advanced.style_select",font_size:"tinymce.advanced.font_size",fontdefault:"tinymce.advanced.fontdefault",block:"Format",paragraph:"Paragraph",pre:"Preformatted",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",
h6:"Heading 6",blockquote:"Quote",code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"Bold",italic_desc:"Italic",underline_desc:"Underline",striketrough_desc:"Strikethrough",
justifyleft_desc:"Align left",justifycenter_desc:"Align center",justifyright_desc:"Align right",justifyfull_desc:"Align full",bullist_desc:"Bullet list",numlist_desc:"Numbered list",tasklist_desc:"Task list",outdent_desc:"Outdent",
indent_desc:"Indent",undo_desc:"Undo",redo_desc:"Redo",link_desc:"tinymce.advanced.link_desc",unlink_desc:"Unlink",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",sub_desc:"Subscript",
sup_desc:"Superscript",hr_desc:"Horizontal rule",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"Select text colour",backcolor_desc:"tinymce.advanced.backcolor_desc",charmap_desc:"Symbol",visualaid_desc:"tinymce.advanced.visualaid_desc",anchor_desc:"tinymce.advanced.anchor_desc",
cut_desc:"tinymce.advanced.cut_desc",copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"Help",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",newdocument:"tinymce.advanced.newdocument",
toolbar_focus:"tinymce.advanced.toolbar_focus",more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",h5_shortcut:"Ctrl+5",
h6_shortcut:"Ctrl+6",blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"[ then ]",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},colorpicker:{more_colors:"More colours",
title:"Select a colour",picker_tab:"Picker",picker_title:"Colour picker",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"Colour",name:"tinymce.colorpicker.name",apply:"tinymce.colorpicker.apply"},
hints:{drafts:"Hint: Confluence saves drafts automatically. If you ever lose a window, recover your work from the \"Username -\u003e Drafts\" menu.",dnd:"Hint: you can drag and drop images and Office files from your computer right into this editor.",insert_link_recently_viewed:"Hint: type \"\u003cstrong\u003e[\u003c/strong\u003e\" to see a list of suggested pages and insert a link.",insert_link_search:"Hint: type \"\u003cstrong\u003e[\u003c/strong\u003e\" and part of a page title to find and link to that page.",insert_link_end:"Hint: press \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e after a word to find and link to relevant pages. Press it again for more suggestions.",insert_link_newpage:"Hint: type \"\u003cstrong\u003e[\u003c/strong\u003e\" and the title of a new page you wish to create, to see an insert link suggestion.",insert_link_user_mention:"Hint: you can mention somebody in Confluence by typing \"\u003cstrong\u003e@\u003c/strong\u003e\" and then their name.",insert_image_on_page:"Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" to see images attached to the page and insert one of them.",
insert_image_search:"Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" and part of an image name to find and insert the image.",insert_image_end:"Hint: press \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e after a word to find and insert relevant images.",insert_wikimarkup:"Hint: the Editor will automatically convert wiki markup as you type it.",insert_wikimarkup_dialog:"Hint: press \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e to open the Wiki Markup dialog.",insert_link:"Hint: press \u003cstrong\u003eCtrl+K\u003c/strong\u003e to open the link browser.",insert_image:"Hint: press \u003cstrong\u003eCtrl+M\u003c/strong\u003e to open the image browser.",insert_macro:"Hint: press \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e to open the macro browser.",insert_macro_toc:"Hint: Let Confluence generate you a table of contents for this page. Use \"Insert -\u003e Table of contents\"",
insert_bullet_list:"Hint: press \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e to start a bullet list.",insert_numbered_list:"Hint: press \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e to start a numbered list.",insert_heading:"Hint: press \u003cstrong\u003eCtrl+1\u003c/strong\u003e to create a heading level 1, \u003cstrong\u003eCtrl+2\u003c/strong\u003e for heading level 2 and so on.",insert_table:"Hint: press \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e to insert a table.",table_rows_copy:"Hint: press \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e to copy a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",table_rows_cut:"Hint: press \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e to cut a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",insert_newline:"Hint: Type \u003cstrong\u003eShift+Enter\u003c/strong\u003e to insert a new paragraph without spacing",autoformat_heading1:"Hint: Type \"\u003cstrong\u003eh1. Title\u003c/strong\u003e\" to quickly insert a Heading 1.",
autoformat_heading3:"Hint: Type \"\u003cstrong\u003eh3. Title\u003c/strong\u003e\" to quickly insert a Heading 3.",autoformat_code:"Hint: Type \"\u003cstrong\u003e{{code}}\u003c/strong\u003e\" to quickly insert monospaced text."},auiwindowmanager:{cancel:"Cancel",ok:"OK"},propertypanel:{links_goto:"Go to link",links_edit:"Edit",links_unlink:"Unlink",links_goto_disabled_tooltip:"This link goes to content on the page you are editing",
links_edit_tooltip:"Edit link in a dialogue",links_unlink_tooltip:"Replace link with the text it contains",images_small:"Small",images_medium:"Medium",images_large:"Large",images_original:"Original",images_border:"Border",images_link_create:"Link",
images_link_edit:"Edit link",images_link_remove:"Unlink",images_link_create_tooltip:"Link this image to other content",images_link_edit_tooltip:"Edit the link for this image",images_link_remove_tooltip:"Remove the link for this image",images_sizing_tooltip:"Resize image to a specific width",
images_small_tooltip:"Resize image to small and link to the original",images_medium_tooltip:"Resize image to medium and link to the original",images_large_tooltip:"Resize image to large and link to the original",images_original_tooltip:"Reset image size to original",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",images_border_tooltip:"Display a border around image"}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/i18n/translations.i18n","TinyMCELang");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'toolbar/toolbar.soy' */
// This file was automatically generated from toolbar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Toolbar.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Toolbar == 'undefined') { Confluence.Templates.Editor.Toolbar = {}; }


Confluence.Templates.Editor.Toolbar.toolbarButton = function(opt_data, opt_ignored) {
  return '<li id="' + soy.$$escapeHtml(opt_data.button.id) + '" class="toolbar-item ' + soy.$$escapeHtml(opt_data.button.className) + '" data-tooltip="' + soy.$$escapeHtml(opt_data.button.tooltip) + '" data-weight="' + soy.$$escapeHtml(opt_data.button.weight) + '"><a class="toolbar-trigger aui-button" href="#" data-control-id="' + soy.$$escapeHtml(opt_data.button.id) + '"><span class="icon ' + soy.$$escapeHtml(opt_data.button.icon) + '"></span><span class="trigger-text">' + soy.$$escapeHtml(opt_data.button.title) + '</span></a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Toolbar.toolbarButton.soyTemplateName = 'Confluence.Templates.Editor.Toolbar.toolbarButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confcharmap/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcharmap/editor_plugin_src",["tinymce"],function(b){return{init:function(a){a.addCommand("confCharmap",function(){a.windowManager.open({id:"insert-char-dialog",url:b.settings.editor_plugin_action_base_path+"/charmap.action",width:600+parseInt(a.getLang("advanced.charmap_delta_width",0)),height:290+parseInt(a.getLang("advanced.charmap_delta_height",0)),inline:!0,name:"advanced.charmap_desc"})})},getInfo:function(){return{longname:"Confluence Charmap Plugin",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcharmap/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.ConfCharmapPlugin",b);a.PluginManager.add("confcharmap",a.plugins.ConfCharmapPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",["jquery","ajs","tinymce"],function(b,g,h){return{init:function(l){!h.isIE8&&l.onKeyDown.add(function(d,k){function j(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&!b(a.lastChild).is("br")&&b(a).append("<br/>")}if(8===k.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&g.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,i=e[0],a;if(0<c.length)return f=c[0],
a=b(i.firstChild),h.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first()),d.undoManager.beforeChange(),d.undoManager.add(),b(f.lastChild).is("p")&&!d.dom.isBlock(i.firstChild)?(j(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(i.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(j(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(i.firstChild).prepend(b(c).detach())})):
j(f),c.append(e.detach().contents()),a[0]&&g.EditorUtils.setCursorAtStartOfContents(a[0]),d.undoManager.add(),h.dom.Event.cancel(k)}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.ConfluenceListPlugin",b);g.PluginManager.add("confluencelist",g.plugins.ConfluenceListPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/atlassianemotions/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/atlassianemotions/editor_plugin_src",["tinymce","jquery"],function(d,e){return{init:function(a,g){a.addCommand("mceEmotion",function(){a.windowManager.open({file:d.settings.editor_plugin_action_base_path+"/emotions.action",width:190+parseInt(a.getLang("emotions.delta_width",0)),height:125+parseInt(a.getLang("emotions.delta_height",0)),inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:g})});a.addButton("emotions",{title:"emotions.emotions_desc",
cmd:"mceEmotion"});a.onClick.add(function(a,f){var b=f.target,c;if("IMG"===b.nodeName&&(c=e(b),c.hasClass("emoticon")))return c=a.selection.getRng(!0),(f.offsetX||f.layerX-b.x)<b.width/2?(c.setStartBefore(b),c.setEndBefore(b)):(c.setStartAfter(b),c.setEndAfter(b)),a.selection.setRng(c),a.selection.collapse(),d.dom.Event.prevent(f)})},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",
version:d.majorVersion+"."+d.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/atlassianemotions/editor_plugin_src",function(d){var e=require("tinymce");e.create("tinymce.plugins.EmotionsPlugin",d);e.PluginManager.add("emotions",e.plugins.EmotionsPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'com/atlassian/confluence/tinymceplugin/tinymce-confluence.js' */
tinymce.confluence=tinymce.confluence||{};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'breadcrumbs/tinymce-breadcrumbs-oninit-rte.js' */
define("confluence-editor/breadcrumbs/tinymce-breadcrumbs-oninit-rte",["ajs","jquery","document"],function(b,a,g){return function(){function f(){var c=a("#breadcrumbs");c.detach();!c.find(".edited-page-title").length&&e.length&&c.append(e);a("#editor-precursor .cell").prepend(c)}if("comment"!==b.Meta.get("content-type")){var d=a("#quickedit-breadcrumbs");0<d.length&&(a("#breadcrumbs").detach(),d.attr("id","breadcrumbs"),a("#breadcrumb-section").append(d));var e=a(".edited-page-title").parent().detach();
f();a(g).bind("mode-changed",function(c,b){if(b==="preview"){var d=a("#breadcrumbs").detach();e.detach();a("#breadcrumb-section").append(d)}else b==="richtext"&&f()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/breadcrumbs/tinymce-breadcrumbs-oninit-rte",function(b){require("ajs").bind("init.rte",b)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/tinymce-node-utils.js' */
define("confluence-editor/utils/tinymce-node-utils",["tinymce","ajs","jquery"],function(n,h,k){var o=0,m;return m={updateNode:function(a,c){var f=k(a,n.activeEditor.getDoc()),b="confluence.update-node-"+o++;h.trigger("synchrony.stop",{id:b});var d=m.prepareNodeForUpdate(f);return m.replaceNode(f,c).fail(d).always(function(){h.trigger("synchrony.start",{id:b})}).promise()},storeNodeState:function(a,c){for(var f={},b,d=0,e=c.length;d<e;d++)b=c[d],f[b]=a.attr(b);return function(){for(var b in f)a.attr(b,
f[b])}},prepareNodeForUpdate:function(a){var c=null;a.is("img")&&(c=m.storeNodeState(a,["width","height","src","class"]),a.addClass("image-hotswap").attr({src:h.contextPath()+"/images/border/spacer.gif",width:a.attr("width"),height:a.attr("height")}));return c},replaceNode:function(a,c){var f=m.getDoc(),b=k(c,f),d=k(a,f),e="confluence.replace-node-"+o++;h.trigger("synchrony.stop",{id:e});return k.Deferred(function(){var a=this;b.is("img")?(b[0].onload=function(){h.debug("replaceNode: new node's src has been loaded by the browser.");
this.onload=null;a.resolve(this)},k.browser.opera&&(b[0].src=b.attr("src")),f.createDocumentFragment().appendChild(b[0])):a.resolve(b[0])}).always(function(){h.trigger("synchrony.start",{id:e})}).done(function(a){d.replaceWith(a)}).promise()},replaceSelection:function(a){var c=n.activeEditor,f=c.selection.getRng(!0),b;b=c.getDoc().createRange();a=k(a).clone(!0,!1)[0];f.deleteContents();3===f.startContainer.nodeType&&""===f.startContainer.nodeValue&&(f.startContainer.nodeValue=h.Rte.HIDDEN_CHAR);f.insertNode(a);
f=c.getDoc().createTextNode(h.Rte.HIDDEN_CHAR);c.dom.insertAfter(f,a);b.setStartBefore(f);b.setEndAfter(f);b.collapse(!1);c.selection.setRng(b);return a},normalize:function(a){var c,f,b,d,e,g,h=n.activeEditor;e=h.selection.getRng(!0);var l,m=[];if(a&&a.childNodes){if(n.isWebKit)l=e;else if(n.isGecko&&(l=e.cloneRange(),c=k.inArray(e.startContainer,a.childNodes),f=l.startOffset,b=k.inArray(e.endContainer,a.childNodes),d=l.endOffset,g=e=g=e=void 0,-1<c||-1<b)){var p=[],q=0;k.each(a.childNodes,function(a,
b){var c={},f=p[a-1]||{};c.isTextNode=3===b.nodeType;c.textNodesBefore=(c.isTextNode&&f.isTextNode?1:0)+~~f.textNodesBefore;c.precedingTextLength=q;q=c.isTextNode?q+b.nodeValue.length:0;p.push(c)});m=p}a.normalize();if(n.isGecko){if(g=m[c])e=c-g.textNodesBefore,g=f+g.precedingTextLength,l.setStart(a.childNodes[e],g);if(g=m[b])e=b-g.textNodesBefore,g=d+g.precedingTextLength,l.setEnd(a.childNodes[e],g)}l&&h.selection.setRng(l)}},getDoc:function(){var a=n.activeEditor;return k.browser.mozilla||k.browser.opera?
document:a.getDoc()},isolateSelectedRange:function(){function a(a,b,d){var e;(e=c.dom.getParent(a,c.dom.isBlock))||(e=c.getBody());a:{var g,i=null,j=null,h;h=(g=d?!0:!1)?"nextSibling":"previousSibling";i=0===b;!i&&g&&(i=3===a.nodeType?b===a.length:b===a.childNodes.length);if(i){i=a[h];for(j=a;null===i;){if(j===e){a=void 0;break a}else if(j.parentNode===e)break;j=j.parentNode;i=j[h]}}else 3===a.nodeType?(h=a.data,a.data=h.slice(b),i=f.createTextNode(h.slice(0,b)),j=a,k(i).insertBefore(j),g&&(h=j,j=
i,i=h)):(j=a.childNodes[b-(g?1:0)],i=j[h]);a=[j,i]}if(a)if(a[1]){b=a[1];a=a[0];for(d=d?!0:!1;a!==e&&a.parentNode!==e;){i=a.parentNode;g=i.cloneNode(!1);if(d)for(k(g).insertAfter(i);b;)j=b.nextSibling,g.appendChild(b),b=j;else{k(g).insertBefore(i);for(b=i.firstChild;b!==a;)j=b.nextSibling,g.appendChild(b),b=j}b=g;a=i}d=a}else d=a[0];else d=void 0;return d}var c=n.activeEditor,f=m.getDoc(),b=c.selection,d=b.getRng(!0),e=d.startContainer,g=d.startOffset,h=d.endContainer,l=d.endOffset,o;if(d.collapsed)return d;
e===h&&(o=l-g);(g=a(e,g))&&d.setStartBefore(g);e!==d.startContainer&&(l=o||l);(e=a(h,l,!0))&&d.setEndAfter(e);b.setRng(d);return d}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/utils/tinymce-node-utils","tinymce.confluence.NodeUtils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'autoformat/wiki-autoformat-oninit-rte.js' */
define("confluence-editor/wiki-autoformat",["ajs","jquery","document","window"],function(k,j,m,u){var h=function(v,w){function n(a){return j("<div>").append(a.cloneNode(!0)).html()}function x(a,b,f){if(!b)throw Error("text node is null");3!==b.nodeType&&(b=b.childNodes[f-1],f=b.length);for(;b&&3===b.nodeType;b=b.previousSibling){-1==f&&(f=b.nodeValue.length);if(f>a)return{container:b,offset:f-a};if(f==a){f=0;for(a=b.parentNode;b=b.previousSibling;)f++;return{container:a,offset:f}}a-=f;f=-1}return null}
function p(a){var b,f;if(!a||!a.collapsed)throw Error("range is null or not collapsed");b=a.startContainer;f=a.startOffset;if(1===b.nodeType&&0<f)if(b=b.childNodes[a.startOffset-1],3===b.nodeType)f=b.nodeValue.length;else return"";else if(3!==b.nodeType)return"";a=b.nodeValue.substring(0,f);for(b=b.previousSibling;b&&3===b.nodeType;b=b.previousSibling)a=b.nodeValue+a;return a}function i(a,b,f,c){return{handles:function(b){var f=!1,b=b.selection.getRng(!0),f=b.commonAncestorContainer||{};return!b.collapsed||
j(f).closest("pre,.text-placeholder").length||c&&j(f).closest(c).length?!1:f=a.test(p(b))},execute:function(c,g,h){var d,e,i=1;d=j.browser.msie?g.keyCode:g.which;32===d?c.execCommand("mceInsertContent",!1,"&nbsp;"):c.execCommand("mceInsertContent",!1,String.fromCharCode(d));c.undoManager.beforeChange();c.undoManager.add();d=c.selection.getRng(!0);e=p(d);"|"==e[e.length-1]&&(e+=" ",i=0);e=a.exec(e.substring(0,e.length-1));i=x(e[1].length+i,d.commonAncestorContainer,d.startOffset);d.setStart(i.container,
i.offset);i=j(d.commonAncestorContainer);c.selection.setRng(d);i.closest(".wysiwyg-macro-body").length&&d.toString()==i.text()?(i[0].innerHTML="<br>",c.selection.select(i[0].childNodes[0]),c.selection.collapse(!0)):c.execCommand("delete",!1,{},{skip_undo:!0});b(e,c.selection.getRng(!0));q=c.selection.getRng(!0);if(f)return h.preventDefault(),h.stopPropagation(),o.dom.Event.cancel(g),k.Rte.showElement(q.startContainer),!1}}}function r(){this.handlers={}}function e(a,b,f,d,e){var a=a.charCodeAt(0),
h=k.Rte.getResourceUrlPrefix()+"/images/icons/emoticons/"+e,b=i(b,function(){var a=c.dom.createHTML("img",{src:h,alt:c.getLang(d),title:c.getLang(d),border:0,"class":"emoticon emoticon-"+f,"data-emoticon-name":f});c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})},!0);this.imagePath=h;g.registerHandler(a,b)}function s(a,b){var f=c.formatter.get(a)[0],f=c.dom.create(f.inline,{style:f.styles});f.appendChild(m.createTextNode(b+"{$caret}"));c.execCommand("mceInsertContent",!1,n(f),{skip_undo:!0});
c.formatter.remove(a)}var o=require("tinymce"),q;if(!k.Meta.get("remote-user")||!k.Meta.get("confluence.prefs.editor.disable.autoformat")){r.prototype={registerHandler:function(a,b){this.handlers[a]||(this.handlers[a]=[]);this.handlers[a].push(b)},executeHandlers:function(a,b,c,d){var e=!0;j.each(this.handlers[a]||[],function(a,g){if(g.handles(b))return e=g.execute(b,c,d),!1});return e}};var c=w.editor,g=new r,d=[new e(")",h.regularExpressions._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile",
"smile.png"),new e("(",h.regularExpressions._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.png"),new e("P",h.regularExpressions._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.png"),new e("p",h.regularExpressions._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.png"),new e("D",h.regularExpressions._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink","wink.png"),new e(")",
h.regularExpressions._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.CROSS,"cross",
"emotions_dlg.error","error.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.LIGHT_ON,"light-on",
"emotions_dlg.lightbulb_on","lightbulb_on.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.png"),
new e(")",h.regularExpressions._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.png"),new e(")",h.regularExpressions._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.png"),new e("3",h.regularExpressions._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.png"),new e("3",h.regularExpressions._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.png")],l,t=[];for(l=0;l<d.length;l++)t[l]=new u.Image,t[l].src=
d[l].imagePath;j.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough"},function(a,b){var c=RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\"+a+"(?=[^\\s"+a+"])([^"+a+"]*?[^\\s]))$");g.registerHandler(a.charCodeAt(0),i(c,function(a){s(b,a[2])},!0))});c.formatter.register("code",{inline:"code"});g.registerHandler(125,i(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,function(a){s("code",a[2])},!0));for(l=1;6>=l;l++)(function(a){g.registerHandler(32,i(RegExp("^\\u200b?(h"+
a+"\\.)$"),function(){c.execCommand("formatBlock",!1,"h"+a,{skip_undo:!0})},!0))})(l);g.registerHandler(32,i(/^\u200b?(bq\.)$/,function(){c.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})},!0));g.registerHandler(32,i(/^\u200b?(\*)$/,function(){c.plugins.lists.applyList("UL","OL")},!0));g.registerHandler(32,i(/^\u200b?(\#)$/,function(){c.plugins.lists.applyList("OL","UL")},!0));g.registerHandler(32,i(/^\u200b?(1\.)$/,function(){c.plugins.lists.applyList("OL","UL")},!0));g.registerHandler(32,
i(/^\u200b?(\-)$/,function(){var a=c.dom,b;c.plugins.lists.applyList("UL","OL");if(b=a.getParent(c.selection.getNode(),"OL,UL"))a.setStyles(b,{listStyleType:"square"}),b.removeAttribute("data-mce-style")},!0));k.trigger("confluence.editor.registerHandlers",{handlerManager:g,createHandler:i,ed:c});d=i(/((\<\-\-?\>)([^\s-]*))$/,function(a){c.execCommand("mceInsertContent",!1,"\u2194"+a[3],{skip_undo:!0})},!1);g.registerHandler(32,d);g.registerHandler(13,d);d=i(/((\-\-?\>)([^\s-]*))$/,function(a){c.execCommand("mceInsertContent",
!1,"\u2192"+a[3],{skip_undo:!0})},!1);g.registerHandler(32,d);g.registerHandler(13,d);d=i(/((\<\-\-?)([^\s-]*))$/,function(a){c.execCommand("mceInsertContent",!1,"\u2190"+a[3],{skip_undo:!0})},!1);g.registerHandler(32,d);g.registerHandler(13,d);g.registerHandler(32,i(/[^-]*[\s](\-\-\-?)$/,function(a){c.execCommand("mceInsertContent",!1,2===a[1].length?"\u2013":"\u2014",{skip_undo:!0})},!1));d=i(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,function(a){c.execCommand("mceInsertContent",!1,a[2]+(2===a[3].length?
"\u2013":"\u2014")+a[4],{skip_undo:!0})},!1);g.registerHandler(32,d);g.registerHandler(13,d);d=i(/^\u200b?(\-\-\-\-)$/,function(){c.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})},!0);g.registerHandler(32,d);g.registerHandler(13,d);g.registerHandler(13,i(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,function(a){var b="<table class='confluenceTable'><tr>",f="",d=!0,a=j(a[1].slice(2,-2).split("||")).map(function(a){a=j.trim(this);d=d&&""==a;return a});d&&(a[0]="first cell");
for(var e=0,g=a.length;e<g;e++)b+="<th class='confluenceTh'>"+a[e]+"</th>",f+="<td class='confluenceTd'>"+k.Rte.ZERO_WIDTH_WHITESPACE+"</td>";c.execCommand("mceInsertContent",!1,b+("</tr><tr>"+f+"</tr></table>"),{skip_undo:!0});c.selection.select(j(c.selection.getRng(!0).commonAncestorContainer).parents("table").find(d?"th":"td")[0].childNodes[0]);j(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},!0));g.registerHandler(13,i(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,
function(a){var b="<table class='confluenceTable'><tr>",f=!0,a=j(a[1].slice(1,-1).split("|")).map(function(a){a=j.trim(this);f=f&&""==a;return a});f&&(a[0]="first cell");for(var d=0,e=a.length;d<e;d++)b+="<td class='confluenceTd'>"+a[d]+"</td>";c.execCommand("mceInsertContent",!1,b+"</tr></table>",{skip_undo:!0});f&&c.selection.select(j(c.selection.getRng(!0).commonAncestorContainer).parents("table").find("td")[0].childNodes[0]);j(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},
!0));d=i(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,function(a){var b=c.dom.create("a",{href:a[3]?a[1]:"http://"+a[1]});b.appendChild(m.createTextNode(a[1]));c.execCommand("mceInsertContent",!1,n(b),{skip_undo:!0});c.getDoc().execCommand("unlink",!1,{})},!1,"a");g.registerHandler(32,d);g.registerHandler(13,d);d=i(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,
function(a){var b=c.dom.create("a",{href:"mailto:"+a[1]});b.appendChild(m.createTextNode(a[1]));c.execCommand("mceInsertContent",!1,n(b),{skip_undo:!0});c.getDoc().execCommand("unlink",!1,{})},!1,"a");g.registerHandler(32,d);g.registerHandler(13,d);d=function(a,b){var d=i(a,function(){c.execCommand("mceInsertContent",!1,b,{skip_undo:!0})},!1);g.registerHandler(32,d);g.registerHandler(13,d)};d(/(?:\b|^)([Jj]ira)$/,"JIRA");d(/(?:\b|^)(bitbucket|[Bb]itBucket)$/,"Bitbucket");d(/(?:\b|^)(atlassian)$/,
"Atlassian");d(/(?:\b|^)([Hh]ipchat)$/,"HipChat");j.each({"]":h.regularExpressions._REGEXES.WIKI_LINK,"}":h.regularExpressions._REGEXES.WIKI_MACRO,"!":h.regularExpressions._REGEXES.WIKI_EMBED},function(a,b){g.registerHandler(a.charCodeAt(0),i(b,function(b){var d=b[1]+a,b={type:"POST",contentType:"application/json; charset=utf-8",url:k.Meta.get("context-path")+"/rest/tinymce/1/wikixhtmlconverter",data:j.toJSON({wiki:d,entityId:k.Meta.get("content-id"),spaceKey:k.Meta.get("space-key"),suppressFirstParagraph:!0}),
dataType:"text",timeout:5E3};"}"==a?o.confluence.MacroUtils.insertMacro(b):"!"==a?j.ajax(b).done(function(a){!d===a?o.confluence.ImageUtils.insertImagePlaceholder(a):c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})}):j.ajax(b).done(function(a){c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})})},!0))});c.onKeyPress.addToTop(function(a,b){return g.executeHandlers(j.browser.msie?b.keyCode:b.which,a,b,v)});return{}}};h.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,
WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,
BROKEN_HEAR:/\B(<\/)$/}};return h});require("confluence/module-exporter").safeRequire("confluence-editor/wiki-autoformat",function(k){require("confluence/module-exporter").namespace("AJS.Rte.autoformat",k.regularExpressions);require("ajs").bind("init.rte",k)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencedrafts/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencedrafts/editor_plugin_src",["jquery","ajs","tinymce","confluence/analytics-support","confluence/legacy-editor-global-AVOID-IF-POSSIBLE"],function(d,a,b,e,c){return{init:function(b){function h(){if(!a.Meta.get("has-collaborated")){a.Meta.set("has-collaborated",!0);var c=a.Meta.get("remote-user-key"),b=a.Meta.get("content-id");d.ajax({type:"PUT",url:a.contextPath()+"/rest/experimental/relation/user/"+c+"/collaborator/toContent/"+b+"?targetStatus=draft",
error:function(){a.Meta.set("has-collaborated",!1);a.error("Unable to store current user as a collaborator")}})}}var g;b.onInit.add(function(){a.Meta.get("shared-drafts")&&a.DarkFeatures.isEnabled("collaborative-audit-log")&&a.bind("editor.local.change",h)});a.bind("rte-ready",function(){a.debug("confluence drafts plugin initialisation");d("#draft-status").show();d("#draft-messages").show();c.Drafts.bindUnloadMessage();c.UI.cancelButton.click(function(){c.Drafts.save({skipErrorHandler:!0})});d("#draft-messages").is(":visible")&&
e.publish("rte.notification.draft");d("#draft-messages").find("a.use-draft").click(function(a){a.stopPropagation();a.preventDefault();c.Drafts.useDraft();e.publish("rte.notification.draft.resume")});d("#draft-messages").find("a.discard-draft").click(function(b){b.stopPropagation();b.preventDefault();c.Drafts.discardDraft(a.Meta.get("existing-draft-id"));e.publish("rte.notification.draft.discard")});if(a.Meta.getBoolean("shared-drafts")){var b=a.Meta.get("draft-id"),f=a.Meta.get("draft-share-id");
0!==b&&(window.history&&window.history.replaceState)&&(a.DarkFeatures.isEnabled("react.ui.view-page")&&d("#confluence-ui").length?window.history.replaceState(null,"",window.location.pathname+"?draftId="+b+"&draftShareId="+f):window.history.replaceState(null,"",a.Meta.get("base-url")+"/pages/resumedraft.action?draftId="+b+"&draftShareId="+f));c.UI.cancelButton.attr("data-tooltip","Keep the draft or discard changes");c.UI.cancelButton.on("click",function(){a.trigger("analytics",{name:"confluence.editor.done.button.clicked"});
a.trigger("analytics",{name:"confluence.editor.close",data:{source:"closeButton"}})})}g=setInterval(c.Drafts.save,+a.params.draftSaveInterval||3E4)});a.bind("rte-destroyed",function(){a.debug("confluence drafts plugin tear down");clearInterval(g)})},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencedrafts/editor_plugin_src",function(d){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceDrafts",d);a.PluginManager.add("confluencedrafts",a.plugins.ConfluenceDrafts)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/referrer/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/referrer/editor_plugin_src",["jquery","tinymce"],function(b,a){return{init:function(a){a.onInit.add(function(){var a=b("#createpageform"),c=a.find("#originalReferrer");a.length&&(!c.val()&&document.referrer)&&c.val(document.referrer)})},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/referrer/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.Referrer",b);a.PluginManager.add("referrer",a.plugins.Referrer)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/watch/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/watch/editor_plugin_src",["jquery","ajs","tinymce","confluence/templates"],function(c,a,b,d){return{init:function(b){b.onInit.add(function(){if(a.Meta.get("use-watch")){var b={userWatchingOwnContent:a.Meta.get("user-watching-own-content")};c("#rte-savebar-tinymce-plugin-point").append(d.Editor.SaveBar.Watch.render(b))}})},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+
b.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/watch/editor_plugin_src",function(c){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceWatch",c);a.PluginManager.add("confluencewatch",a.plugins.ConfluenceWatch)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/watch/watch.soy' */
// This file was automatically generated from watch.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.SaveBar.Watch.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.SaveBar == 'undefined') { Confluence.Templates.Editor.SaveBar = {}; }
if (typeof Confluence.Templates.Editor.SaveBar.Watch == 'undefined') { Confluence.Templates.Editor.SaveBar.Watch = {}; }


Confluence.Templates.Editor.SaveBar.Watch.render = function(opt_data, opt_ignored) {
  return '<ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment"><li class="toolbar-item"><input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" ' + ((opt_data.userWatchingOwnContent) ? 'checked="checked"' : '') + '/><label for="watchPage">' + soy.$$escapeHtml('Watch this page') + '</label></li></ul>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.SaveBar.Watch.render.soyTemplateName = 'Confluence.Templates.Editor.SaveBar.Watch.render';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/notifywatchers/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/notifywatchers/editor_plugin_src",["jquery","ajs","confluence/templates","tinymce"],function(c,a,d,b){return{init:function(b){b.onInit.add(function(){var b={contentId:a.params.contentId,defaultVersionComment:a.params.versionComment};c("#rte-savebar-tinymce-plugin-point").append(d.Editor.SaveBar.NotifyWatchers.render(b))});require(["confluence/persistable"])},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",
version:b.majorVersion+"."+b.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/notifywatchers/editor_plugin_src",function(c){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceNotifyWatchers",c);a.PluginManager.add("confluencenotifywatchers",a.plugins.ConfluenceNotifyWatchers)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/notifywatchers/notifywatchers.soy' */
// This file was automatically generated from notifywatchers.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.SaveBar.NotifyWatchers.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.SaveBar == 'undefined') { Confluence.Templates.Editor.SaveBar = {}; }
if (typeof Confluence.Templates.Editor.SaveBar.NotifyWatchers == 'undefined') { Confluence.Templates.Editor.SaveBar.NotifyWatchers = {}; }


Confluence.Templates.Editor.SaveBar.NotifyWatchers.render = function(opt_data, opt_ignored) {
  return '<span class="minor-edit toolbar-item"><input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" data-persist="checked" data-persist-scope="' + soy.$$escapeHtml(opt_data.contentId) + '" data-default-value="true" checked><label for="notifyWatchers"><span>' + soy.$$escapeHtml('Notify watchers') + '</span></label></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.SaveBar.NotifyWatchers.render.soyTemplateName = 'Confluence.Templates.Editor.SaveBar.NotifyWatchers.render';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/versioncomment/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/versioncomment/editor_plugin_src",["jquery","ajs","tinymce","confluence/templates"],function(c,b,a,d){return{init:function(a){a.onInit.add(function(){var a={versionComment:b.params.versionComment};c("#rte-savebar-tinymce-plugin-point").append(d.Editor.SaveBar.VersionComment.render(a))})},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/versioncomment/editor_plugin_src",function(c){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceVersionComment",c);b.PluginManager.add("confluenceversioncomment",b.plugins.ConfluenceVersionComment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/versioncomment/versioncomment.soy' */
// This file was automatically generated from versioncomment.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.SaveBar.VersionComment.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.SaveBar == 'undefined') { Confluence.Templates.Editor.SaveBar = {}; }
if (typeof Confluence.Templates.Editor.SaveBar.VersionComment == 'undefined') { Confluence.Templates.Editor.SaveBar.VersionComment = {}; }


Confluence.Templates.Editor.SaveBar.VersionComment.render = function(opt_data, opt_ignored) {
  return '<span class="rte-toolbar-comment toolbar-item"><input id="versionComment" name="versionComment" ' + ((opt_data.versionComment) ? 'value="' + soy.$$escapeHtml(opt_data.versionComment) + '"' : '') + 'placeholder="' + soy.$$escapeHtml('What did you change?') + '" class="text" type="text" size="35"><label for="versionComment" class="assistive">' + soy.$$escapeHtml('What did you change?') + '</label></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.SaveBar.VersionComment.render.soyTemplateName = 'Confluence.Templates.Editor.SaveBar.VersionComment.render';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",["tinymce","confluence/legacy-editor-global-AVOID-IF-POSSIBLE"],function(a,b){return{init:function(a){a.onInit.add(function(){a.addCommand("mceConfimage",b.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceImageDialog",a);b.PluginManager.add("confluenceimagedialog",b.plugins.ConfluenceImageDialog)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/macrobrowser/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/macrobrowser/editor_plugin_src",["tinymce"],function(b){return{init:function(a){a.onInit.add(function(){a.addCommand("mceConfMacroBrowser",b.confluence.macrobrowser.macroBrowserToolbarButtonClicked)})},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/macrobrowser/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceMacroBrowser",b);a.PluginManager.add("confluencemacrobrowser",a.plugins.ConfluenceMacroBrowser)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/leavecomment/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/leavecomment/editor_plugin_src",["jquery","ajs","tinymce","confluence/legacy-editor-global-AVOID-IF-POSSIBLE","window"],function(c,a,b,e,f){return{init:function(d){function b(){if(e.UI.isFormEnabled()&&d.isDirty()&&!e.isEmpty())return "Your comment will be lost."}d.onInit.add(function(){c(f).bind("beforeunload",b)});d.onRemove.add(function(){c(f).unbind("beforeunload",b)})},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",
authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/leavecomment/editor_plugin_src",function(c){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceLeaveComment",c);a.PluginManager.add("confluenceleavecomment",a.plugins.ConfluenceLeaveComment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/leavetemplate/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/leavetemplate/editor_plugin_src",["jquery","ajs","confluence/legacy-editor-global-AVOID-IF-POSSIBLE","window","tinymce"],function(c,a,e,f,b){return{init:function(d){function b(){if(e.UI.isFormEnabled()&&d.isDirty()&&!e.isEmpty())return "Your unsaved template changes will be lost."}d.onInit.add(function(){c(f).bind("beforeunload",b)});d.onRemove.add(function(){c(f).unbind("beforeunload",b)})},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",
authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/leavetemplate/editor_plugin_src",function(c){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceLeaveTemplate",c);a.PluginManager.add("confluenceleavetemplate",a.plugins.ConfluenceLeaveTemplate)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/template-editor/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/template-editor/editor_plugin_src",["jquery","tinymce"],function(b,a){return{init:function(a){a.onInit.add(function(){b(a.getBody()).addClass("template-editor")})},getInfo:function(){return{longname:"Confluence Template Editor",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/template-editor/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceTemplateEditor",b);a.PluginManager.add("confluencetemplateeditor",a.plugins.ConfluenceTemplateEditor)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/custom-toolbar-components.js' */
define("confluence-editor/tinymce3/plugins/customtoolbar/custom-toolbar-components",["jquery"],function(d){return{Button:function(a){var b=a.text,e=a.tooltip,c=a.triggerText,i=a.iconClass,h=a.click,j=!!a.disabled,g=a.id;this.render=function(){var a=d('<button type="button"></button>').addClass("aui-button").attr("data-tooltip",e||b);g&&a.attr("id",g);j&&a.prop("disabled",!0).attr("aria-disabled","true");a.click(function(){a.prop("disabled")||h()});if(i){var f=d("<span />");f.addClass("icon "+i);f.text(b);
a.append(f)}c&&(f=d("<span />"),f.addClass("trigger-text"),f.text(c),a.append(f));return a[0]}},DropDownButton:function(a){var b=a.id,e=a.tooltip,c=a.text||"",i=a.iconClass,h=!!a.disabled,j=a.dropDownContent,g;this.render=function(){var a=d("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",e);a.attr("id",b);var f=d("<div/>").addClass("aui-dd-parent"),k=d("<a href='#'></a>");k.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button");c&&k.append("<span class='dropdown-text'>"+
c+"</span>");h&&(a.addClass("disabled"),k.addClass("disabled"));if(i){var l=d("<span />");l.addClass("icon "+i);l.text(c);k.append(l)}l=d("<span/>");l.addClass("icon").addClass("icon-dropdown");k.append(l);g=d("<div/>").addClass("hidden").addClass("aui-dropdown");j&&g.append(j);f.append(k);f.append(g);a.append(f);return a[0]}},TextButton:function(a){var b=a.text,e=a.textClass,c=a.click,i=!!a.disabled,h=a.tooltip;this.render=function(){var a=d('<button type="button"></button>').addClass("aui-button").addClass(e).text(b);
h&&a.attr("data-tooltip",h);i&&a.prop("disabled",!0).attr("aria-disabled","true");a.click(function(){a.prop("disabled")||c()});return a[0]}},TextBox:function(a){var b=a.id,e=a.text,c=a.name,i=a.keydown,h=a.cssClass;this.render=function(){var a=d("<div></div>").addClass("toolbar-item");a.append(d("<label for='"+b+"'>"+e+"</label>"));var g=d("<input id='"+b+"' type='text' name='"+c+"' class='"+h+" text' autocomplete='off'>");g.keydown(function(a){i(a)});a.append(g);return a[0]}},Group:function(a,b){this.render=
function(){var e=d("<div></div>");e.addClass("aui-buttons");b&&(b.id&&e.attr("id",b.id),b.groupClass&&e.addClass(b.groupClass));for(var c=0,i=a.length;c<i;c++)e.append(a[c].render());return e[0]}},SplitGroup:function(a,b){function e(){var a=c.id,b=c.disabled,e=c.dropDownContent,g=c.title,m=c.alignment,f=d("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");a&&f.attr("id",a);g&&f.attr({"data-tooltip":g});m&&f.data("dropdown-alignment",m);a=d("<div/>").addClass("aui-dd-parent");
g=d("<a href='#'></a>");g.addClass("toolbar-trigger aui-dd-trigger");b&&(f.addClass("disabled"),g.addClass("disabled"));b=d("<span/>");b.addClass("icon").addClass("icon-dropdown");g.append(b);b=d("<div/>").addClass("hidden").addClass("aui-dropdown");e&&b.append(e);a.append(g);a.append(b);f.append(a);return f[0]}var c=b&&b.dropDownOptions||{};this.render=function(){var c=d("<div></div>");c.addClass("aui-buttons");b&&(b.id&&c.attr("id",b.id),b.groupClass&&c.addClass(b.groupClass));for(var h=0,j=a.length;h<
j;h++)c.append(a[h].render());c.append(e(b));b&&b.postProcess&&b.postProcess(c);return c[0]}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/customtoolbar/custom-toolbar-components","Confluence.Editor.Toolbar.Components");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/table-toolbar.js' */
define("confluence-editor/tinymce3/plugins/customtoolbar/table-toolbar","ajs jquery tinymce document window confluence-editor/tinymce3/plugins/customtoolbar/custom-toolbar-components".split(" "),function(g,c,d,i,s,a){return{initContextToolbars:function(D,f){function q(a){var b=c(this),h=c("#table-highlight-group"),e=h.attr("data-highlight-colour"),d=h.attr("data-remove-highlight");if(e){h.removeClass("highlight-"+e);h.removeAttr("data-highlight-colour")}h.removeClass("remove-highlight");d&&h.removeAttr("data-remove-highlight");
if(e=b.attr("data-highlight-colour")){h.addClass("highlight-"+e);h.attr("data-highlight-colour",e)}if(b.attr("data-remove-highlight")){h.addClass("remove-highlight");h.attr("data-remove-highlight",true)}f.focus();f.execCommand("confTableSelectionToggleHighlight",false,{alwaysHighlight:true});a.preventDefault()}function u(){var a=c("<ul/>").addClass("table-mode-list"),k=[{name:b("table.responsive"),mceCmd:"mceAutoWidth",tooltip:b("table.responsive_tooltip")},{name:b("table.fixed_width"),mceCmd:"mceFixedWidth",
tooltip:b("table.fixed_width_tooltip")}];c.each(k,function(b,e){var k=c("<li/>").addClass("dropdown-item").attr("data-tooltip",e.tooltip),f=c("<a href='#'>"+e.name+"</a>").addClass("item-link");k.on("click",function(){d.execCommand(e.mceCmd,false,"")});a.append(k.append(f))});return a}var l=require("aui/templates"),o,b=function(c){var a=f.getLang(c);(c=f.getLang(c+"_shortcut",""))&&(a=a+(" ("+c+")"));return a},p=g.storageManager("atlassian.editor","tables"),m;require("aui/inline-dialog2");m=l.buttons.button({id:"table-more-settings-trigger",
text:"",iconType:"aui",iconClass:"aui-icon-small aui-iconfont-configure",iconText:b("table.table_more_heading"),extraAttributes:{type:"button","data-aui-trigger":"true","aria-controls":"table-more-settings","data-tooltip":b("table.table_more_heading")}});var v=l.inlineDialog2.inlineDialog2({alignment:"bottom left",respondsTo:"toggle",id:"table-more-settings"}),w=l.buttons.buttons({content:m});m=function(a){function d(a){var e=c("<div></div>"),t=c("<h2>"+b("table.table_more_heading")+"</h2>");e.append(t);
a.forEach(function(a){var b=c(l.form.field({type:"checkbox",id:a.id,labelContent:a.text,isChecked:a.isChecked(),isDisabled:a.isDisabled}));b.on("change",a.onChange);e.append(b)});return e}this.render=function(){var b=c(w),e=c(v),f=e[0],g=function(){f.open=false};e.on("aui-show",function(b){c(".aui-inline-dialog-contents",b.target).html(d(a))});b.append(e);c(s).on("resize",c.debounce(g,100));c(i).on("enableContextToolbarRow.Toolbar disableContextToolbarRow.Toolbar",g);return b}};f.onNodeChange.add(function(a,
b,d){a=c("body");a=!a.hasClass("no-tools")||a.hasClass("no-tools-toolbars-visible");if(!o&&d.parentNode!=null&&d.nodeName!=="BODY"){o=true;if(c(d).closest("table:not(.wysiwyg-macro)").length){c(i).trigger("createContextToolbarRow.Toolbar",{buttons:j.Buttons,topToolbar:true,animate:a}).trigger("enableContextToolbarRow.Toolbar");g.DarkFeatures.isEnabled("confluence.table.resizable")&&c.fn.updateTableModeInToolbar&&c(d).closest("table").updateTableModeInToolbar();d=c(d).closest("td,th");a=c(".mceSelected",
d.closest("table"));d.add(a).filter(function(){var a=c(this);return parseInt(a.attr("rowspan"),10)>1||parseInt(a.attr("colspan"),10)>1}).length>=1?f.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split"):f.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split")}else c(i).trigger("disableContextToolbarRow.Toolbar",{animate:a});o=false}});f.onUndo.add(function(a){a.nodeChanged()});f.onInit.add(function(){c(i).delegate("#table-highlight-colour .aui-dropdown a","click",q)});
f.onRemove.add(function(){c(i).undelegate("#table-highlight-colour .aui-dropdown a","click",q)});var n=new a.Group([new a.Button({text:b("table.row_before_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-row-up",click:function(){d.execCommand("mceTableInsertRowBefore",false,"")}}),new a.Button({text:b("table.row_after_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-row-down",click:function(){d.execCommand("mceTableInsertRowAfter",false,"")}}),new a.Button({text:b("table.delete_row_desc"),
iconClass:"aui-icon aui-icon-small aui-iconfont-table-row-remove",click:function(){d.execCommand("mceTableDeleteRow",false,"")}})]),p=new a.Group([new a.Button({text:b("table.cut_row_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-cut-row",click:function(){d.execCommand("mceTableCutRow",false,"");f.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-paste-row")}}),new a.Button({text:b("table.copy_row_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-copy-row",click:function(){d.execCommand("mceTableCopyRow",
false,"");f.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-paste-row")}}),new a.Button({text:b("table.paste_row_before_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-paste-row",click:function(){d.execCommand("mceTablePasteRowBefore",false,"")},disabled:!p.doesContain("copied")})]),x=new a.Group([new a.Button({text:b("table.col_before_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-col-left",click:function(){d.execCommand("mceTableInsertColBefore",false,"")}}),
new a.Button({text:b("table.col_after_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-col-right",click:function(){d.execCommand("mceTableInsertColAfter",false,"")}}),new a.Button({text:b("table.delete_col_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-col-remove",click:function(){d.execCommand("mceTableDeleteCol",false,"")}})]),y=new a.Group([new a.Button({text:b("table.merge_cells_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-merge",click:function(){d.execCommand("mceTableMergeCells",
false,"")}}),new a.Button({text:b("table.split_cells_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-split",click:function(){d.execCommand("mceTableSplitCells",false,"")}})]),z=new a.Group([new a.Button({text:b("table.row_highlight"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-header-row",click:function(){d.execCommand("confTableRowToggleHeading",false);d.execCommand("mceTableUpdateNumberingCol",false)}}),new a.Button({text:b("table.col_highlight"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-header-column",
click:function(){d.execCommand("confTableColumnToggleHeading",false)}})]),A=a.SplitGroup,B=[new a.Button({text:b("table.selection_highlight"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-bg",click:function(){d.execCommand("confTableSelectionToggleHighlight",false)}})],r=c("<ul/>").addClass("table-highlight-picker"),C=[false,false,false,false,false,true];c.each(["grey","red","green","blue","yellow",""],function(a,b){var d=c("<li/>"),e=c("<a href='#'></a>");C[a]?e.addClass("remove-highlight").attr("data-remove-highlight",
true):e.addClass("highlight-"+b).attr("data-highlight-colour",b);d.append(e);r.append(d)});var j={Buttons:[n,p,x,y,z,new A(B,{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:r,alignment:"right"},postProcess:function(a){a.attr("data-highlight-colour","grey");a.addClass("highlight-grey");var b=c("<span>&nbsp;</span>");b.addClass("highlight-indicator");a.find(".icon.aui-iconfont-table-bg").after(b)}}),new a.Group([new a.Button({text:b("table.del"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-remove",
click:function(){d.execCommand("mceTableDelete",false,"")}})])],Events:[]};g.DarkFeatures.isEnabled("confluence.table.resizable")&&j.Buttons.splice(0,0,new a.Group([new a.DropDownButton({id:"table-mode-picker",text:b("table.auto_width"),dropDownContent:u()})]));g.DarkFeatures.isEnabled("confluence-table-enhancements.copy-cut-paste-cols.disabled")||j.Buttons.splice(3,0,new a.Group([new a.Button({text:b("table.col_cut_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-cut-column",click:function(){d.execCommand("mceTableCutCol",
false,"")}}),new a.Button({text:b("table.col_copy_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-copy-column",click:function(){d.execCommand("mceTableCopyCol",false,"")}}),new a.Button({text:b("table.col_paste_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-table-paste-column",click:function(){d.execCommand("mceTablePasteColBefore",false,"")}})]));if(!g.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row.disabled")){n=[];g.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row.disabled")||
n.push({text:b("table.numbering_column_desc"),id:"insert-numbering-column",isChecked:function(){return c(f.selection.getNode()).closest("table").find(".numberingColumn").length>0},onChange:function(){d.execCommand("mceTableInsertNumberingCol",false,"")}});j.Buttons.push(new m(n))}return j}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/customtoolbar/table-toolbar",function(g){var c=require("jquery"),d=require("document");c(d).bind("initContextToolbars.Toolbar",function(c,d){require("confluence/legacy-editor-global-AVOID-IF-POSSIBLE").tableToolbar=g.initContextToolbars(c,d)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/customtoolbar/editor_plugin_src","jquery ajs confluence/legacy-editor-global-AVOID-IF-POSSIBLE document tinymce confluence/hint-manager".split(" "),function(b,g,n,o,u,x){function v(a){var c=function(){a&&a.hide()};b(o).bind("showLayer",function(b,d,f){if(d=="dropdown"&&f==a){b=g.Rte.getEditor();b.onClick.add(c);b.onKeyUp.add(c)}}).bind("hideLayer",function(b,d,f){if(d=="dropdown"&&f==a){b=g.Rte.getEditor();b.onClick.remove(c);b.onKeyUp.remove(c)}})}function w(b){b.addCallback("show",
function(){b.$.parents(".disabled").length&&b.hide()})}function y(a,c){var e=k(c);b("#"+e).removeClass("disabled")}function z(a,c){var e=k(c);b("#"+e).addClass("disabled")}function l(b,c){c?b.closest(".aui-button").prop("disabled",true).attr("aria-disabled","true").toggleClass("disabled",c):b.closest(".aui-button").prop("disabled",false).removeAttr("aria-disabled").toggleClass("disabled",c)}function q(a,c,e,d){var f=b("#toolbar"),h=f.find(".toolbar-item"),r=b("#insert-menu, #more-menu"),i=b("#insert-menu, #color-picker-control"),
j=b("#format-dropdown"),d=d||function(){return true};h.toggleClass("disabled",a);r.toggleClass("disabled",a);i.toggleClass("disabled",a);j.toggleClass("disabled",!!c);g.Rte.TablePicker[a?"disable":"enable"]();typeof e!=="undefined"&&f.find("button, input").filter(d).toggleClass("disabled",e).prop("disabled",e)}function k(b){var c="default";if(b&&b.id)c=b.id;return"rte-toolbar-row-"+c}function A(a,c){var e=c.animate;e==void 0&&(e=true);var d=function(){b(this).remove();b(o).trigger("resize.resizeplugin");
if(c.onHide)c.onHide()};clearTimeout(m);m=setTimeout(function(){var a=k(c),a=b("#"+a);if(e)a.slideUp(400,d);else{a.hide();d.call(a)}},100)}function B(a,c){var e=k(c),d=c.animate;d==void 0&&(d=true);if(b("#"+e).length>0)b("#"+e+":hidden").slideDown(400,function(){g.debug("Prevented toolbar deferred display race condition")});else{var f=b("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");f.attr("id",e);c.editorAdjacent&&f.addClass("editor-adjacent");for(var e=!c.topToolbar?
b("#savebar-container .aui-toolbar:visible"):b("#rte-toolbar.aui-toolbar:visible"),h=0,r=c.buttons.length;h<r;h++)f.append(c.buttons[h].render());f.css({display:"none"});if(c.editorAdjacent)e.append(f);else{h=b(".editor-adjacent",e).filter(":first");h.length?h.before(f):e.append(f)}f.find(".toolbar-dropdown").each(function(){j(this)});var i=function(){b(o).trigger("resize.resizeplugin").trigger("shown.contextToolbar");if(c.onVisible)c.onVisible()};clearTimeout(m);m=setTimeout(function(){if(d)f.slideDown(400,
i);else{f.show();i()}},100)}}function j(a){var a=b(a),c=a.dropDown("Standard",{alignment:a.data("dropdown-alignment")||"left"})[0];a.find(".dropdown-item").click(function(a){var d=b(this),f=d.attr("data-macro-name"),h=d.attr("data-command"),j=d.attr("data-format"),d=d.attr("data-control-id"),i=g.Rte.getEditor();f&&u.confluence.macrobrowser.macroBrowserToolbarButtonClicked({presetMacroName:f});h&&i.execCommand(h,false);j&&i.theme.controlHandlers.formatselect.click.dispatch(j);d&&i.theme.controlHandlers.buttons.click.dispatch(d);
c.hide();a.preventDefault()});w(c);v(c)}var m;return{init:function(a){j("#format-dropdown");j("#more-menu .aui-dd-parent");j("#insert-menu .aui-dd-parent");b("#pagelayout-menu").length&&j("#pagelayout-menu .aui-dd-parent");b("#template-menu").length&&j("#template-menu .aui-dd-parent");var c=b("#color-picker-control");if(c.length){var e=c.find(".aui-dd-parent"),d=b("#rte-button-color"),f=d.find(".selected-color"),e=e.dropDown("Standard",{alignment:"left"})[0],h=d.attr("data-color");f.css("background-color",
"#"+h);c.delegate("a[data-color]","click",function(a){var c=b(this),e=c.attr("data-color");a.preventDefault();if(!c.closest(".disabled").length){u.execCommand("ForeColor",false,"#"+e);d.attr("data-color",e);f.css("background-color","#"+e)}});w(e);v(e)}g.Rte.TablePicker.bindToControl(g.Rte.getEditor(),b("#insert-table-dropdown"));var k=b("#rte-button-source-mode");k.click(function(){k.hasClass("active")?n.changeMode(n.MODE_RICHTEXT):n.changeMode(n.MODE_SOURCE)});var c=require("confluence-editor/i18n/translations.i18n"),
e=[],i;for(i in c.hints)e.push("hints."+i);var m=x(e),l=function(){b("#rte-savebar .hints-text").html(g.Rte.getEditor().getLang(m.getNextHint()))};l();b("#rte-savebar a.hints-close").click(function(a){b(this).closest(".toolbar-split").addClass("hidden");a.preventDefault()});b("#rte-savebar a.hints-next").click(function(b){l();b.preventDefault()});i=g.Rte.EventDelegator(a);b(o).trigger("initContextToolbars.Toolbar",a);b(o).bind("createContextToolbarRow.Toolbar",B).bind("removeContextToolbarRow.Toolbar",
A).bind("enableContextToolbarRow.Toolbar",y).bind("disableContextToolbarRow.Toolbar",z);i.addEventsForComponent("TableToolbar",n.tableToolbar.Events);var p=b("#format-dropdown"),s=p.find("span.dropdown-text");a.onBeforeExecCommand.add(function(a,c,e,d,f){b.each(["pre","blockquote"],function(){if(c=="FormatBlock"&&d==this){a.formatter.remove("alignleft");a.formatter.remove("aligncenter");a.formatter.remove("alignright")}});if(b(a.selection.getNode()).closest("pre,.text-placeholder").length)for(var e=
["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],h=e.length,t=0;t<h;t++)if(c==e[t])f.terminate=true;if(c=="FormatBlock"&&d=="pre"){a.undoManager.add();a.execCommand("removeFormat")}if(c=="FormatBlock"&&d=="p"){e=p.find(".dropdown-item[data-format='blockquote']").text();
if(s.text()==e){f.terminate=true;a.execCommand("FormatBlock",false,"blockquote")}}else if(c=="FormatBlock"&&d=="removeformat"&&a.selection.isCollapsed()){f.terminate=true;g.debug("Not removing format for no selected text")}});a.onExecCommand.add(function(b,a,c,e){if(a=="FormatBlock"){b=p.find(".dropdown-item[data-format='"+e+"']");b.length||(b=p.find(".dropdown-item[data-format='p']"));s.text(b.text())}});a.onNodeChange.add(function(a,c,e){var d,f=e,f=b(f).closest("PRE,BLOCKQUOTE,.text-placeholder");
d=function(b){return f.is(b)};var a=d("BLOCKQUOTE"),g=d("PRE");d=d(".text-placeholder");if(g){c=b(e).parents("table").is("[data-macro-body-type='PLAIN_TEXT']");q(true,c)}else if(d)q(true);else if(a){c.setDisabled("justifyleft",a);c.setDisabled("justifycenter",a);c.setDisabled("justifyright",a)}else q(false)});a.onInit.add(function(a){g.debug("customtoolbar: ed.onInit function");var c={};b(".aui-toolbar").find("[data-control-id]").each(function(e,d){var f,d=b(d);d.closest(".toolbar-item");f=d.attr("data-control-id");
if(f=="formatselect"){f=a.theme.controlHandlers[f];f.state.add(function(a){var c=g.Rte.getEditor();if(a=="p"){c=c.selection.getNode();b(c).closest("p").parent().is("blockquote")&&(a="blockquote")}(a=p.find(".dropdown-item[data-format='"+a+"']").text())&&s.text(a)})}else c[f]=d});var e=a.theme.controlHandlers.buttons;e.state.add(function(a,b,e){var d=c[a];if(d){a=d.find(".icon-check");d=d.closest(".toolbar-item");a.length?a.toggleClass("hidden",!e):d.toggleClass(b,e)}});b(".aui-toolbar").delegate(".toolbar-item",
"click",function(a){var c=b(this);if(c.hasClass("disabled"))a.preventDefault();else if(c=c.children(".toolbar-trigger[data-control-id]").attr("data-control-id")){e.click.dispatch(c);a.preventDefault()}});b.support.shrinkWrapBlocks=false;g.debug("customtoolbar: finished ed.onInit function")})},toggleToolbarButton:l,disableToolbarButton:function(a){l(b("."+a.replace(".","")),true)},enableToolbarButton:function(a){l(b("."+a.replace(".","")),false)},focusToolbarButton:function(a){b("."+a.replace(".",
"")).closest(".aui-button").focus()},isToolbarRowEnabled:function(a){a=k({id:a});return b("#"+a).length>0&&!b("#"+a).hasClass("disabled")},getToolbarRow:function(a){a=k({id:a});a=b("#"+a);return a.length?a[0]:null},isToolbarButtonEnabled:function(a){return!b("."+a.replace(".","")).closest(".aui-button").prop("disabled")},bindDropdownMenu:j,toggleToolbarButtons:q,getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",
version:"1.0"}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/customtoolbar/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.customtoolbar",b);g.PluginManager.add("customtoolbar",g.plugins.customtoolbar)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/thirdpartycode/tipsy.js' */
(function(a){a.fn.tipsy.autoBounds2=function(f,b){return function(){var d,c,g=a(document).scrollTop()+f,h=a(document).scrollLeft()+f,e=a(this);1<b.length?(d=b[0],c=b[1]):"e"==b[0]||"w"==b[0]?c=b[0]:d=b[0];e.offset().top<g&&(d="n");e.offset().left<h&&(c="w");a(window).width()+a(document).scrollLeft()-(e.offset().left+e.width())<f&&(c="e");a(window).height()+a(document).scrollTop()-(e.offset().top+e.height())<f&&(d="s");return d?d+(c?c:""):c}}})($);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/chunky-tips.js' */
define("confluence-editor/tinymce3/plugins/customtoolbar/chunky-tips",["ajs","tinymce","jquery"],function(b,j,a){return function(){function h(b,d,c){if("dropdown"===d&&(a(".tipsy").remove(),c&&(c.trigger&&c.trigger.jquery)&&(b=c.trigger.data("tipsy"))))b.hoverState="out"}function i(){a(".tipsy").remove()}b.debug("Enabling Chunky Tooltip for the editor");var e={live:!0,gravity:"n",title:function(){return a(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},f=a.fn.tipsy.autoBounds2(50,"n"),g=a.fn.tipsy.autoBounds2(50,
"s"),k=a.fn.tipsy.autoBounds2(50,"w"),f=a.extend({},e,{gravity:f});a.extend({},e,{gravity:g});g=a.extend({},e,{gravity:k});e=a.extend({},e,{gravity:"se"});a("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(f);a("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(g);a("#rte-savebar [data-tooltip]").tooltip(e);a("#editor-precursor [data-tooltip]").tooltip(f);a("#property-panel [data-tooltip]").tooltip(f);a(document).bind("showLayer",h);a(document).bind("hideLayer",h);b.bind("created.property-panel",
i);b.bind("destroyed.property-panel",i);var l=/\+/g;b.bind("register-contexts.keyboardshortcuts",function(){setTimeout(function(){a("#rte-savebar .aui-button[title]").each(function(){var b=a(this),d=b.attr("title");b.removeAttr("title");if(j.isMac){var c=d.indexOf("(");0<=c&&(d=d.substr(0,c)+d.substr(c).replace(l,""))}b.attr("data-tooltip",d)})},0)})}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/customtoolbar/chunky-tips",function(b){require("ajs").bind("init.rte",b)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/linkify",function(){return{RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,
f,!0,!1,b,i);f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;
if(0<=b.substring(a,c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,
j)+"...");p&&(a=a.replace(RegExp("([/=])","g"),"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/linkify","linkify");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter",["jquery","confluence-editor/tinymce3/plugins/confluencepaste/linkify","ajs","document","tinymce"],function(c,q,r,y,z){function u(a,b){for(var f=c(a).find("["+b+"]"),d="",e="",g="",h=0,k=f.length;h<k;h++)e=(d=c(f[h]))&&["/",d.attr(b)].join(""),g=d&&["/",d.attr("data-mce-"+b)].join(""),r.contextPath()&&0===e.indexOf(r.contextPath())&&(f[h]=d.attr(b,e)),r.contextPath()&&0===g.indexOf(r.contextPath())&&(f[h]=d.attr("data-mce-"+
b,g));return f}function m(a,b,f){var a=c(a).find("["+b+"]"),d="",e,g;if(a)for(var h=0,k=a.length;h<k;h++){e=c(a[h]);g=f.standard;for(var n in f)if(f.hasOwnProperty(n)&&e.is(n)){g=f[n];break}if(-1<b.indexOf("style")){var d=e,i=g;g=[];for(var o="",o=void 0,p=d.attr("style"),l=d.attr("data-mce-style"),j=0,m=i.length;j<m;j++)p&&-1<p.toLowerCase().indexOf(i[j])?g.push(i[j]+": "+d.css(i[j])+";"):l&&-1<l.toLowerCase().indexOf(i[j])&&(o=RegExp(i[j]+":.+?(?:;|$)"),o=l.match(o),g.push(-1<o[0].indexOf(";")?
o:o+";"));d=g.join(" ")}else{d=e;i=b;p=[];if(g){l=0;for(j=g.length;l<j;l++)d.is("["+i+"~="+g[l]+"]")&&p.push(g[l])}d=p.join(" ")}e.removeAttr(b);d.length&&e.attr(b,d)}}function A(a,b){function f(f){var e;d.index&&(e=a.splitText(d.index),a&&b.push(a),a=e);(e=a.splitText(d[0].length))&&b.push(e);c(a).wrap("<a href='"+f+a.data+"'></a>")}var d,e,g;e=s.exec(a.data);g=t.exec(a.data);e?(d=e,f("mailto:")):g&&(e=(d=g)&&-1===d[0].indexOf("://")?"http://":"",f(e))}var t;q.init();var v=RegExp(q.RE_FULL_URL),
w=RegExp(q.RE_OTHER_URL);t={exec:function(a){var b=v.exec(a);return b?b:w.exec(a)},test:function(a){return v.test(a)||w.test(a)}};var s,x=RegExp(q.RE_EMAIL_PATTERN);s={exec:function(a){if((a=x.exec(a))&&/\s/.test(a[0][0]))a[0]=a[0].replace(/\s/,""),a.index++;return a},test:function(a){return x.test(a)}};c(y).bind("postPaste",function(a,b,f){a=f.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],span:["color","text-decoration"],
pre:["margin-left"]};b.td=b.th=["text-align"];b.li=["list-style-type","background-image"];b.col=["width"];b["table.confluenceTable.relative-table"]=["width"];m(a,"style",b);m(a,"data-mce-style",b);c.browser.mozilla&&(u(a,"src"),u(a,"href"));m(a,"face",{standard:[]});m(a,"id",{standard:[]});m(a,"data-mce-href",{standard:[]});a=f.node;b=[];b.push({elements:["div"],attribute:"class",blackValue:"aui-buttons"});for(var d=0;d<b.length;d++)for(var e=b[d],g=0;g<e.elements.length;g++)for(var h=c(a).find(e.elements[g]+
"["+e.attribute+"]"),k=0;k<h.length;k++){var n=h.eq(k).attr(e.attribute),n=n.replace(e.blackValue,"");h.eq(k).attr(e.attribute,n)}var i=f.node;c.each(".contentLayout .contentLayout2 .columnLayout .header .footer .cell .innerCell .panelContent .panel .panelHeader .Apple-converted-space font .jira-status .jira-issue .diff-html-removed .diff-html-added .diff-html-changed".split(" "),function(a,b){c(b,i).contents().unwrap()});c("img",i).map(function(){c(this).attr("data-attachment-copy","");!c(this).attr("src")&&
c(this).remove()});c("dl",i).map(function(){c(this).replaceWith(c("<p/>").text(c(this).text()))});c("a",i).map(function(){c(this).removeClass("confluence-userlink userLogoLink")});if(!c.browser.msie)for(a=c.makeArray(f.node.childNodes);a.length;)b=a.pop(),c(b).is("a")||(3===b.nodeType?A(b,a):1===b.nodeType&&(b.childNodes&&"pre"!==b.nodeName.toLowerCase())&&(a=a.concat(c.makeArray(b.childNodes))));if(a=c.browser.mozilla)a=c(f.node),a=a.children("br").length&&!a.find(":not(br)").length&&!c(z.activeEditor.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length;
a&&(f=c(f.node),a="<p>"+f.html().replace(/<br>/gi,"</p><p>")+"</p>",f.html(a))});return{URL:t,EMAIL:s}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","Confluence.Editor.regex");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",["jquery","document"],function(g,c){return{init:function(i){function m(a){var d={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},f=["highlight","nohighlight","relative-table","fixed-table"],b,e=0,c=[],h=g(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=
a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=g("table",a),a.length)g(a).unwrap(),a=a[0];else return null;if((!a.tagName?0:"TABLE"===a.tagName||"TR"===a.tagName||"TH"===a.tagName||"TD"===a.tagName||"TBODY"===a.tagName||"THEAD"===a.tagName||"TFOOT"===a.tagName||"COL"===a.tagName||"COLGROUP"===a.tagName||"CAPTION"===a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!(b.name in d)?a.removeAttribute(b.name):e++;k(a)&&c.push(k(a));d=0;for(e=
f.length;d<e;d++)f[d].exec||h.hasClass(f[d])&&c.push(f[d]);(f=h.attr("data-highlight-class"))&&c.push(f);(f=h.attr("data-highlight-colour"))&&c.push("highlight-"+f);h.attr("class",c.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"===a.tagName?"confluenceTable":"TH"===a.tagName?"confluenceTh":"TD"===a.tagName?"confluenceTd":""}function j(a){var d="";a&&a.getAttribute&&(d=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!==a.tagName?!1:!d?!1:-1!==d.indexOf("wysiwyg-macro")}function l(a,
d,c){for(var a=c.node,d=m,b=a,e="";b;)if("function"===typeof d&&(b=d(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;c.node=a}i.onInit.add(function(){g(c).bind("postPaste",l)});i.onRemove.add(function(){g(c).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",function(g){var c=require("tinymce");c.create("tinymce.plugins.ConfluencePasteTablePlugin",g);c.PluginManager.add("confluencepastetableplugin",c.plugins.ConfluencePasteTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepastemacro/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastemacro/editor_plugin_src",["jquery","document","tinymce"],function(f,a,g){return{init:function(e){var c=this,b=function(b,d,a){d=e.getDoc();f(e.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length&&(c.bindPostSerializeHandler(e),b=c.parseHtml(e,a.node),d=d.createElement("div"),d.appendChild(b),a.node=d)};e.onInit.add(function(){f(a).bind("postPaste",b)});e.onRemove.add(function(){f(a).unbind("postPaste",b)})},bindPostSerializeHandler:function(e){function c(e,
d){d.content=d.content.replace(/^<pre>|<\/pre>$/g,"");b.remove(c)}var b=e.serializer.onPostProcess;b.add(c)},parseHtml:function(e,c){for(var b=f.makeArray(c.childNodes),a,d=e.getDoc(),h=d.createElement("pre");b.length;)a=b.shift(),a.childNodes.length?(g.html.Schema.blockElementsMap[a.nodeName]&&b.unshift(d.createElement("br")),b=f.makeArray(a.childNodes).concat(b)):(a=this.formatMacroContent(a,d))&&h.appendChild(a);return h},formatMacroContent:function(a,c){var b,g=/\xA0/g,c=c||window.document;3===
a.nodeType?b=c.createTextNode(f(a).text().replace(g," ")):"BR"===a.nodeName&&(b=c.createElement("br"));return b},getInfo:function(){return{longname:"ConfluencePasteMacroPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastemacro/editor_plugin_src",function(f){var a=require("tinymce");a.create("tinymce.plugins.ConfluencePasteMacroPlugin",f);a.PluginManager.add("confluencepastemacroplugin",a.plugins.ConfluencePasteMacroPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confcursortarget/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcursortarget/editor_plugin_src",["jquery","ajs","tinymce","confluence/meta"],function(d,f,i,s){var k=".wysiwyg-macro,.placeholder,table";return{cursorTarget:{addFixSelector:function(d){k+=","+d}},cursorTargetPlugin:{init:function(e){function n(a,b){d(k,a).each(function(a,l){var f=function(a){if(0===a.length)throw Error("no paragraph element specified");y()&&a.addClass("auto-cursor-target");a=a[0];0===a.childNodes.length&&(a.innerHTML="<br />");return a},
e=function(a,b){var c=d("<p/>");if(d(a.parentNode).is("li, td, th"))for(;a[b]&&!d(a[b]).is(u);)c["previousSibling"==b?"prepend":"append"](a[b]);return f(c)},h=d(l);(!h.prev().length||h.prev(k).length||d(l.parentNode).is("li, td, th")&&!d(l.previousSibling).is(u))&&h.before(e(l,"previousSibling"));(!h.next().length||h.next(".synchrony-container").length||d(l.parentNode).is("li, td, th")&&!d(l.nextSibling).is(u))&&h.after(e(l,"nextSibling"));y()&&h.next().length&&(!h.next().next().length&&o(h.next()[0]))&&
h.next().addClass("auto-cursor-target");if(b){var e=function(a){("BR"===a[0].nodeName||o(a[0]))&&a.replaceWith(f(d("<p/>")))},g=h.prev(),j;if(j=g.length)a:{for(j=g.prev();j.length&&!j.is(k);){var i=j[0];if("BR"!==i.nodeName&&"P"!==i.nodeName){j=!1;break a}j=j.prev()}j=!0}j&&e(g);h=h.next();if(g=h.length)a:{for(g=h.next();g.length&&!g.is(k);){j=g[0];if("BR"!==j.nodeName&&"P"!==j.nodeName){g=!1;break a}g=g.next()}g=!0}g&&e(h)}})}function y(){return s.getBoolean("shared-drafts")&&"limited"!==s.get("edit-mode")&&
("page"===s.get("content-type")||"blogpost"===s.get("content-type"))}function z(a){d("p",a).each(function(a,c){o(c)&&p(c)&&d(c).attr("data-tag","marked-for-deletion")});d("p[data-tag=marked-for-deletion]",a).remove();return a}function o(a){function b(a){for(var b=0,d=0,e=0,f=a.childNodes.length;e<f;e++){var g=a.childNodes[e];if("BR"===g.nodeName){if(1<++b)return!1}else if(/^[\s|\u00A0]$/.test(g.nodeValue)){if(1<++d)return!1}else if(""!==g.nodeValue)return!1}return!0}return 1===a.nodeType&&0===a.childNodes.length||
b(a)}function p(a){if(!a||1!==a.nodeType)return!1;var b=q(a,!1),c=q(a,!0),a=t(b)||d(b).is(k),e=t(c)||d(c).is(k),b=t(b)&&t(c);return a&&e&&!b}function t(a){return a?a.className&&/cell|header|footer/.test(a.className):!0}function q(a,b){var c=d(a);do{var e=b?c[0].nextSibling:c[0].previousSibling;if(e)return e;c=c.parent()}while(0<c.length&&!c.is(".cell, .mceContentBody, td, li"));return null}function v(a){var b=a.startContainer;return 3===b.nodeType?!(b.previousSibling&&(3===b.previousSibling.nodeType||
d(b.previousSibling).is("br")))&&0===a.startOffset:1===b.nodeType?0===a.startOffset:!1}function A(a){var a=d(a).children(),b;for(b=0;b<a.length;b++)if(!o(a[b])&&(d(a[b]).contents().filter(function(){return 3===this.nodeType}).length||A(a[b])))return!0;return!1}function w(a,b){var c;if(c=b.startContainer==b.endContainer)if(c=1===b.startContainer.nodeType)c=b.startOffset,a||c--,c=0<=c&&c<b.startContainer.childNodes.length&&"TABLE"===b.startContainer.childNodes[c].nodeName;return c}function B(a){if(!a.collapsed)return!1;
var b=a.startContainer,c;if(3===b.nodeType)return c=q(b,!0),a.startOffset==b.nodeValue.length&&(null==c||d(c).is("br"));if(1===b.nodeType){if(d(b).is("td, th")&&0===a.startOffset&&0<b.childNodes.length)return d(b.childNodes[0]).is("br");c=q(b.parentNode.childNodes[0===a.startOffset?0:a.startOffset-1],!0);return null==c||d(c).is("br")}return!1}function C(a){return a&&1===a.childNodes.length&&d(a.childNodes[0]).is("br")}function D(a,b){return i.isWebKit&&w(!1,b)||i.isGecko&&(B(b)||p(a)&&0===b.startOffset&&
C(a))?!0:!1}function E(a,b){var c;if(c=i.isWebKit)if(!(c=w(!0,b)))if(!(c=v(b)&&p(a)))c=e.getBody(),c=c.childNodes.length?b.collapsed&&0===b.startOffset&&c.childNodes[0]==b.startContainer:!1;return c||i.isGecko&&v(b)&&p(a)&&C(a)?!0:!1}function x(a,b){var c=b.keyCode;if(c!==m.BACKSPACE&&c!==m.DELETE)return!0;a.selection.isCollapsed()?c===m.BACKSPACE&&E(a.selection.getNode(),a.selection.getRng(F))?i.dom.Event.prevent(b):c===m.DELETE&&D(a.selection.getNode(),a.selection.getRng(F))&&i.dom.Event.prevent(b):
n(a.getBody());return!0}var F=!0,u="ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6",m=d.ui.keyCode,r=function(){n(e.getBody(),!0)},G=function(a){n(a,!1);i.isIE10&&d("p, td.confluenceTd, th.confluenceTh",a).each(function(a,c){c&&""===c.innerHTML&&d(c).html("<br />")})};f.Meta.get("shared-drafts")&&("page"===f.Meta.get("content-type")||"blog"===f.Meta.get("content-type"))&&"collaborative"===f.Meta.get("edit-mode")?f.bind("cursor-target-refresh",function(){G(e.getBody())}):(e.onSetContent.add(function(a){n(a.getBody());
var a=a.getBody(),b=i.isIE?"&nbsp;":"<br/>";d("p, td.confluenceTd, th.confluenceTh",a).each(function(a,e){e&&(e.childNodes&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&e.childNodes[0].nodeValue&&1===e.childNodes[0].nodeValue.length&&160===e.childNodes[0].nodeValue.charCodeAt(0))&&d(e).html(b)})}),e.onGetContent.add(function(a,b){var c=z(d("<div class='root-node'>"+b.content+"</div>")),c=f.Rte.getEditor().serializer.serialize(c[0],b);b.content=c.substring(23,c.length-6)}),e.onInit.add(function(){e.selection.onSetContent.add(r);
e.dom.bind(e.getBody(),"cut",r);f.bind("cursor-target-refresh",r)}),e.onRemove.add(function(){f.unbind("cursor-target-refresh",r)}),i.isGecko&&e.onKeyDown.add(function(a,b){(b.keyCode===m.ENTER||b.keyCode===m.BACKSPACE||b.keyCode===m.DELETE)&&a.selection.normalize()}),e.onKeyDown.add(x),e.onKeyUp.add(x),i.isGecko&&e.onKeyPress.add(x),e.onPaste.add(r));d.extend(this,{isCursorBeforeAfterTable:w,isCursorTarget:p,_isTextContainerEmpty:o,_processCursorTargets:z,_isCursorAtStartOfContainer:v,_isCursorAtEndOfContainer:function(a){var b=
a.startContainer;if(b.nodeType===3)return!(b.nextSibling&&(b.nextSibling.nodeType===3||d(b.nextSibling).is("br")))&&a.endOffset==b.nodeValue.length;if(b.nodeType===1){var c=b.childNodes[a.startOffset];return d(c).is("br")&&c.nextSibling==null?true:a.endOffset==b.childNodes.length}return false},_getSiblingWithinBlockDisregardingNesting:q,_doesContainerHaveNestedContent:A,_addCursorTargetParagraphsToContent:n,_isCursorAtEndOfBottomRightCellInTable:B,_shouldCancelDelete:D,_shouldCancelBackspace:E,_collabEditingCursorTargetRefresh:G});
f.Rte.Cursor=f.Rte.Cursor||{};d.extend(f.Rte.Cursor,{isTextContainerEmpty:o,fixCursorTargets:n})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcursortarget/editor_plugin_src",function(d){require("confluence/module-exporter").namespace("AJS.Rte.CursorTarget",d.cursorTarget);var f=require("tinymce");f.create("tinymce.plugins.CursorTargetPlugin",d.cursorTargetPlugin);f.PluginManager.add("cursorTarget",f.plugins.CursorTargetPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",["tinymce","jquery"],function(d,f){return{init:function(g){if(d.isWebKit){var h={},i=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=i(h,a),b=i(a,b);b[c]||(b[c]=f(this).attr("data-format"))});g.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),
b=a.dom.select("font.Apple-style-span",a.dom.doc.body),c=c.concat(b),b=0,k=c.length;b<k&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}g.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===c[d].src.substr(0,
8)&&a.dom.remove(c[d])});if(d.isIE9){var j=function(a){a.getBody().childNodes.length||a.setContent("<p>\ufeff</p>")};g.onNodeChange.add(j);g.onSetContent.add(j)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",function(d){var f=require("tinymce");f.create("tinymce.plugins.ConfluenceCleanupPlugin",d);f.PluginManager.add("confluencecleanupplugin",f.plugins.ConfluenceCleanupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'com/atlassian/confluence/tinymceplugin/auiwindowmanager.js' */
define("confluence-editor/tinymceplugin/auiwindowmanager","ajs tinymce jquery raphael window confluence/api/constants confluence/dialog".split(" "),function(h,g,e,k,l,m,n){var i=g.util.Dispatcher,j=g.isIE;return{AUIWindowManager:{init:function(a){a.onBeforeRenderUI.add(function(){a.windowManager=new g.AUIWindowManager(a)})},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:g.majorVersion+"."+g.minorVersion}}},WindowManager:{AUIWindowManager:function(a){this.editor=
a;this.onOpen=new i(this);this.onClose=new i(this);this.params={};this.features={};this.modalDialogsStack=[];this.dialogs={};this.count=0},open:function(a,c){g.DOM.getViewPort();a=a||{};this.initialiseSettings(a);c=c||{};c=this.setDefaultParameters(c);c.mce_width=a.width;c.mce_height=a.height;c.mce_auto_focus=a.auto_focus;if(j){a.center=true;a.help=false;a.dialogWidth=a.width+"px";a.dialogHeight=a.height+"px"}this.features=a;this.params=c;this.onOpen.dispatch(this,a,c);var b=a.height;a.name&&(b=b+
56);if(c.cancelLink||c.buttons)b=b+51;b=b+40;a.popup&&(b=b+8);var d=a.id||g.DOM.uniqueId(),f=new n.component({width:a.width,height:b,id:d,onCancel:function(){f.hide().remove()}});a.name&&f.addHeader(this.editor.getLang(a.name));this.createDialogButtons(f,c,d);a.file=a.file||a.url;if(a.file)a.file=g._addVer(a.file);this.createDialogContent(f,a,c,d);c.helpLink&&this.createHelpLink(f,c.helpLink,c.helpName,d);c.hintText&&this.createHintText(f,c.hintText,d);b={id:d,settings:a,params:c,dialog:f};this.modalDialogsStack.push(b);
this.dialogs[d]=b;this.count++;h.Rte.BookmarkManager.storeBookmark();f.show();f.takeFocus!=void 0&&f.takeFocus();if(j){e("#"+d).css("overflow","hidden");e("#"+d+" ."+c.cssClass).css("overflow","hidden")}return d},initialiseSettings:function(a){a.width=parseInt(a.width||400,10);a.height=parseInt(a.height||250,10);a.resizable=false;if(a.popup==void 0)a.popup=true;if(a.popup&&a.content!=void 0)a.popup=false;a.scrollbars=a.scrollbars?"yes":"no"},createDialogButtons:function(a,c,b){if(c.buttons)for(var d=
0,d=0;d<c.buttons.length;d++){var e=c.buttons[d];a.addButton(this.editor.getLang(e.label),e.action)}c.cancelLink&&a.addCancel(this.editor.getLang("auiwindowmanager.cancel"),function(){return g.activeEditor.windowManager.close(b)})},createDialogContent:function(a,c,b,d){var f=this.createContentId(d),d="panel_"+f;if(c.popup){a.addPanel(d,e("<iframe id='"+f+"' width='100%' height='"+c.height+"px' frameborder='0' name='auidialogiframe' src='"+c.file+"' scrolling='"+c.scrollbars+"'></iframe>"),b.cssClass);
a.takeFocus=function(){e("#"+f).focus()}}else{if(c.content==void 0){a.addPanel(d,e("<div id='"+f+"'/>"),b.cssClass);e("#"+f).load(c.file)}else a.addPanel(d,e("<div id='"+f+"'>"+c.content+"</div>"),b.cssClass);a.takeFocus=function(){var a=e("#"+f+" :input");if(a.length)e(a[0]).focus();else{a=e("#"+f+" .button-panel button");a.length&&e(a[0]).focus()}}}a.gotoPanel(0,0)},createHintText:function(a,c,b){a=e("<div></div>").addClass("dialog-tip");a.text(g.activeEditor.getLang(c));e("#"+b+" .dialog-button-panel").append(a)},
createHelpLink:function(a,c,b,d){a=e("<div></div>").addClass("dialog-help-link");a.load(m.CONTEXT_PATH+"/plugins/tinymce/helplink.action",{linkUrlKey:c,linkNameKey:b||""});e("#"+d+" .dialog-components .dialog-title").prepend(a)},close:function(a,c){var b,d;if(typeof a==="string")b=a;else if(c)b=c;else if(d=this.modalDialogsStack.pop())b=d.id;if(this.dialogs[b]){this.count--;d=this.dialogs[b];d.dialog.remove();this.dialogs[b]=null;g.activeEditor.focus();h.Rte.BookmarkManager.restoreBookmark()}else h.log("Couldn't find id "+
b+" in dialogs array so dialog is not closed.");return false},alert:function(a,c,b){var d;d=this.open({content:"<p>"+a+"</p>",width:500,height:160,popup:false},{buttons:[{label:"auiwindowmanager.ok",action:function(){g.activeEditor.windowManager.toggleOtherDialogs(d,true);g.activeEditor.windowManager.close(d);c&&c.call(b||this)}}],cancelLink:false,cssClass:"tinymce-auidialog-alert"});this.toggleOtherDialogs(d,false)},createInstance:function(a,c,b,d,e,h){return new (g.resolve(a))(c,b,d,e,h)},toggleOtherDialogs:function(a,
c){for(var b=0,b=0;b<this.modalDialogsStack.length;b++){var d=this.modalDialogsStack[b];d.id!=a&&e("#"+d.id+" .dialog-button-panel").toggle(c)}},confirm:function(a,c,b,d){d=d||l;c.call(b||this,d.confirm(this._decode(this.editor.getLang(a,a))))},setBusy:function(a,c){if(this.dialogs[a])if(c){var b,d;b=this.createContentId(a);b=e("#"+b);b.hide();var f=b.parent();b=this.createBusyContentId(a);d=e("#"+b,f);if(!d.length){f.append(e("<div id='"+b+"' class='spinner'></div>"));d=e("#"+b,f);k.spinner(d[0],
50,"#666")}e(".button-panel button",e("#"+a)).each(function(a,b){e(b).prop("disabled",true)});e(d[0]).show()}else{b=this.createBusyContentId(a);d=e("#"+b);d.length&&e(d[0]).hide();b=this.createContentId(a);b=e("#"+b);e(".button-panel button",e("#"+a)).each(function(a,b){e(b).prop("disabled",false)});e(b[0]).show()}},logMCESelection:function(a){var c=g.activeEditor.selection;h.log("******************************");h.log("Logging TinyMCE selection title:    "+a);h.log("Bookmark:");h.log(c.getBookmark());
a=e(c.getRng().startContainer).text()||e(c.getRng().startContainer.parentNode).text();h.log("Range: "+a);h.log(c.getRng())},setDefaultParameters:function(a){a.inline=false;if(!a.cssClass)a.cssClass="tinymce-auidialog";if(a.cancelLink!=false)a.cancelLink=true;return a},createContentId:function(a){return"content_"+a},createBusyContentId:function(a){return"content_busy_"+a}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymceplugin/auiwindowmanager",function(h){var g=require("tinymce");g.create("tinymce.plugins.AUIWindowManager",h.AUIWindowManager);g.create("tinymce.AUIWindowManager:tinymce.WindowManager",h.WindowManager);g.PluginManager.add("auiwindowmanager",g.plugins.AUIWindowManager)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'macrobrowser/tinymce-macrobrowser.js' */
define("confluence-editor/macrobrowser/tinymce-macrobrowser",["jquery","tinymce","ajs","confluence/api/constants","confluence/get-content-id"],function(c,e,d,g,h){return{storedRange:null,bookmark:null,getCurrentNode:function(){return c(e.activeEditor.selection.getNode())},isMacroDiv:function(a){return c(a).hasClass("wysiwyg-macro")},isMacroTag:function(a){a=c(a);return a.hasClass("wysiwyg-macro")||a.hasClass("editor-inline-macro")},isBodylessMacro:function(a){return c(a).hasClass("editor-inline-macro")},
isMacroWithBody:function(a){return c(a).hasClass("wysiwyg-macro")},isMacroStartTag:function(a){return c(a).hasClass("wysiwyg-macro-starttag")},isMacroEndTag:function(a){return c(a).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(a){return c(a).hasClass("wysiwyg-macro-body")},hasMacroBody:function(a){return"true"==c(a).attr("macrohasbody")},getNestingMacros:function(a){var b=[];c(a||this.getCurrentNode()).parents(".wysiwyg-macro").each(function(){b.push(c(this).attr("data-macro-name"))});return b},
logMCESelection:function(a){var b=e.activeEditor.selection;d.log("******************************");d.log("Logging TinyMCE selection title:    "+a);d.log("Bookmark:");d.log(b.getBookmark());a=c(b.getRng().startContainer).text()||c(b.getRng().startContainer.parentNode).text();d.log("Range: "+a);d.log(b.getRng())},getSelectedMacro:function(){var a=e.confluence.macrobrowser,b=a.getCurrentNode();d.log("getSelectedMacro: $selectionNode="+b[0]);return a.isMacroDiv(b)?b:e.confluence.MacroUtils.isInMacro(b)},
openMacro:function(a){d.MacroBrowser.open({selectedMacro:a,onComplete:e.confluence.macrobrowser.macroBrowserComplete,onCancel:e.confluence.macrobrowser.macroBrowserCancel})},editMacro:function(a){var b=e.confluence.macrobrowser,a=c(a);b.editedMacroDiv=a[0];var f=d.Rte.getEditor().serializer.serialize(a.clone()[0],{forced_root_block:!1});d.Rte.getEditor().selection.select(a[0]);d.Rte.BookmarkManager.storeBookmark();c.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:g.CONTEXT_PATH+
"/rest/tinymce/1/macro/definition",data:c.toJSON({contentId:h(),macroHtml:f}),dataType:"text",success:function(a){b.openMacro(c.secureEvalJSON(a))}})},macroBrowserToolbarButtonClicked:function(a){var b=e.confluence.macrobrowser,f=e.activeEditor,g=b.getCurrentNode();d.Rte.BookmarkManager.storeBookmark();b=c.extend({presetMacroName:null,nestingMacros:b.getNestingMacros(g),onComplete:b.macroBrowserComplete,onCancel:b.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},a);a.ignoreEditorSelection||
(b.selectedHtml=f.selection.getContent(),b.selectedText=f.selection.getContent({format:"text"}));d.MacroBrowser.open(b)},macroBrowserComplete:function(a){var b=e.confluence.macrobrowser,a={contentId:d.Meta.get("content-id")||"0",macro:{name:a.name,params:a.params,defaultParameterValue:a.defaultParameterValue,body:a.bodyHtml}};d.Rte.BookmarkManager.restoreBookmark();b.editedMacroDiv?(e.confluence.MacroUtils.insertMacro(a,b.editedMacroDiv),delete b.editedMacroDiv):e.confluence.MacroUtils.insertMacro(a)},
macroBrowserCancel:function(){var a=e.confluence.macrobrowser;d.Rte.BookmarkManager.restoreBookmark();a.editedMacroDiv=null;a.editedMacro=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/macrobrowser/tinymce-macrobrowser","tinymce.confluence.macrobrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/tinymce-image-utils.js' */
define("confluence-editor/utils/tinymce-image-utils","jquery confluence/api/logger confluence/meta ajs tinymce confluence/api/constants confluence/property-panel".split(" "),function(d,h,q,l,n,r,m){var o=["imagetext","src","align","border","width","height"],s=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,p=function(a,b,g,c,e){if(c){if(b>=e)a.width=e;a.style.maxWidth=""}else{if(g>=e)a.height=e;a.style.maxHeight=""}},i;i={isScaledByWidth:function(){return false},updateImageElement:function(a,b){var g=
d(a),c;c=b.destination;c=i.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;g.toggleClass("confluence-content-image-border",!!b.border);g.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var e=o.length;c<e;c++){var f=o[c],j=b[f];j!==false&&j!=null?g.attr(f,j):g.removeAttr(f)}n.activeEditor.undoManager.add()},insertFromProperties:function(a,b){d.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:r.CONTEXT_PATH+
"/rest/tinymce/1/embed/placeholder/image",data:d.toJSON(a),dataType:"text",success:function(a){i.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var g,c=i.isScaledByWidth(),e=d(a);g=c?m.Image.getPresetImageSize("large"):q.get("content-type")==="comment"?m.Image.getPresetImageSize("small"):m.Image.getPresetImageSize("medium");e.css(c?"max-width":"max-height",g+"px");var f=n.activeEditor,j="_"+ +new Date,h=d("<div></div>").append(e.attr("id",j));f.selection.setContent(h.html());
var k=f.dom.get(j);f.dom.setAttrib(k,"id","");e.hasClass("confluence-external-resource")||p(k,e.attr("data-image-width"),e.attr("data-image-height"),c,g);d(k).one("load",function(){e.hasClass("confluence-external-resource")&&p(this,this.width,this.height,c,g);l.Rte.showSelection(function(){b||l.trigger("trigger.property-panel",{elem:k});f.undoManager.add()});f.onChange.dispatch()})},isRemoteImg:function(a){var b=l.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&a.indexOf(b)===-1},isThumbnailUsable:function(a,
b,d,c,e,f){if(a){if(a>e)return false;e=d/c;return e>=1?true:e*f>=a}a=b;if(a>f)return false;f=c/d;return f>=1?true:f*e>=a}};return{ImageProperties:function(a){if(a&&d.nodeName(a,"img")&&d(a).hasClass("confluence-embedded-image")){var b=d(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&b.attr("class").indexOf("confluence-content-image-border")!==-1?1:0,width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&!b.attr("height")};if(!i.isRemoteImg(a.destination)&&
!d(b).hasClass("confluence-external-resource")){var g=a;var b=d(b).attr("src"),c=b.match(s);if(c&&c.length===3)b=c[2];else{h.log("ERROR: could not parse page id from image url "+b);b="0"}g.pageId=b}return d.extend({},a)}if(a.destination){a.imageFileName=a.imageFileName||a.destination;return d.extend({},a)}return null},ImageUtils:i}});
require("confluence/module-exporter").safeRequire("confluence-editor/utils/tinymce-image-utils",function(d){var h=require("tinymce");h.confluence.ImageProperties=d.ImageProperties;h.confluence.ImageUtils=d.ImageUtils});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/tinymce-macro-utils.js' */
define("confluence-editor/utils/tinymce-macro-utils",["tinymce","ajs","confluence/legacy-editor-global-AVOID-IF-POSSIBLE","jquery","confluence/get-content-id"],function(h,f,l,e,p){var n,o=function(a,c){var d;if(a.macro&&a.contentId)d={type:"POST",url:f.contextPath()+"/rest/tinymce/1/macro/placeholder",contentType:"application/json; charset=utf-8",data:e.toJSON(a),dataType:"text"};else if(a.url&&a.type)d=a;else throw Error("illegal argument received: "+a);var b=e.Deferred(),g=f.Rte.getEditor(),i,m;
c||(m="macro-"+(new Date).getTime(),i=g.dom.create("span",{id:m}),g.selection.setNode(i),c=i=g.dom.select("#"+m)[0],b.fail(function(){e(i).remove()}));e.extend(d,{timeout:n.DEFAULT_INSERT_MACRO_TIMEOUT});f.debug("Insert macro timeout = "+d.timeout);l.UI.setButtonsState(!1);e.ajax(d).done(function(j){j[0]!=="<"&&(j=document.createTextNode(j));if(!c||!c.parentNode){f.logError("The node to be replaced has been already deleted from the document");b.rejectWith(this,arguments)}else h.confluence.NodeUtils.updateNode(c,
j).done(function(a){b.resolve(a,j)}).fail(b.reject)}).fail(function(a,c,e){f.logError("Macro placeholder request failed "+c+": '"+e+"'");b.rejectWith(this,arguments)});b.done(function(a,c){l.UI.setButtonsState(true);h.confluence.macrobrowser.isMacroWithBody(a)&&/P|H\d/.test(a.parentNode.nodeName)&&g.dom.split(a.parentNode,a);var b=h.confluence.macrobrowser,d=h.activeEditor,i=d.getDoc(),k=d.selection.getRng(true);if(b.isMacroWithBody(a)){!h.isIE&&e("p, pre",a).each(function(){this.childNodes.length===
0&&this.appendChild(i.createElement("br"))});if(b=d.dom.select(".wysiwyg-macro-body",a)[0].firstChild){k.setStart(b,0);k.setEnd(b,0)}else f.debug("focusMacroNode: couldn't find anything to focus, cap'n!")}else{k.setStartAfter(a);k.setEndAfter(a)}d.selection.setRng(k);g.nodeChanged();f.Rte.showElement(a);g.selection.onSetContent.dispatch(g.selection,{content:c,format:"html"});h.activeEditor.undoManager.add();f.trigger("macro-browser.macro-inserted")}).fail(function(){l.UI.setButtonsState(true)});return b.promise()};
return n={DEFAULT_INSERT_MACRO_TIMEOUT:5E3,insertMacro:o,isInMacro:function(a){return 0<(a.jquery?a:e(a)).closest(".wysiwyg-macro").length},updateMacro:function(a,c,d,b){a={contentId:p(),macro:{name:d,params:a,body:c?c:""}};return o(a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/utils/tinymce-macro-utils","tinymce.confluence.MacroUtils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluence/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluence/editor_plugin_src",["jquery","ajs","tinymce","confluence-link-browser/link-object"],function(j,d,f,m){return{init:function(g){g.addCommand("mceConfUnlink",function(g,f){var h=d.Rte.getEditor(),i=h.selection,e=f||i.getNode(),a=j(e);if("A"!==e.nodeName){a=a.closest("a");if(!a.length)return;e=a[0]}var b=a.attr("href");b||(b="#",a.attr("href",b));var c;if(c=!a.attr("data-linked-resource-id"))if(c=m.isExternalLink(b)){c=a.text();var k=b,l=/(.*)[\/]$/.exec(k);
c=c==(null!=l?l[1]:k)}c?(i=h.dom.create("span",{"class":"nolink"},b),h.dom.replace(i,e,!1)):(i.select(e),a.removeClass("createlink unresolved"),h.execCommand("UnLink"))});g.addButton("confimage",{title:"confluence.confimage_desc",cmd:"mceConfimage"});g.addButton("conf_macro_browser",{title:"confluence.conf_macro_browser_desc",cmd:"mceConfMacroBrowser"})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:f.majorVersion+"."+
f.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluence/editor_plugin_src",function(j){var d=require("tinymce");d.create("tinymce.plugins.ConfluencePlugin",j);d.PluginManager.add("confluence",d.plugins.ConfluencePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/macroplaceholder/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/macroplaceholder/editor_plugin_src",["jquery","ajs","tinymce","confluence/property-panel"],function(f,i,d,p){var k=d.VK;return{init:function(j){function h(a){j.onKeyDown.add(a);d.isGecko&&(j.onKeyPress.add(a),j.onKeyUp.add(a))}function l(a,b){return a&&1===a.childNodes.length&&f(a).is(b)&&f(a.firstChild).is("br")}function m(a){if(!a.collapsed)return!1;a=3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer;if(!a||!a.parentNode)return!1;
for(;a&&!f(a).is(".wysiwyg-macro-body");){if(a.previousSibling||a.nextSibling)return!1;a=a.parentNode}return!0}var g=this;j.onInit.add(function(a){a.selection.onSetContent.add(function(a){d.each(a.dom.select("p > .wysiwyg-macro"),function(c){var e=a.dom.getParent(c.parentNode,"p");try{a.dom.split(e,c)}catch(d){}})})});j.onSetContent.add(function(a){d.each(a.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),function(b){a.dom.select("pre",b).length||(d.isIE?a.dom.setHTML(b,
"<pre></pre>"):a.dom.setHTML(b,"<pre><br /></pre>"))})});j.onKeyDown.add(function(a,b){var c=a.selection,e;if(!(e=-1!=f.inArray(b.keyCode,[k.BACKSPACE,k.DELETE,k.ENTER,k.ESCAPE])))e=!1,0===b.charCode&&(e=-1!=f.inArray(b.keyCode,[k.SHIFT,k.CTRL,k.ALT,k.META])),e=e||c.isCollapsed();if(!e&&!b.ctrlKey&&!(b.metaKey||!d.isMac&&b.altKey))e=c.getNode(),d.confluence.macrobrowser.isMacroWithBody(e)&&(e=f(".wysiwyg-macro-body",e),0<e.length&&(i.debug("MacroPlaceholderPlugin: Adjusting text selection to only include macro's body."),
c.select(e[0],!0)))});j.onDblClick.add(function(a,b){var c=f(b.target),e=c.closest("[data-macro-name]");if(e.length){i.debug("Double-click triggered inside a macro.");if(e.attr("data-macro-body-type"))if(d.isIE)if(c.hasClass("wysiwyg-macro-body")||c.hasClass("wysiwyg-macro"))i.debug("Double-click inside macro body, but its IE so its OK I guess...");else{i.debug("Double-click was inside bodied macro content, even in IE. Skipping.");return}else if(c.closest(".wysiwyg-macro-body").length){i.debug("Double-click was inside bodied macro content. Skipping.");
return}d.confluence.macrobrowser.editMacro(e);p&&p.current&&p.destroy()}});j.onNodeChange.addToTop(function(a){var b=a.selection.getNode();"PRE"===b.nodeName&&f(b).closest(".wysiwyg-macro").length?g._setTinymceControlsState(a,0):g._setTinymceControlsState(a,1)});j.addCommand("mceConfRemoveMacro",function(a){f(a).remove();d.isGecko&&i.Rte.getEditor().execCommand("mceRepaint",!1)});g._isCursorInMostNestedElement=m;var q=function(a){if(!a.collapsed)return!1;a=3===a.startContainer.nodeType?a.startContainer.parentNode:
a.startContainer;return a.previousSibling&&!a.nextSibling&&l(a,"p, pre")};(d.isWebKit||d.isGecko)&&h(function(a,b){if(46===b.keyCode&&q(a.selection.getRng(!0)))return d.dom.Event.cancel(b)});g._isCursorInLastParagraphOrPre=q;d.isWebKit&&h(function(a,b){if(8!==b.keyCode&&46!==b.keyCode)return!0;var c=a.selection.getRng(!0),e=3===c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer;if(c.collapsed)var g=3===c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer,c=m(c)&&
1===g.childNodes.length&&f(g.firstChild).is("br");else c=!1;return c&&(8===b.keyCode?!f(e).is("li"):1)?d.dom.Event.cancel(b):!0});var r=function(a){if(!a.collapsed)return!1;var b=3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer;return 0===a.startOffset&&f(b).is(".wysiwyg-macro-body > ul > li")&&1===b.childNodes.length&&f(b.firstChild).is("br")};d.isWebKit&&h(function(a,b){return 8!==b.keyCode?!0:r(a.selection.getRng(!0))?(a.execCommand("Outdent"),d.dom.Event.cancel(b)):!0});
g._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=r;var s=function(a){var b=3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=f(b);return 0===a.startOffset&&l(b,"p, pre")&&c.parent().is("td.wysiwyg-macro-body")&&!b.previousSibling&&b.nextSibling&&l(b.nextSibling,"p, pre")};d.isWebKit&&h(function(a,b){if(46!==b.keyCode)return!0;var c=a.selection.getRng(!0),e=3===c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer,g=f(e);if(s(c))return c=e.nextSibling,
g.remove(),a.selection.select(c,!0),d.dom.Event.cancel(b)});g._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=s;var t=function(a){var b=3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=f(b);return 0===a.startOffset&&l(b,"p, pre")&&c.parent().is("td.wysiwyg-macro-body")&&!b.nextSibling&&b.previousSibling&&!b.previousSibling.previousSibling&&l(b.previousSibling,"p, pre")};d.isWebKit&&h(function(a,b){if(8!==b.keyCode)return!0;var c=a.selection.getRng(!0),e=3===c.startContainer.nodeType?
c.startContainer.parentNode:c.startContainer,g=f(e);if(t(c))return c=e.previousSibling,g.remove(),a.selection.select(c,!0),d.dom.Event.cancel(b)});g._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=t;var u=function(a){if(!a.collapsed)return!1;var b=3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=f(b);if(!b||0<a.startOffset)return!1;d.confluence.NodeUtils.normalize(b);return b&&0===a.startOffset&&l(b,"p, pre")&&c.parent().is("td.wysiwyg-macro-body")&&!b.previousSibling&&
!b.nextSibling};(d.isWebKit||d.isGecko)&&h(function(a,b){if(8!==b.keyCode&&46!==b.keyCode)return!0;if(u(a.selection.getRng(!0)))return d.dom.Event.cancel(b)});g._isCursorInSoloParagraphOrPreInsidePlaceholder=u;var v=function(a){return a&&a.parentNode&&"BR"===a.nodeName&&a===a.parentNode.lastChild},w=function(a){if(!a.collapsed)return!1;var b=a.startContainer;return b&&0===a.startOffset&&3===b.nodeType&&m(a)&&1===b.nodeValue.length&&!b.previousSibling&&(!b.nextSibling||v(b.nextSibling))},x=function(a){if(!a.collapsed)return!1;
var b=a.startContainer;return b&&1===a.startOffset&&3===b.nodeType&&m(a)&&1===b.nodeValue.length&&!b.previousSibling&&(!b.nextSibling||v(b.nextSibling))},y=function(a){if(!a.collapsed)return!1;var b=a.startContainer;return b&&0===a.startOffset&&1===b.nodeType&&1===b.childNodes.length&&m(a)&&!b.previousSibling&&!b.nextSibling},z=function(a){if(!a.collapsed)return!1;var b=a.startContainer;return b&&1===a.startOffset&&1===b.nodeType&&1===b.childNodes.length&&m(a)&&!b.previousSibling&&!b.nextSibling};
(d.isWebKit||d.isGecko)&&h(function(a,b){if(8!==b.keyCode&&46!==b.keyCode)return!0;var c=a.selection.getRng(!0),e=3===c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer;if(!f(e).closest(".wysiwyg-macro-body").size())return!0;d.confluence.NodeUtils.normalize(e);return 46===b.keyCode&&(w(c)||y(c))||8===b.keyCode&&(x(c)||z(c))?(e.lastChild&&!f(e.lastChild).is("br")&&f(e).append("<br/>"),f(e.firstChild).remove(),a.selection.select(e,1),d.dom.Event.cancel(b)):!0});g._isCursorBehindOnlyCharacterInNestedElement=
w;g._isCursorAfterOnlyCharacterInNestedElement=x;g._isCursorBehindOnlyChildInNestedElement=y;g._isCursorAfterOnlyChildInNestedElement=z;var B=function(a){if(a.collapsed)return!1;var b=function(a){return!a.previousSibling},c=function(a){return!a.nextSibling};return 0===a.startOffset&&A(a.startContainer,b)&&(!a.endContainer?!1:3===a.endContainer.nodeType?a.endOffset===a.endContainer.nodeValue.length:1===a.endContainer.nodeType?1===a.endContainer.childNodes.length&&f(a.endContainer.firstChild).is("br")?
0===a.endOffset:a.endOffset===a.endContainer.childNodes.length:!1)&&A(a.endContainer,c)},A=function(a,b){if(!a)return!1;if(f(a).is(".wysiwyg-macro-body"))return!0;do{if(!b(a))return!1;a=a.parentNode}while(a&&!f(a).is(".wysiwyg-macro-body"));return!0};d.isWebKit&&h(function(a,b){if(8!==b.keyCode&&46!==b.keyCode)return!0;var c=a.selection.getRng(!0);if(B(c)&&(c=f(c.startContainer).closest(".wysiwyg-macro-body"),0<c.length)){var e=f(c[0].firstChild).is("pre");a.undoManager.add();c.empty();c=e?f("<pre><br/></pre>").appendTo(c):
f("<p><br/></p>").appendTo(c);a.selection.select(c[0],!0);return d.dom.Event.cancel(b)}return!0});g._isMacroBodySelected=B;var C=function(a){if(!a.collapsed)return!1;var b=3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=f(b);return 0===a.startOffset&&l(b,"p")&&c.next().is("table")};d.isWebKit&&h(function(a,b){if(46===b.keyCode&&C(a.selection.getRng(!0)))return d.dom.Event.cancel(b)});g._isCursorInEmptyParagraphPrecedingPlaceholder=C;var D=function(a){return!a||f(a.parentNode).is(".wysiwyg-macro td")?
null:f(a.parentNode).is("p")?a.parentNode:D(a.parentNode)},n=function(a){return!a?null:3===a.nodeType?a:n(a.firstChild)||n(a.nextSibling)},o=function(a){return!a||"PRE"===a.nodeName||"TD"===a.nodeName?null:"BR"===a.nodeName?a:o(a.previousSibling)||o(a.parentNode)},E=function(a){var b,c;0<f(a.commonAncestorContainer).closest(".wysiwyg-macro td").length&&(o(a.startContainer)||(b=n(D(a.startContainer))));if(0<(c=f(a.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length)o(a.startContainer)||
(b=n(c[0]));b&&(a=a.cloneRange(),a.setStart(b,0));return a};d.isWebKit&&d.isMac&&h(function(a,b){var c=a.selection.getRng();if((b.metaKey||b.ctrlKey)&&b.shiftKey&&b.keyCode===k.LEFT){var e=E(c);if(e!==c)return a.selection.setRng(e),d.dom.Event.cancel(b)}});g._selectTillStart=E;j.onKeyDown.add(function(a,b){if(b.keyCode===d.VK.TAB){var c=a.selection.getRng(1);if(f(3===c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer).is(".wysiwyg-macro-body > pre")){a.undoManager.beforeChange();
a.undoManager.add();var e=a.getDoc().createTextNode("\t");c.insertNode(e);a.selection.setCursorLocation(e,1);a.undoManager.add();return d.dom.Event.prevent(b)}}})},_setTinymceControlsState:function(f,h){d.each(f.controlManager.controls,function(d){d.setDisabled(!h)})},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/macroplaceholder/editor_plugin_src",function(f){var i=require("tinymce");i.create("tinymce.plugins.MacroPlaceHolderPlugin",f);i.PluginManager.add("macroplaceholder",i.plugins.MacroPlaceHolderPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/insertwiki/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/insertwiki/editor_plugin_src","jquery ajs confluence/templates confluence/localstorage-cache tinymce underscore confluence/api/constants".split(" "),function(e,b,h,n,i,u,q){var o=!b.DarkFeatures.isEnabled("editor.insert-wiki-markdown"),d={DEFAULT:null,HELP_REST_API:b.contextPath()+"/plugins/tinymce/helplink.action",WIKI:{CONFLUENCE:{val:"CONFLUENCE",label:"Confluence wiki",helpLink:"help.insert.wiki.markup",
restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{val:"MARKDOWN",label:"Markdown",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},r=new n("insert-wiki-markup-dialog");return{init:function(f,n){f.addCommand("InsertWikiMarkup",function(){var j={id:"insert-wiki-markup-dialog",content:o?h.InsertWiki.wikiMarkupDialog():h.InsertWiki.originalDefaultTempWikiMarkupDialog(),width:980,height:500,popup:false,
name:"confluence.conf_wikimarkup_desc"},v=b.Meta.get("content-id"),w=b.Meta.get("space-key");d.DEFAULT=d.WIKI[r.get("parser")||"CONFLUENCE"];var c={getElement:function(a){c[a]=c[a]||e(a);return c[a]}},k=null,l=function(){var a=c.getElement("#wiki-parser-selection-tool");return a.length?a.val():d.DEFAULT.val},s=function(a){a=a||{};a.setBusy&&f.windowManager.setBusy(j.id,true);e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:a.API,data:e.toJSON({wiki:a.textToConvert,entityId:v,
spaceKey:w}),dataType:"text",success:a.successCallback,error:a.errorCallback||function(a){b.logError(a)},timeout:7500})},x=function(a){var c=j.id,d=l();f.windowManager.setBusy(c,false);i.EditorManager.activeEditor.windowManager.close(c);if(o){b.trigger("analytics",{name:"insert-wiki-markup-dialog."+d});if(d==="MARKDOWN"){a=e(a);a.find("img").addClass("confluence-embedded-image");a=e("<div>").append(a.clone()).html()}}f.execCommand("mceInsertContent",false,a);i.each(f.dom.select("p > p"),function(a){try{f.dom.split(a.parentNode,
a)}catch(c){b.logError("insertwikimarkup - splitParas()",c)}})},y=function(a,c,d){f.windowManager.setBusy(j.id,false);a={warningMessage:i.EditorManager.activeEditor.getLang("confluence.conf_wikimarkup_errors"),exceptionMessage:c==="timeout"?i.EditorManager.activeEditor.getLang("confluence.conf_wikimarkup_timeout"):b.escapeHtml(c)+" : "+b.escapeHtml(d)};a=h.InsertWiki.wikiErrorSubDialog(a);i.EditorManager.activeEditor.windowManager.alert(a)},t=function(){var a=c.getElement("#insert-wiki-textarea"),
b=a.val();e.trim(b)?s({API:q.CONTEXT_PATH+d.WIKI[l()].restApi,textToConvert:b,successCallback:function(a){k.html(a)},errorCallback:function(){k.html(a.val())}}):k.html(b)},z=function(){var a=l();r.put("parser",a);c.getElement("#"+j.id).find(".dialog-help-link").load(d.HELP_REST_API,{linkUrlKey:d.WIKI[a].helpLink});t()};f.windowManager.open(j,{buttons:[{label:"confluence.conf_insert_button_title",action:function(){s({API:q.CONTEXT_PATH+d.WIKI[l()].restApi,successCallback:x,errorCallback:y,textToConvert:c.getElement("#insert-wiki-textarea").val(),
setBusy:true})}}],plugin_url:n,helpLink:d.DEFAULT.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"});if(o){var p=e("#wysiwygTextarea_ifr").contents().find("head").html(),A=h.InsertWiki.previewWikiIframeContent(),g=e("<iframe tabindex='-1' id='insert-wiki-markup-preview' />"),m;c.getElement("#insert-wiki-textarea-preview").append(g);g=g.contents();m=g[0];m.open();m.write(A);m.close();g.find("head").html(p);k=g.find("body");p=e(h.InsertWiki.wikiParserSelector(d));
c.getElement("#insert-wiki-insert-title").append(p);c.getElement("#wiki-parser-selection-tool").on("change",z);c.getElement("#insert-wiki-textarea").on("keydown",u.debounce(t,300))}});f.addButton("insertwikimarkup",{title:"confluence.conf_wikimarkup_desc",cmd:"InsertWikiMarkup"})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/insertwiki/editor_plugin_src",function(e){var b=require("tinymce");b.create("tinymce.plugins.InsertWikiMarkupPlugin",e);b.PluginManager.add("insertwikimarkup",b.plugins.InsertWikiMarkupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/editor_plugin_src",["jquery","ajs","document","tinymce","confluence/property-panel"],function(e,c,l,k,g){var i=[];c.bind("add-handler.property-panel",function(c,e){e&&i.push(e)});return{init:function(d){c.debug("init property panel plugin");var f,h=function(b,a,d){var f={focusedEl:d,focusedNodeName:d.nodeName&&d.nodeName.toLowerCase(),ed:b,e:e.extend({},a)};b=e(d);b.is("img")?b=b[0]:(b=b.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder"),
b=b.length?b[0]:"");var d=!!e(d).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,h=!!e(".toolbar-contextual").length;f.containerEl=b;c.trigger("user-blurred-rte-element",f);var j;if(j=b)a="click"!=a.type?!1:a.which?3===a.which:a.button?2==a.button:void 0,j=!a&&!g.current&&c.Confluence.PropertyPanel.shouldCreate;if(j){a=0;for(j=i.length;a<j;a++)if(i[a].canHandleElement(e(b))){if(h||!d)return i[a].handle(f);(function(a){e(l).bind("shown.contextToolbar",function(){a.handle(f)})})(i[a])}}};
k.isIE&&d.onMouseDown.add(function(b,a){f&&f.unbind("mouseup.IEDragHandlesWorkaround");f=e(a.target);f.filter("img, table").bind("mouseup.IEDragHandlesWorkaround",function(){h(b,a,a.target)})});c.bind("trigger.property-panel",function(b,a){h(d,b,a.elem)});d.onClick.add(function(b,a){h(b,a,a.target)});d.onKeyUp.addToTop(function(b,a){27!==a.keyCode&&h(b,a,b.selection.getNode())});d.onContextMenu.add(function(){g.destroy()});c.bind("user-blurred-rte-element",function(b,a){g.current&&(!a.containerEl||
g.current.hasAnchorChanged(a.containerEl)?g.destroy():c.trigger("same-anchor.property-panel"))});c.bind("created.property-panel",function(){setTimeout(function(){c.Rte.bindScroll("property-panel",function(){g.destroy()})},0);e(d.getDoc()).bind("keydown.property-panel.escape",function(b){27===b.keyCode&&g.current&&g.destroy()})});c.bind("destroyed.property-panel",function(){c.Rte.unbindScroll("property-panel");e(d.getDoc()).unbind("keydown.property-panel.escape")})},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:k.majorVersion+"."+k.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/propertypanel/editor_plugin_src",function(e){var c=require("tinymce");c.create("tinymce.plugins.PropertyPanel",e);c.PluginManager.add("propertypanel",c.plugins.PropertyPanel)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confmonospace/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confmonospace/editor_plugin_src",["tinymce"],function(b){return{init:function(a){a.addCommand("confMonospace",function(){a.formatter.toggle("monospace",void 0)});b.activeEditor.onInit.add(function(a){a.formatter.register({monospace:{inline:"code"}});a.editorCommands.addCommands({confMonospace:function(){return a.formatter.match("monospace")}},"state")});a.addButton("monospace",{title:"monospace",cmd:"confMonospace"})},getInfo:function(){return{longname:"Monospace Formatting",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:b.majorVersion+"."+b.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confmonospace/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.ConfMonospacePlugin",b);a.PluginManager.add("confmonospace",a.plugins.ConfMonospacePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/js/property-panel-links.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","ajs jquery confluence/legacy-editor-global-AVOID-IF-POSSIBLE tinymce window confluence/property-panel".split(" "),function(d,e,j,k,l,g){var i=0;return{name:"link",canHandleElement:function(c){return c.is("a")&&c.attr("href")!="#"&&!c.hasClass("unresolved")},handle:function(c){var b=c.containerEl,h=c.ed,a=function(b){return d.Rte.getEditor().getLang(b)},c={anchorIframe:d.Rte.getEditorFrame()},f=e(b).attr("href").indexOf("#")===
0,a=[{className:"link-property-panel-goto-button",text:a("propertypanel.links_goto"),tooltip:f?a("propertypanel.links_goto_disabled_tooltip"):b.href,href:b.href,disabled:f,click:function(){g.destroy();var a=l.open(b.href,k.isIE?"_blank":"confluence-goto-link-"+d.params.pageId+"-"+i);a&&a.focus()}},{className:"link-property-panel-edit-button",text:a("propertypanel.links_edit"),tooltip:a("propertypanel.links_edit_tooltip"),disabled:e(b).hasClass("createlink")||!b.href,click:function(){g.destroy();h.selection.select(b);
j.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",text:a("propertypanel.links_unlink"),tooltip:a("propertypanel.links_unlink_tooltip"),click:function(){g.destroy();h.execCommand("mceConfUnlink",false,b);h.focus()}}],f=[];d.trigger("link-property-panel-buttons.created",{buttons:f,link:b});a=a.concat(f);g.createFromButtonModel(this.name,b,a,c);i++}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","AJS.Confluence.PropertyPanel.Link",function(d){var e=require("ajs");e.bind("init.rte",function(){e.trigger("add-handler.property-panel",d)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/js/property-panel-images.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","jquery ajs tinymce confluence-editor/utils/tinymce-image-utils confluence/meta confluence/api/browser confluence/property-panel confluence/legacy-editor-global-AVOID-IF-POSSIBLE".split(" "),function(f,g,s,F,v,G,h,w){function x(){var a=[];f.each(t,function(b,c){a.push(c)});h.current.panel.find(a.join(", ")).removeClass("selected")}function p(a,b,c){var e=y(a,b),c=y(a,c),j=e||c;if(j){var d=h.getAnchor(),i=d.width(),
d=d.height(),f=v.get("max-thumb-width"),g=v.get("max-thumb-height");a.thumbnail=k.isRemoteImg(a.destination)?false:k.isThumbnailUsable(e,c,i,d,f,g);a.originalSelected=false;if(b){delete a.height;a.width=j}else{delete a.width;a.height=j}m(a);x();return true}return false}function z(a,b){if(u?p(a,n[b]):p(a,null,n[b])){A(b);m(a);return true}return false}function B(a){delete a.width;delete a.height;a.thumbnail=false;a.originalSelected=true;x();A("original");var b=h,c=b.getAnchor();b.current.updating=true;
c.one("load",function(){l(b);q(a);a.width=Math.floor(c.width());a.height=Math.floor(c.height())});k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);c.each(function(){this.complete&&f(this).trigger("load")});return true}function A(a){h.current.panel.find(t[a]).addClass("selected")}function C(a){f(".image-border-toggle").toggleClass("selected",!a.border);a.border=+!a.border||false;m(a)}function m(a){var b=h,c=b.getAnchor(),e=c.attr("src"),f=c.height();b.current.updating=
true;k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);if(a.src!=e){var d=setInterval(function(){var a=c.height();if(a!=f){g.debug("updateImageElement : height changed after image src change - "+f+" to "+a);clearTimeout(d);d=null;l(b)}},10);setTimeout(function(){if(d){clearTimeout(d);d=null;l(b)}},1E3)}else l(b);q(a)}function q(a){a=a.width?a.width:h.getAnchor().width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function y(a,b){b=parseInt(b);if(isNaN(b))return null;
b<D?b=D:b>E&&(b=E);return b}var k=F.ImageUtils,u=k.isScaledByWidth(),n;n=u?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};var t={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"},D=16,E=9E4,l=function(a){a.current.updating=false;a.current.snapToElement({animate:true,animateDuration:100})};return{_resizeImage:p,pluginButtons:[],name:"image",getPresetImageSize:function(a){return n[a]},canHandleElement:function(a){return a.is("img")&&
!a.hasClass("editor-inline-macro")&&!a.hasClass("template-variable")},handle:function(a){function b(){p(e,f("#image-size-input").val())?true:q(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})}var c;c=a.nodeName==="IMG"?a:a.containerEl;var a=f(c),e=s.confluence.ImageProperties(c);if(e&&!a.attr("data-resource-id")){var j=g.Rte.getEditor(),d=function(a){return j.getLang(a)},i=function(a){return{className:"image-size-"+a,text:d("propertypanel.images_"+a),tooltip:d("propertypanel.images_"+
a+"_tooltip"),click:function(){z(e,a);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:u?e.width==n[a]:e.height==n[a]}},i=[{className:"editable",tooltip:d("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,i("small"),i("medium"),i("large"),{className:"image-size-original",text:d("propertypanel.images_original"),tooltip:d("propertypanel.images_original_tooltip"),click:function(){B(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},
selected:e.originalSelected},null,{className:"image-border-toggle",text:d("propertypanel.images_border"),tooltip:d("propertypanel.images_border_tooltip"),click:function(){C(e)},selected:e.border||e.border==1}];i.push(null);var k=a.parent();if(k.is("a[href]")){i.push({className:"image-link-edit",text:d("propertypanel.images_link_edit"),tooltip:d("propertypanel.images_link_edit_tooltip"),click:function(){h.destroy();j.selection.select(k[0]);w.LinkBrowser.open()}});i.push({className:"image-link-remove",
text:d("propertypanel.images_link_remove"),tooltip:d("propertypanel.images_link_remove_tooltip"),click:function(){h.destroy();j.execCommand("mceConfUnlink",false,c);j.focus()}})}else i.push({className:"image-make-link",text:d("propertypanel.images_link_create"),tooltip:d("propertypanel.images_link_create_tooltip"),click:function(){h.destroy();j.selection.select(c);w.LinkBrowser.open()}});for(var l=h.Image.pluginButtons,r=0;r<l.length;r++)if(l[r]===null)i.push(null);else{var m=l[r].create(a);m&&i.push(m)}h.createFromButtonModel(this.name,
c,i,{anchorIframe:g.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){b()});(new G(window.navigator.userAgent)).isIE()&&a.bind("keyup",function(a){a.keyCode===13&&b()});h.current.imageProps=e;q(e);var o=e;return{setPresetSize:function(a){z(o,a)},setPixelSize:function(a){p(o,a)},setToOriginalSize:function(){B(o)},toggleBorder:function(){C(o)},getWidth:function(){return o.width},getHeight:function(){return o.height},getDisplayWidth:function(){return f("#image-size-input").val()},
isButtonSelected:function(a){return h.current.panel.find(t[a]).hasClass("selected")}}}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","AJS.Confluence.PropertyPanel.Image",function(f){var g=require("ajs");g.bind("init.rte",function(){g.trigger("add-handler.property-panel",f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/js/property-panel-macros.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","ajs tinymce jquery document confluence/macro-js-overrides confluence-editor/utils/tinymce-macro-utils underscore confluence/property-panel confluence-macro-browser/macro-parameter-serializer".split(" "),function(c,q,e,u,r,A,i,s,y){var t=[],v=[],l={},j="__PROPERTY_PANEL_SPACER",m={key:j},k,g,o=function(a,e,d){Array.isArray(a)||(a=[a]);a.forEach(function(b){i.contains(i.pluck(t,"id"),b)||t.push({id:b,handler:e,macroName:d})})},
z=function(a,n,d){a=i.map(a,function(b){return b.type==="button"?[{key:b.key,label:b.label.value},m]:b.type==="group"&&b.controls.length>0?i.map(b.controls,function(b){return{key:b.key,label:b.label.value}}).concat(m):b.type==="togglegroup"&&b.controls.length>0?i.map(b.controls,function(a){var h={key:a.key,label:a.label.value,group:b.macroParameter,selected:d[b.macroParameter]===a.macroParameterValue},i=a.macroParameterValue,j=b.macroParameter;o(h.key,function(a,b,d){var f={};f[j]=i;a=k;b=c.MacroBrowser.getMacroParams(a);
e.extend(b,f);f=e(a).find(".wysiwyg-macro-body").text();A.updateMacro(b,f,n,a).done(function(a){d.parent().children().filter(".macro-property-group-"+j).removeClass("selected");d.addClass("selected");k=a;g=e(k)})},n);return h}).concat(m):m});return i.flatten(a)};return{name:"macro",registeredEvents:t,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){function n(){var a="macro-placeholder-property-panel-remove-button";b.length>0&&
b[b.length-1].key==j&&(a=a+" first");h.push({className:a,text:"Remove",click:function(){s.destroy();c.Rte.getEditor().execCommand("mceConfRemoveMacro",k)}});if(g.attr("data-macro-parameters")){var p=y.deserialize(g.attr("data-macro-parameters"));if("atlassian-macro-output-type"in p){a=function(a){return function(b){p["atlassian-macro-output-type"]=a;g.attr("data-macro-parameters",y.serialize(p));a=="INLINE"?e(".macro-placeholder-property-panel-display-newline-button").removeClass("selected"):
e(".macro-placeholder-property-panel-display-inline-button").removeClass("selected");e(b).addClass("selected")}};h.push(null);h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"Display on new line",selected:p["atlassian-macro-output-type"]=="BLOCK",click:a("BLOCK")});h.push({className:"macro-placeholder-property-panel-display-inline-button",tooltip:"Display inline",selected:p["atlassian-macro-output-type"]==
"INLINE",click:a("INLINE")})}}e.each(t,function(){(!this.macroName||this.macroName==d)&&e(u).bind(w(this.id,this.macroName),this.handler)});a=v;d&&l[d]&&(a=a.concat(l[d]));e.each(a,function(){try{this(k,h,o)}catch(a){c.debug("Property panel init handler failed for : "+d+".  Is global handler : "+(e.inArray(this,v)>-1),a)}});if(h.length>0){var a=s.createFromButtonModel("macro",k,h,o),f=r.getFunction(d,"propertyPanelIFrameInjector");f&&f(a)}}if(!(a.e.type!=="click"&&a.e.type!=="mouseup")){k=a.containerEl;
g=e(k);var d,b=[],a=!g.hasClass("editor-inline-macro"),i=!g.hasClass("wysiwyg-unknown-macro"),h=[],o={originalHeight:a&&g.height(),anchorIframe:c.Rte.getEditorFrame()},w=function(a,b){return a+"-button-click"+(b?b+".macro":"")+".property-panel"};if(i){var x=e.Deferred();d=g.attr("data-macro-name");if(c.MacroBrowser.getMacroMetadata(d))b=c.MacroBrowser.getMacroMetadata(d).buttons;(a=r.getFunction(d,"waitForPropertyPanelEventBindings"))&&a();(a=r.getFunction(d,"getControls"))?a(function(a){var e=b,
a=z(a,d,c.MacroBrowser.getMacroParams(g[0]));b=e.concat(m).concat(a);x.resolve()}):x.resolve();x.done(function(){var a="macro-placeholder-property-panel-edit-button";b.length>0&&b[0].key===j&&(a=a+" last");h.push({className:a,text:"Edit",click:function(){s.destroy();q.confluence.macrobrowser.editMacro(g)}});e.each(b,function(a,f){if(f.key!=j){var c="macro-property-panel-"+f.key;f.group&&(c=c+(" macro-property-group-"+f.group));a>0&&b[a-1].key==j&&(c=c+" first");
a<b.length-1&&b[a+1].key==j&&(c=c+" last");h.push({className:c,text:f.label,parameterName:f.key,click:function(a){e(u).trigger(w(f.key),g);e(u).trigger(w(f.key,d),[g,e(a)]);var b=r.getFunction(d,"handlePropertyPanelEvent");if(b){a.attr("aria-disabled","true");setTimeout(function(){if(a.attr("aria-disabled")==="true"){a.find(".panel-button-text").css("visibility","hidden");a.spin()}},2E3);b("click",f.key,d).done(function(){a.attr("aria-disabled","false");a.find(".panel-button-text").css("visibility",
"visible");a.spinStop()})}else s.destroy()},selected:f.selected})}})}).then(n())}else n()}},registerButtonHandler:o,registerInitHandler:function(a,c){if(c){l[c]=l[c]||[];l[c].push(a)}else v.push(a)},yieldButtonFor:function(a,c){var d;e.each(a,function(){this.parameterName&&this.parameterName==c&&(d=this)});return d},_convertToMacroButtons:z}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","AJS.Confluence.PropertyPanel.Macro",function(c){var q=require("ajs");q.bind("init.rte",function(){q.trigger("add-handler.property-panel",c)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/conftable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/conftable/editor_plugin_src",["jquery","tinymce"],function(d,a){return{init:function(h){!a.isIE8&&h.onKeyDown.add(function(f,c){if(c.altKey&&!(38!==c.keyCode&&40!==c.keyCode)){var e=f.selection.getRng(!0),b=d(e.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==b.length){f.execCommand(38===c.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var b=b.parent()[38===c.keyCode?"prev":"next"]().find("td:first-child")[0],
g=d(b);g.hasClass("numberingColumn")&&(b=g.next()[0]);e.setStart(b,0);e.setEnd(b,0);f.selection.setRng(e);return a.dom.Event.prevent(c)}}})},getInfo:function(){return{longname:"Confluence Table Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/conftable/editor_plugin_src",function(d){var a=require("tinymce");a.create("tinymce.plugins.ConfluenceTablePlugin",d);a.PluginManager.add("conftable",a.plugins.ConfluenceTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/deletecommand/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/deletecommand/editor_plugin_src",["jquery","ajs","tinymce"],function(b,c,f){return{init:function(d){d.addCommand("mceDelete",function(g,h){(function(){if(f.isWebKit){var a=d.selection.getRng(1);if(a.collapsed)return!1;var e=b(a.startContainer).closest(".wysiwyg-macro-body",d.getBody())[0];if(e&&c.EditorUtils.isRangeAtStartOf(e,a)&&c.EditorUtils.isRangeAtEndOf(e,a))return a=b(e.firstChild).is("pre")?"pre":"p",a=b("<"+a+"><br data-mce-bogus='1'></"+a+">")[0],
b(e).html(a),d.selection.select(a,1),!0}return!1})()||d.getDoc().execCommand("Delete",g,h)})},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:f.majorVersion+"."+f.minorVersion}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/deletecommand/editor_plugin_src",function(b){var c=require("tinymce");c.create("tinymce.plugins.DeleteCommandPlugin",b);c.PluginManager.add("deletecommand",c.plugins.DeleteCommandPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/draggable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/draggable/editor_plugin_src",["jquery","ajs","confluence/property-panel"],function(h,g,y){function H(b){if(1===b.which&&b.target===b.currentTarget)if(d)q(b);else{d=h(b.target);e.selection.select(b.target);b.preventDefault();i.bind({"mousemove.moveable-zone":I,"mouseup.moveable-zone":q,"keydown.moveable-zone":J,"mouseover.moveable-zone":l});var a=d.offset();t=b.pageX;u=b.pageY;z=a.top-u;A=a.left-t;r=!0;b=d;m=b.attr("style")||"";d=b}}function J(b){27===b.keyCode&&
(k.cancelScrolling(),i.unbind(".moveable-zone"),e.undoManager.undo(),e.selection.select(d[0]),e.selection.collapse(!1),d=null)}function l(){i.find(".mceSelected").removeClass("mceSelected")}function I(b){var a;if(r){a=Math.abs(t-b.pageX);var f=Math.abs(u-b.pageY);if(a<B&&f<B)return;g.Rte.BookmarkManager.storeBookmark();e.undoManager.beforeChange();e.undoManager.typing=!0;e.undoManager.add();g.trigger("synchrony.stop",{id:C});(a=e.selection.getSel())&&a.removeAllRanges&&a.removeAllRanges();d.css({position:"absolute",
width:d.css("width"),"max-width":"50%"});y.current&&y.destroy();d.detach();g.Rte.Cursor.fixCursorTargets(g.Rte.getEditor().getBody());n.append(d);var D=d,o=function(){return i.find("#move-indicator")},q=function(b,a){var c=h(i[0].elementFromPoint(b,a)),j=!0;if(c.is(s)&&"move-indicator"!==c.attr("id")&&!(c.is("td.wysiwyg-macro-body")&&"PLAIN_TEXT"===c.closest("table").attr("data-macro-body-type")||c.is("img")&&!D.is("img"))){j=c;if(c.is("img")){var d;d=c.offset();d=b+i.scrollLeft()-d.left;c=c.width()}else d=
v(c,a),c=c.height();c=d<c/2;return{target:j,before:c}}if(l?c.is(E):c.is(F)){c=c.is("div.cell")?c.children("div.innerCell").first():c;if(0>v(c.children().first(),a))c=c.children().first();else{d=c.children().last();j=v(d,a);d=d.height();if(0<j-d)c=c.children().last();else{if(0<o().length&&0<o().parent(c).length)return null;j=c;c=D.parent(s);c.length||(c=j.find(s).last());c.length||(c=n.find(s).last())}j=!1}return{target:c,before:j}}return null},v=function(b,d){var c=b.offset();return d+i.scrollTop()-
c.top},l=!!n.children(".contentLayout,.contentLayout2").length;p={positionNear:function(b,d){var c;if(c=q(b,d)){var a=c.target;c=c.before;if("move-indicator"!==a.attr("id")){var f=o();if(!a.is(G)||!a.find(f).length){f.length?f.detach():f=h('<span id="move-indicator">|</span>');if(a.is(G)){var e=a.children().first();e.is(K)&&(a=e)}!a.is("img")&&g.Rte.Cursor.isTextContainerEmpty(a[0])?a.prepend(f):a.is(L)?c?a.prepend(f):a.append(f):c?a.before(f):a.after(f)}}}},replaceWith:function(a){var b=o();if(b.length){var c;
if(c=a.is(M))c=b.parent(),c=l?c.is(E):c.is(F);c&&(a=h("<p></p>").append(a));b.replaceWith(a);e.dom.isBlock(a[0])&&a.parent().is("p")&&a.unwrap();g.Rte.showElement(a);e.selection.select(a[0]);e.selection.collapse(!0)}else g.debug("No cursor - abort drop"),e.undoManager.undo();g.Rte.Cursor.fixCursorTargets(g.Rte.getEditor().getBody())},destroy:function(){var a=o();a.length&&(a.remove(),g.Rte.Cursor.fixCursorTargets(g.Rte.getEditor().getBody()))}};r=!1}b.preventDefault();d.hide();var f=b.clientY,m;a=
w.length;f=Math.max(f,0);f<a?k.scrollUp(w[f]):(m=x.height(),f=Math.max(0,m-f),f<a?k.scrollDown(w[f]):k.cancelScrolling());p.positionNear(b.clientX,b.clientY);a=Math.min(b.pageY+z,k.scrollHeight()-d.outerHeight());d.css({top:a,left:b.pageX+A,opacity:0.5});d.show()}function q(b){i.unbind(".moveable-zone");k.cancelScrolling();r?d=null:(b.preventDefault(),d.detach(),d.attr("style",m),p.replaceWith(d),p.destroy(),p=d=null,l(),e.undoManager.add(),g.trigger("synchrony.start",{id:C}))}if(!(h.browser.msie&&
8>=h.browser.version)){var M="img",B=10,e,x,i,n,z,A,t,u,d,m,r,k,p,w=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100],C="confluence.draggable-plugin",E="div.innerCell,div.cell",F="body",s="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img",G="li,td,th",K="p,h1,h2,h3,h4,h5,h6,blockquote",L="li,td,th";return{init:function(b){e=b;b.onInit.add(function(){x=h(b.getWin());i=h(b.getDoc());
n=h(b.getBody());h(x[0].parent);var a=h.browser.webkit?n:i.find("html"),d=0;k={scrollUp:function(b){d!==-b&&(d=-b,b=1E3*(a.scrollTop()/b),a.stop(!1,!1),a.animate({scrollTop:0},{duration:b}))},scrollDown:function(b){var e;d!==b&&(d=b,e=a[0].scrollHeight,b=1E3*((e-a.scrollTop())/b),a.stop(!1,!1),a.animate({scrollTop:e},{duration:b}))},cancelScrolling:function(){d=0;a.stop(!0,!1)},scrollHeight:function(){return a[0].scrollHeight}};i.delegate("img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",
{mousedown:H})})},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/draggable/editor_plugin_src",function(h){var g=require("tinymce");g.create("tinymce.plugins.draggable",h);g.PluginManager.add("draggable",g.plugins.draggable)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'editor/atlassian-editor.js' */
define("confluence-editor/editor/atlassian-editor",["tinymce","ajs","jquery","window","document"],function(f,b,d,g,h){function j(a){a=a&&a.jquery?a[0]:a;if(!a)return!1;if("BR"===a.tagName||3===a.nodeType)a=a.parentNode;a&&9===a.nodeType&&(a=null);return a}var k=parseInt(d.browser.version,10);return{Rte:{HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:function(){return f.activeEditor},getCurrentBaseUrl:function(){if(!this.currentBaseUrl){var a=
h.location;this.currentBaseUrl=a.protocol+"//"+a.hostname+(a.port?":"+a.port:"")}return this.currentBaseUrl},showSelection:function(a){b.Rte.showElement(f.activeEditor.selection.getStart(),a)},isAnyPartShown:function(a){a=j(a);if(!a)return b.debug("AJS.Rte.isAnyPartShown: no element to find"),!1;var c=d(a),a=c.offset().top,c=a+c.outerHeight(),e=d(b.Rte.getEditor().getDoc()).scrollTop(),f=e+d(b.Rte.getEditorFrame()).height();return c>e&&a<f},showElement:function(a,c){var e=j(a);if(!e)return b.log("AJS.Rte.showElement: no element to show - skipping"),
!1;var f=d(e),e=b.Rte.getEditor(),i=d(e.getDoc()),e=f.offset().top,f=e+f.outerHeight(),i=i.scrollTop(),g=i+d(b.Rte.getEditorFrame()).height(),h=function(){b.Rte.bindScroll("AJS.Rte.showElement",function(){b.Rte.unbindScroll("AJS.Rte.showElement");setTimeout(c,1)})};e<i?(b.Rte.scrollTo(e),c&&h()):f>g?(b.Rte.scrollTo(Math.min(e,i+f-g)),c&&h()):c&&c()},scrollTo:function(a){var c=b.Rte.getEditor(),a=Math.ceil(a);d(c.getDoc()).scrollTop(a)},bindScroll:function(a,c){var e=b.Rte.getEditor();d(h).add(e.getDoc()).add(e.getWin()).bind("scroll."+
a,c)},unbindScroll:function(a){var c=b.Rte.getEditor();d(h).add(c.getDoc()).add(c.getWin()).unbind("scroll."+a)},getMainEditor:function(){var a=f.EditorManager.editors[b.Rte.editorId];if(!a)throw Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return a},getEditorContainer:function(){return d("#wysiwyg")},getEditorFrame:function(){return d("#"+b.Rte.getEditor().id+"_ifr")[0]},getEditorTable:function(){return d("#"+b.Rte.getEditor().id+
"_tbl")},webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix:function(){this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+b.Meta.get("editor-plugin-resource-prefix"));return this.resourceUrlPrefix},getTinyMceBaseUrl:function(){this.absoluteUrl||(this.absoluteUrl=this.getResourceUrlPrefix()+this.webResourcePath+"tinymcesource/");return this.absoluteUrl},getMinEditorHeight:function(){return+b.Meta.get("min-editor-height")},
getTinyMceEditorMinHeight:function(a){var a=a||0,c=b.Rte.getMinEditorHeight(),e=0;if(c)return c;d("#editor-precursor,#header-precursor,#header").each(function(){e+=d(this).outerHeight(!0)});return d(g).height()-e-a},fixEditorFocus:function(){b.log("WARNING: The fixEditorFocus method has been deprecated and it will be removed in an upcoming Confluence release.");if(f.isGecko&&!isNaN(k)&&30>k){var a=b.Rte.getEditor().getBody();b.log("Fixing FF cursor positioning");"true"==a.contentEditable&&(a.contentEditable=
!1,a.contentEditable=!0)}},editorFocus:function(a){if(a&&!a.destroyed){var c;c=a.dom.getRoot();f.isWebKit&&!d(c).parents("body").length&&(c=d(a.getBody()).find("p:first-child")[0]);c?(a.selection.select(c,1),a.selection.collapse(1),c.focus()):b.log("editorFocus was called with an invalid node");a.getBody().focus();a.getWin().focus()}}},KEYS:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91}}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/atlassian-editor",function(f){var b=require("ajs"),d=require("jquery"),g=require("tinymce");b.Rte=d.extend(f.Rte,b.Rte);g.VK=d.extend(f.KEYS,g.VK)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'editor/atlassian-editor-content.js' */
define("confluence-editor/editor/atlassian-editor-content",["jquery","ajs"],function(c,b){return{offset:function(a){var a=c(a).offset(),e=c(b.Rte.getEditorFrame()),g=e.offset(),d=e[0].contentWindow.document,f=c(b.Rte.getEditor().getBody()),e=c.support.boxModel&&d.documentElement.scrollTop||f.scrollTop(),d=c.support.boxModel&&d.documentElement.scrollLeft||f.scrollLeft();return{top:a.top-e+g.top,left:a.left-d+g.left}},getSelectedText:function(){var a=b.Rte.getEditor().selection;return a.getRng().text||
a.getSel()&&a.getSel().toString&&a.getSel().toString()||""},setHtml:function(a){a&&b.Rte.getEditor().setContent(a)},getHtml:function(){return""+b.Rte.getEditor().getContent()},isEmpty:function(){var a=b.Rte.getEditor().getContent().replace("&nbsp;","").replace("<br />","");return"<p></p>"===c.trim(a)},editorHasContentChanged:function(){return b.Rte.getEditor().isDirty()},editorResetContentChanged:function(){b.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,b){for(var c=a.childNodes,d=0,f=c.length;d<
f;d++)if(c[d]==b)return d;return-1}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/editor/atlassian-editor-content","AJS.Rte.Content");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
define("confluence-editor/atlassian-editor-bookmark-manager",["tinymce"],function(c){var b;return{storeBookmark:function(){var a=c.activeEditor,d=c.DOM.getViewPort(c.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"===typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:d.x,scrollY:d.y,range:a}},restoreBookmark:function(){var a=c.activeEditor.selection,d=c.activeEditor.getWin();b&&(d.scrollTo(b.scrollX,b.scrollY),d.focus(),a.setRng(b.range));
b=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/atlassian-editor-bookmark-manager","AJS.Rte.BookmarkManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'support/atlassian-editor-support.js' */
define("confluence-editor/support/atlassian-editor-support",["ajs","confluence/meta"],function(c,b){return{inlineTasks:function(){var a=b.get("use-inline-tasks");return"true"===a||!0===a},isCollaborativeContentType:function(){var a=b.get("content-type");return b.get("collaborative-content")&&("page"===a||"blogpost"===a)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/support/atlassian-editor-support","AJS.Rte.Support");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'event/tinymce-event-delegator.js' */
define("confluence-editor/event/tinymce-event-delegator",[],function(){return function(h){var c={},f={},i=function(d,b){var a,e;for(e in c)if(c.hasOwnProperty(e)&&c[e].isEnabled)for(var g=0,f=c[e].events.length;g<f;g++)a=c[e].events[g],-1<a.type.toLowerCase().indexOf(b.type)&&(a.shouldTrigger(d,b)?a.callback.apply(this,[b.target]):a.missed&&a.missed())};return{addEventsForComponent:function(d,b){d in c||(c[d]={},c[d].events=[],c[d].isEnabled=!0);for(var a=0,e=b.length;a<e;a++)b[a].type in f||(f[b[a].type]=
!0,h[b[a].type].add(i)),"function"!==typeof b[a].shouldTrigger&&function(c){b[a].shouldTrigger=function(a,b){return b.target.tagName.toLowerCase()==c}}(b[a].shouldTrigger),c[d].events.push(b[a])},disableEventsForComponent:function(d){for(var b=0,a=c.length;b<a;b++)if(d in c)return c[d].isEnabled=!1,!0;return!1},enableEventsForComponent:function(d){for(var b=0,a=c.length;b<a;b++)if(d in c)return c[d].isEnabled=!0;return!1}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/event/tinymce-event-delegator","AJS.Rte.EventDelegator");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'oninit/tinymce-cursor-fixes.js' */
define("confluence-editor/oninit/tinymce-cursor-fixes",["jquery","tinymce","ajs"],function(e,d,h){function l(a){if(0===e(a).closest("td").length)return!0;for(a=a.parentNode;"td"!==a.nodeName.toLowerCase();){if(e(a).prevAll().contents().filter(function(){return 3===this.nodeType}).length)return!1;a=a.parentNode}return!0}function m(a,b,g){if(b.compareEndPoints)return a=a.getBody().createTextRange(),a.moveToElementText(g),a.collapse(1),0===b.compareEndPoints("StartToStart",a)&&l(g);if(!a.selection.getSel().isCollapsed)return!1;
g=b.startContainer;if(3===g.nodeType)return!g.previousSibling&&0===b.startOffset&&l(g);if(e(g).is("p:first-child"))return 0===b.startOffset;if(e(g).is(".wysiwyg-macro-body"))return 1==b.startOffset&&3===b.startContainer.childNodes[0].nodeType&&"\n"==b.startContainer.childNodes[0].nodeValue}function k(a,b,g){if(b.compareEndPoints)return a=a.getBody().createTextRange(),a.moveToElementText(g),a.collapse(0),0===b.compareEndPoints("EndToEnd",a);if(!a.selection.getSel().isCollapsed)return!1;g=b.endContainer;
return 3===g.nodeType?g.wholeText.length==b.endOffset:e(g.childNodes[b.endOffset]).is(":last-child")}function i(a,b,g){var c=a.dom.create("p",0,d.isIE?"&nbsp;":'<br data-mce-bogus="1" />');g?b.after(c):b.before(c);a.selection.select(c,!0);a.selection.collapse()}return{insertParagraph:i,isCursorAtStart:m,isCursorAtEnd:k,bindCursorFixes:function(){var a=h.Rte.getEditor();d.isIE&&a.onKeyPress.add(function(b,a){var c=b.selection,f=c.getNode();if(13===a.keyCode&&"P"===f.nodeName&&b.dom.is(f,":first-child")&&
d.confluence.MacroUtils.isInMacro(f)){var e=b.dom.create("p","&#x200b");b.dom.insertAfter(e,f);c.select(e,1);c.collapse();return d.dom.Event.cancel(a)}});d.isGecko&&a.onKeyPress.add(function(b,a){var c,f,d;a.charCode==e.ui.keyCode.SPACE&&(c=b.selection.getNode(),f=e(c).closest("a"),d=b.selection.getRng(),f.length&&k(b,b.selection.getRng(),c)&&(d.setStartAfter(f[0]),d.setEndAfter(f[0]),b.selection.setRng(d),b.selection.collapse()))});a.onKeyPress.addToTop(function(b,a){if(13===a.keyCode&&!a.shiftKey){var c=
b.selection.getNode(),f=e(c).closest("pre");if(f.length&&!d.confluence.MacroUtils.isInMacro(f)&&k(b,b.selection.getRng(),c))return i(b,f,!0),d.dom.Event.cancel(a);f=e(c).closest("blockquote");if(f.length){var j=e(c).closest("p");if(j.is(":first-child")&&m(b,b.selection.getRng(),c))return i(b,f,!1),d.dom.Event.cancel(a);if(c=j.is(":last-child"))c=j.contents(),c=!c.length||1===c.length&&(c.is("br")||"&nbsp;"==c.html()||160===c.text().charCodeAt(0)||3===c[0].nodeType&&c[0].nodeValue==h.Rte.HIDDEN_CHAR)?
!0:!1;if(c)return b.dom.remove(j[0],!1),i(b,f,!0),d.dom.Event.cancel(a)}}return!0})}}});require("confluence/module-exporter").safeRequire("confluence-editor/oninit/tinymce-cursor-fixes",function(e){var d=require("ajs"),h=require("jquery");d.Rte=d.Rte||{};d.Rte.Cursor=d.Rte.Cursor||{};h.extend(d.Rte.Cursor,{insertParagraph:e.insertParagraph,isCursorAtStart:e.isCursorAtStart,isCursorAtEnd:e.isCursorAtEnd});d.bind("init.rte",e.bindCursorFixes)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/highlightnode/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/highlightnode/editor_plugin_src",["jquery","ajs","document","tinymce"],function(b,a,g,f){return{init:function(f){a.debug("Hightlight Current Node Plugin");var j="strong em u s sub sup a code h1 h2 h3 h4 h5 h6 pre".split(" "),h={strong:"Bold",em:"Italic",u:"Underline",s:"Strikethrough",sub:"subscript",sup:"superscript"};f.onNodeChange.add(function(c,e,d){var e=b(d),a=b(".highlight-marker",c.getBody()),c=-1!=b.inArray(d.nodeName.toLowerCase(),j)&&!(d.nodeName.toLowerCase()in
h&&!c.queryCommandState(h[d.nodeName.toLowerCase()]))&&!(!(d.nodeName.toLowerCase()in h)&&!c.formatter.match(d.nodeName.toLowerCase()));if(!e.hasClass("highlight-marker")||!c)a&&a.removeClass("highlight-marker"),c&&e.addClass("highlight-marker")});var i=function(c){b(".highlight-marker",c).each(function(){b(this).removeClass("highlight-marker")})};b(g).bind("mode-changed",function(c,a){"preview"===a&&i(b("iframe").contents().find("#content"))});f.onSaveContent.add(function(a,e){var d=b("<div>"+e.content+
"</div>");i(d);e.content=d[0].innerHTML})},getInfo:function(){return{longname:"Atlassian Show Current Node",author:"Atlassian",authorurl:"http://www.atlassian.com",version:f.majorVersion+"."+f.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/highlightnode/editor_plugin_src",function(b){var a=require("tinymce"),g=require("ajs");a.create("tinymce.plugins.ShowCurrentNode",b);g.DarkFeatures.isEnabled("highlightnode")&&a.PluginManager.add("highlightnode",a.plugins.ShowCurrentNode)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/iosediting/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/iosediting/editor_plugin_src",["jquery","ajs","tinymce"],function(b,a,c){return{init:function(){c.isIDevice&&setTimeout(function(){b(a.Rte.getEditor().getBody()).addClass("ios")},0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:c.majorVersion+"."+c.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/iosediting/editor_plugin_src",function(b){var a=require("tinymce");a.create("tinymce.plugins.iOSEditing",b);a.PluginManager.add("iosediting",a.plugins.iOSEditing)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/overrides/dom-utils.js' */
define("confluence-editor/tinymce3/overrides/dom-utils",["ajs","jquery"],function(b,d){return{getRoot:function(){var a=b.Rte.getEditor(),e=a.dom,c=e.settings;if(!(c=c&&e.get(c.root_element)))a=d(a.selection.getNode()).closest("div.innerCell"),c=0<a.length?a[0]:e.doc.body;return c},setRoot:function(a){b.Rte.getEditor().dom.settings.root_element=a}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/overrides/dom-utils",function(b){var d=require("tinymce");d.dom.DOMUtils.prototype.getRoot=b.getRoot;d.dom.DOMUtils.prototype.setRoot=b.setRoot});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'toolbar/toolbar-configuration-manager.js' */
define("confluence-editor/toolbar/toolbar-configuration-manager",["jquery"],function(e){return function(c){var d={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",
SearchReplace:".rte-toolbar-group-searchreplace",Help:".rte-toolbar-group-help"};return{configureToolbar:function(a){if(!1===a)c.hide();else{var a=a||{},b;for(b in a)a.hasOwnProperty(b)&&d[b]&&!1===a[b]&&e(d[b],c).hide()}}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/toolbar/toolbar-configuration-manager","AJS.Confluence._ToolbarConfigurationManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'loader/tinymce-bootstrap.js' */
define("confluence-editor/loader/tinymce-bootstrap","ajs underscore jquery document confluence/meta confluence/performance-session confluence-editor/support/atlassian-editor-support".split(" "),function(b,q,c,i,j,p,r){var n={atlassian:true,keep_values:true,convert_urls:true,relative_urls:false,remove_script_host:false,button_tile_map:true,gecko_spellcheck:true,apply_source_formatting:false,list_outdent_on_enter:true,visual:false,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",
confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:true,cleanup:true,cleanup_on_startup:true,fix_list_elements:false,fix_table_elements:true,valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,div[*],span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",
extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:true,expand:false,block_expand:true,deep:true,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:true,expand:false,
block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:false,expand:false,deep:true},{selector:"*",attributes:["style","color","bgcolor","title","lang"],split:false,expand:false,deep:true}]},forced_root_block:"p",force_p_newlines:true,force_br_newlines:false,oninit:"AJS.Rte.BootstrapManager.onInit",object_resizing:false,paste_preprocess:function(a,b){c(i).trigger("prePaste",
[a,b])},paste_postprocess:function(a,b){c("img",b.node).not("[data-emoticon-name]").not(".editor-inline-macro").not(".confluence-embedded-image").not(".template-variable").addClass("confluence-embedded-image confluence-external-resource");c(i).trigger("postPaste",[a,b])}};return{_tinyMceHasInit:false,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:function(){return this._tinyMceHasInit},isEditorActive:function(){var a=require("tinymce");return this.isInitComplete()&&a&&
a.activeEditor},onInit:function(){this._tinyMceHasInit=true;var a=b.Rte.getEditor();c(a.getBody()).addClass("notranslate");b.trigger("init.rte",{editor:a});b.Meta.get("editor-auto-focus")!==false?b.Rte.editorFocus(a):b.debug("Bootstrap: editor-auto-focus=false. Do not focus the editor automatically.")},addOnInitCallback:function(a){if(c.isFunction(a))this._tinyMceHasInit?a():b.bind("init.rte",a);else throw Error("Attempt made to register an oninit callback that is not a function. Received: "+a);},
addBeforeInitCallback:function(a){this._beforeInitCallbacks.push(a)},addTinyMcePluginInit:function(a){this._tinymcePluginInits.push(a)},preInitialise:function(a){this._settings=c.extend(n,a)},initialise:function(a){p.debugTime("confluence.editor.tinymce");var k=require("tinymce");if(this._settings){var a=c.extend({},a),e=c.extend({},this._settings);b.Rte.isQuickEdit=a.isQuickEdit||false;b.debug("Bootstrap:initialise: Initialising TinyMce version "+k.majorVersion+"."+k.minorVersion);c.each(this._beforeInitCallbacks,
function(a,b){b(e)});b.trigger("rte-pre-resolveplugins");for(var d=0,h=this._tinymcePluginInits.length;d<h;d++)if(typeof this._tinymcePluginInits[d]==="function")this._tinymcePluginInits[d](e);var d=e.language,h=require("tinymce"),g=require("confluence-editor/i18n/translations.i18n");b.debug("Bootstrap: set locale translations");typeof g==void 0&&b.log("ERROR: could not find the TinyMCE language pack");var i=RegExp(g.ctrl_key+"\\+","g"),n=RegExp(g.shift_key+"\\+","g"),o=function(a){return a.replace(i,
"\u2318").replace(n,"\u21e7")},f;for(f in g){var l=g[f];if(typeof l==="object")for(var m in l)h.isMac&&(l[m]=o(l[m]));h.EditorManager.addI18n(d+"."+f,g[f])}h.isMac&&c("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button").each(function(){var a=c(this),b=a.attr("title"),d=a.attr("data-tooltip");b&&a.attr("title",o(b));d&&a.attr("data-tooltip",o(d))});(new b.Confluence._ToolbarConfigurationManager(c("#toolbar"))).configureToolbar(a.toolbar);f=a.plugins;m=a.excludePlugins;
d=e.plugins.split(",");d=q.chain(d).union(f).difference(m).value();f=d.join(",");e.plugins=f;e.setup=a.onInitialise;if(j.getBoolean("shared-drafts")&&(j.get("content-type")==="page"||j.get("content-type")==="blogpost")&&j.get("edit-mode")!=="limited")e.iframe_attr={"data-synchrony":"true"};k.init(e);b.Rte.Content.editorResetContentChanged();c(b.Rte.getEditorFrame()).attr("tabindex",100);k.isIE&&c(b.Rte.getEditorFrame()).attr("hidefocus","hidefocus");p.debugTimeEnd("confluence.editor.tinymce");b.trigger("rte-ready");
r.isCollaborativeContentType()&&b.trigger("rte-begin-collab-editing")}else b.log("Bootstrap:initialise: No settings found. Has preInitialise been called?")}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/loader/tinymce-bootstrap","AJS.Rte.BootstrapManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/environment.js' */
define("confluence-editor/utils/environment",["ajs"],function(b){return{isMac:0<=navigator.platform.indexOf("Mac"),transformCmdKeyTextBasingOnOS:function(a){var c="Ctrl";return this.isMac?a.replace(RegExp(c,"g"),"\u2318"):a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/editor-utils.js' */
define("confluence-editor/utils/editor-utils",["jquery","tinymce"],function(g,e){var f={isCursorAtStartOf:function(b,a){return a.collapsed&&f.isRangeAtStartOf(b,a)},isRangeAtStartOf:function(b,a){if(!a||!a.startContainer)throw Error("range is invalid. received: "+a);if(!b||!b.nodeType)throw Error("context is invalid. received: "+b);var c=a.startContainer,d;if(3===c.nodeType){if(0!==a.startOffset)return!1;d=c}else if(d=c.childNodes[a.startOffset],void 0===d&&0<c.childNodes.length)return!1;c=new e.dom.TreeWalker(d,
b);do d=c.prev(!0);while(d&&3===d.nodeType&&0===d.nodeValue.length);return void 0===d},isCursorAtEndOf:function(b,a){return a.collapsed&&f.isRangeAtEndOf(b,a)},isRangeAtEndOf:function(b,a){if(!a||!a.endContainer)throw Error("range is invalid. received: "+a);if(!b||!b.nodeType)throw Error("container is invalid. received: "+b);var c=a.endContainer;if(3===c.nodeType){if(a.endOffset!=c.nodeValue.length)return!1}else c=c.childNodes[0===a.endOffset?a.endOffset:a.endOffset-1];var c=new e.dom.TreeWalker(c,
b),d;do d=c.next(!0);while(d&&3===d.nodeType&&0===d.nodeValue.length);return void 0===d||"BR"===d.nodeName&&void 0===c.next(!0)},setCursorAtStartOfContents:function(b){if(!b)throw Error("element is required.");if(1!==b.nodeType&&3!==b.nodeType)throw Error("invalid argument: expected a DOM element or text node, got: "+b);var a=e.activeEditor,c=a.dom.createRng();g(b).is("br, img")?(c.setStartBefore(b),c.setEndBefore(b),a.selection.setRng(c)):(a.selection.select(b,!0),a.selection.collapse(!0))}};return f});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/utils/editor-utils","AJS.EditorUtils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/table/atlassian-table.js' */
define("confluence-editor/tinymce3/plugins/table/atlassian-table",["jquery","ajs","tinymce"],function(g,h,l){function p(){return g("#table-highlight-group").attr("data-highlight-colour")||""}function q(c){var j,g,d;j=0;for(g=c.length;j<g;j++)d=c.eq(j),d.attr("data-highlight-colour")&&d.removeAttr("data-highlight-colour"),d[0].className=d[0].className.replace(/( |^)highlight(-\w+)+/g,"")}function n(c,j){if(c.length){var f=h.Rte.getEditor(),d;d=g(h.Rte.getEditor().selection.getNode());d=d.length?d[0]===
c[0]?!0:!!d.closest(c).length:!1;for(var e=c[0],k=e.ownerDocument.createElement(j),i=e.attributes,m=0,l=i.length;m<l;m++){var a=i[m];k.setAttribute(a.nodeName,a.nodeValue)}for(;e.hasChildNodes();)k.appendChild(e.firstChild);e.parentNode.replaceChild(k,e);d&&(f.selection.select(k,!0),f.selection.collapse());return g(k)}}function o(){g(h.Rte.getEditor().getDoc().body).find(".confluenceTd.numberingColumn").attr("contenteditable","false")}var i={convertToNormalCells:function(c){c.filter("th").each(function(){var c=
g(this),c=n(c,"td");c.removeClass("confluenceTh");c.addClass("confluenceTd")})},convertToHeadingCells:function(c){c.filter("td").each(function(){var c=g(this),c=n(c,"th");c.removeClass("confluenceTd");c.addClass("confluenceTh")})},areCellsHeadings:function(c){var g=c.filter("th").length;return c.length===g},isColumnHeading:function(c,j){var f=g(c).children("tbody").children("tr");return 1===f.length?!1:f.children().nthCol(j).filter("th").length===f.length},areCellsHighlighted:function(c){var g=c.filter("td[data-highlight-colour],th[data-highlight-colour]");
if(c=c.length===g.length)a:{var c=p(),f,d,e;f=0;for(d=g.length;f<d;f++)if(e=g.eq(f).attr("data-highlight-colour")||"",e!==c){c=!1;break a}c=!0}return c},isColumnHighlighted:function(c,h){var f=g(c).children("tbody").children("tr").children("th,td").nthCol(h),d=f.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(f.length!==d)return!1;for(var d=f.eq(0).attr("data-highlight-colour"),e=1,i=f.length;e<i;e++)if(d!==f.eq(e).attr("data-highlight-colour"))return!1;return!0}};h.bind("init.rte",
function(c,j){function f(){var a=e.selection.getNode();return g(a).parents("table").is(".confluenceTable")?!e.dom.getParent(a,"UL,OL"):!1}var d,e=j.editor,k=function(a){return g(a.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},n=function(a){var b=g(a.getBody()).find("th.confluenceTh.mceSelected,td.confluenceTd.mceSelected");return b.length?b:k(a)},m=function(a){return 0===a.find("tbody > tr > td").length};e.addCommand("mceInsertTable",function(){h.Rte.BookmarkManager.storeBookmark();
if(!d){d=new h.Dialog({width:400,height:230,id:"insert-table-dialog",keypressListener:function(b){27===b.keyCode&&d.hide()}});d.addHeader("Insert Table");d.addPanel("Panel 1","panel1");d.getCurrentPanel().html(h.renderTemplate("tableForm","4","3"));g("#tinymce-table-form input[type='text']").click(function(){g(this).select()});var a=function(b){b.hide();e.plugins.table.insertTable()};g("#tinymce-table-form").keypress(function(b){13===b.keyCode&&a(d)});d.addButton("Insert",a,"ok");d.addCancel("Cancel",
function(b){b.hide();return!1},"cancel")}d.show()});e.addCommand("confTableRowToggleHeading",function(){var a;a=g(this.getBody()).find("td.mceSelected,th.mceSelected");a.length||(a=g(this.selection.getNode()));a=a.closest("tr");for(var b=a.parent(),b=b.is("tbody")?a.parent().parent():b;0!==a.length&&!b.is(".confluenceTable");)a=b.closest("tr"),b=a.parent(),b=b.is("tbody")?a.parent().parent():b;var b=a.children("td,th"),c=0;i.areCellsHeadings(b)?(m(a.closest("table"))||(b=b.filter(function(){var b=
g(this),a=b.closest("table");c+=b.attr("colspan")||1;return!i.isColumnHeading(a,c)})),i.convertToNormalCells(b)):i.convertToHeadingCells(b)});e.addCommand("confTableColumnToggleHeading",function(){var a;a=n(this);var b=g([]);a.each(function(){var a=g(this),c=a.index()+1,a=a.closest("table.confluenceTable").children("tbody").children("tr");b=b.add(a.children().nthCol(c))});a=b;i.areCellsHeadings(a)?(m(a.closest("table"))||(a=a.filter(function(){var a=g(this).parent("tr").children(),b=a.filter("th");
return a.length!==b.length})),i.convertToNormalCells(a)):i.convertToHeadingCells(a)});e.addCommand("confTableSelectionToggleHighlight",function(a,b){var c=b&&b.alwaysHighlight,e=n(this);e.filter("td");e.filter("th");i.areCellsHighlighted(e)&&!c||g("#table-highlight-group").attr("data-remove-highlight")?q(e):(q(e),p()&&(c=p(),e.attr("data-highlight-colour",c),e.addClass("highlight-"+c)))});(l.isIE8||h.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row"))&&e.onKeyDown.add(function(a,b){function c(a,
b){var d=e.selection.getRng(!0),g=d.startContainer;if(d.collapsed){var f;a:{for(f=g;f!=a;){if(f[b]){f=!1;break a}f=f.parentNode}f=!0}return 3===g.nodeType?f&&d.startOffset==("nextSibling"==b?g.length:0):g==a?d.startOffset==("nextSibling"==b?g.childNodes.length-1:0):f}return!1}if((37===b.keyCode||39===b.keyCode)&&!b.shiftKey){var d=k(this);if(d.length){var d=d[0],f;if(f=37===b.keyCode)if(f=c(d,"previousSibling"))f=e.selection.getNode(),f=g(f).parents("table").first().find("tr:first-child").children().first()[0]!=
f;if(f)return e.execCommand("mceTableMoveCaretToPrevCell"),l.dom.Event.cancel(b);if(f=39===b.keyCode){if(d=c(d,"nextSibling"))d=e.selection.getNode(),d=g(d).parents("table").first().find("tr:last-child").children().last()[0]!=d;f=d}if(f)return e.execCommand("mceTableMoveCaretToNextCell"),l.dom.Event.cancel(b)}}});if(l.isWebKit){var o=g('<style type="text/css"></style>').html(".confluenceTable th,td { white-space: pre-wrap; }");g(e.getDoc().head).append(o)}e.onKeyDown.add(function(a,b){if(9===b.keyCode&&
f())return e.execCommand(b.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell"),b.preventDefault(),!1});h.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row")&&(e.onClick.add(function(){var a=k(this);a.hasClass("numberingColumn")&&!a.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")}),e.onKeyDown.addToTop(function(a,b){if((38===b.keyCode||40===b.keyCode)&&f()&&k(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),
b.preventDefault(),!1}))});h.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row")&&(h.bind("quickedit.success",o),h.bind("init.rte",o));return i});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/table/atlassian-table","AJS.Rte.Table");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/table/atlassian-table-picker.js' */
define("confluence-editor/tinymce3/plugins/table/atlassian-table-picker",["ajs","tinymce","jquery","document"],function(c,E,g,O){function F(){e.css({top:g("#insert-table-dropdown").outerHeight(!0)});F=function(){}}function j(){if(!e.hasClass("hidden")){var a=g(c.Rte.getEditor().getDoc());k.unbind(".atlassian-table-picker");a.unbind(".atlassian-table-picker");e.addClass("hidden");q.addClass("hidden");y.removeClass("active")}}function G(a,b){c.debugEnabled()&&c.debug("setSize("+[a,b]+")");a==f&&b==
r||(a=Math.max(1,Math.min(H,a)),b=Math.max(1,Math.min(I,b)),n=Math.max(P,a),s=Math.max(Q,b),f=a,r=b,t.width(n*l+1),t.height(s*m+R),u(o,n,s),u(z,f,r),u(A,n,1),u(v,f,1),J(),K.text(f+" x "+r))}function J(){A.toggleClass("hidden",!h);v.toggleClass("hidden",!h)}function u(a,b,c){a.width(l*b+1);a.height(m*c+1)}function S(a){var b=o.offset(),d=b.top-k.scrollTop(),g=b.left-k.scrollLeft(),b=d+o.outerHeight(!0)+w,e=b-m-w,h=g+o.outerWidth(!0)+w,j=h-l-w,f=a.clientY,i=a.clientX,a=n,p=s;c.debugEnabled()&&c.debug("[mouseX,spLeft,spRightShrink,spRightGrow][mouseY,spTop,spBottomShrink,spBottomGrow] = "+
[i,g,j,h]+"/"+[f,d,e,b]);i>h?(d=~~((i-h)/l+1),a+=d,c.debugEnabled()&&c.debug("grow: xdelta = "+d)):i<j&&(d=~~((i-j)/l-1),a+=d,c.debugEnabled()&&c.debug("shrink: xdelta = "+d));f>b?(d=~~((f-b)/m+1),p+=d,c.debugEnabled()&&c.debug("grow: ydelta = "+d)):f<e&&(d=~~((f-e)/m-1),p+=d,c.debugEnabled()&&c.debug("shrink: ydelta = "+d));G(a,p)}function L(a){c.debugEnabled()&&c.debug("enableHeading("+a+")");a!=h&&(h=a,J())}function B(a){var b;b=~~(~~(a.offsetX||a.originalEvent.layerX)/l)+1;var d=~~(~~(a.offsetY||
a.originalEvent.layerY)/m)+1;b=1>b||b>H||1>d||d>I?null:{width:b,height:d};a.preventDefault();c.debug("insertTable: size = "+(b&&[b.width,b.height]));if(b){j();a=b.width;d=b.height;b=h;var e,f;c.debugEnabled()&&c.debug("shamefulInsertTable("+a+","+d+","+b+")");e=g("#tinymce-table-form");e.length?(e.find('input[name="rows"]').val(d),e.find('input[name="cols"]').val(a)):(a=c.renderTemplate("tableForm",d,a),f=g("<div></div>").addClass("hidden"),f.append(a),M.append(f));g("#table-heading-checkbox").prop("checked",
b);c.Rte.BookmarkManager.restoreBookmark();E.activeEditor.undoManager.beforeChange();E.activeEditor.plugins.table.insertTable();f&&f.remove()}}function x(a){c.debugEnabled()&&c.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);c.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);g.browser.msie?(16===a.keyCode&&L(!a.shiftKey),27===a.keyCode&&j()):(0===a.charCode&&L(!a.shiftKey),27===a.keyCode&&0===a.charCode&&j())}function T(){j()}var N={},k,M,q,i,C,y,e,t,o,A,z,v,K,P=4,Q=4,H=15,I=20,l=25,
m=17,R=20,w=0,n,s,f,r,h,D=!1;N.insertTable=B;return{bindToControl:function(){c.debugEnabled()&&c.debug("Table Picker - bind to control");k=g(O);M=k.find("body");i=g("#insert-table-dropdown");C=g("#rte-button-insert-table");y=i.find(".aui-dd-parent");e=g("#table-picker-container");t=e.find(".table-picker-box");o=e.find(".picker-cell");A=e.find(".picker-heading");z=e.find(".picker-selected-cell");v=e.find(".picker-selected-heading");K=t.find(".desc");q=g("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(i);
C.click(function(a){a.preventDefault();D||(c.Rte.BookmarkManager.storeBookmark(),F(),h=!0,G(1,1),a=g(c.Rte.getEditor().getDoc()),k.bind("mousemove.atlassian-table-picker",S),k.bind("keydown.atlassian-table-picker",x),k.bind("keyup.atlassian-table-picker",x),a.bind("keydown.atlassian-table-picker",x),a.bind("keyup.atlassian-table-picker",x),q.removeClass("hidden"),e.removeClass("hidden"),y.addClass("active"),C.focus())});q.click(T);z.click(B);v.click(B)},disable:function(){D=!0;i.addClass("disabled")},
enable:function(){D=!1;i.removeClass("disabled")},close:j,_internal:N}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/table/atlassian-table-picker","AJS.Rte.TablePicker");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/table/atlassian-table-migration.js' */
define("confluence-editor/tinymce3/plugins/table/atlassian-table-migration",["ajs","jquery","confluence-editor/tinymce3/plugins/table/atlassian-table"],function(b,f,g){return function(d){var d=d||f(b.Rte.getEditor().getBody()),h=(new Date).getTime(),e=d.find("td.highlight,th.nohighlight,td[data-highlight-class],th[data-highlight-class]"),d=(new Date).getTime();e.each(function(){var a=f(this),b=a.attr("data-highlight-class"),c;if(a.hasClass("nohighlight"))a.removeClass("nohighlight"),g.convertToNormalCells(a);
else if(a.hasClass("highlight")&&(a.removeClass("highlight"),b||(a.attr("data-highlight-colour","grey"),a.addClass("highlight-grey"))),b){a.removeClass(b);a.removeAttr("data-highlight-class");switch(b){case "warning":c="red";break;case "success":c="green";break;case "note":c="yellow";break;case "info":c="blue"}c&&(a.addClass("highlight-"+c),a.attr("data-highlight-colour",c))}});e=(new Date).getTime();b.debug("Migration duration: selector: "+(d-h)+"ms; migration: "+(e-d)+"ms")}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/table/atlassian-table-migration","AJS.Rte.Migration.Table.migrateTables",function(){var b=require("ajs");require("jquery")(document).bind("postPaste",function(){b.Rte.Migration.Table.migrateTables()});b.bind("init.rte",function(){b.Rte.Migration.Table.migrateTables()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/tablecontentwrapper/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/tablecontentwrapper/editor_plugin_src",["jquery","ajs","tinymce"],function(d,f){var h=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(",");return{init:function(g){f.bind("rte-ready",function(){d(g.dom.select("table.confluenceTable:not(.wrapped)")).each(function(c,b){d(b).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each(function(b,
a){var c=d(a);!c.find("> .content-wrapper").length&&c.find(h).length&&c.wrapInner("<div class='content-wrapper'>")})})});g.onChange.add(function(){var c=g.selection,b=c.getNode(),e=d(b);if(b&&e.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){b=c.getRng();if(e.is("tr")&&d(b.startContainer).is("tr")&&b.collapsed){var a=e.find(">td, >th").first(),a=a.find(":first-child:not(.content-wrapper)")[0]||a[0].firstChild;b.setStart(a,0);b.setEnd(a,0);c.setRng(b)}a=
e.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(a.find(h).length){b=a.find("> .content-wrapper");if(b.length){e=c.getBookmark();for(a=0;a<b.length;a++)b.eq(a).find("> p, > table, > ul, > ol").length||b.eq(a).wrapInner("<p/>"),0<a&&(b.eq(0).append(b.eq(a).children()),b.eq(a).remove())}else a.find("> p").length?(e=c.getBookmark(),a.wrapInner("<div class='content-wrapper'>")):(e=c.getBookmark(),a.wrapInner("<p/>").wrapInner("<div class='content-wrapper'>"));
c.moveToBookmark(e);f.Rte.BookmarkManager.storeBookmark()}}d(g.getWin().document).find(".content-wrapper:empty").remove()})},getInfo:function(){return{longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/tablecontentwrapper/editor_plugin_src",function(d){var f=require("tinymce");require("ajs").DarkFeatures.isEnabled("confluence.table.resizable")&&(f.create("tinymce.plugins.TableContentWrapperPlugin",d),f.PluginManager.add("tableContentWrapper",f.plugins.TableContentWrapperPlugin))});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/tableanalytics/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/tableanalytics/editor_plugin_src",["jquery","ajs","tinymce","confluence/analytics-support"],function(d,b,g,e){var f;return{init:function(a){var c=this;f=a;a.onExecCommand.add(function(a,b,e,d){switch(b){case "mceAutoWidth":case "mceRelativeWidth":case "mceFixedWidth":c._onChangeTableMode();break;case "mceTableCopyRow":c._onCopyRow();break;case "mceTablePasteRowBefore":case "mceTablePasteRowAfter":c._onPasteRow();break;case "mceTableCopyCol":c._onCopyCol();
break;case "mceTablePasteColBefore":case "mceTablePasteColAfter":c._onPasteCol();break;case "mceInsertContent":c._onInsertContent(d)}});a.onInit.add(function(){a.selection.onSetContent.add(function(a,b){c._isInsideTable()&&b&&c._onSetContent(b)})});b.bind("analyticsEvent",function(a,b){c._isInsideTable()&&c._onResizeImg(b)});b.bind("rte.safe-save.success",function(){c._onSavePage()})},_onChangeTableMode:function(){e.publish("confluence.table.mode.to."+this._getTableMode(),{pageId:b.Meta.get("page-id")})},
_onCopyRow:function(){e.publish("confluence.table.row.copy",{pageId:b.Meta.get("page-id")})},_onPasteRow:function(){e.publish("confluence.table.row.paste",{pageId:b.Meta.get("page-id")})},_onCopyCol:function(){e.publish("confluence.table.col.copy",{pageId:b.Meta.get("page-id")})},_onPasteCol:function(){e.publish("confluence.table.col.paste",{pageId:b.Meta.get("page-id")})},_onInsertContent:function(a){a=d("<div/>").html(a);a.find("img").length&&this._isInsideTable()&&this._eventInsertImage();a.find("table.confluenceTable").length&&
e.publish("confluence.table.paste",{pageId:b.Meta.get("page-id")})},_onSetContent:function(a){d("<div/>").html(a.content).find(".confluence-embedded-image")&&this._eventInsertImage()},_onResizeImg:function(a){var c=function(){var a=d(f.selection.getNode()),b=a.closest("th, td");return a.width()>b.width()};a&&(a.name&&0<=a.name.indexOf("confluence.editor.image.resize"))&&e.publish("confluence.table.img.resize",{pageId:b.Meta.get("page-id"),tableMode:this._getTableMode(),isImgBiggerCell:c()})},_eventInsertImage:function(){e.publish("confluence.table.image.insert",
{pageId:b.Meta.get("page-id"),tableMode:this._getTableMode()})},_isInsideTable:function(){return!!d(f.selection.getNode()).closest("table.confluenceTable").length},_getTableMode:function(){var a=d(f.selection.getNode()).closest("table.confluenceTable");return a.hasClass("fixed-table")?"fixed":a.hasClass("relative-table")?"relative":"fluid"},_onSavePage:function(){var a=d(f.getBody()).find("table.confluenceTable");e.publish("confluence.table.quality.in.page",{pageId:b.Meta.get("page-id"),total:a.length,
fixed:a.filter(".fixed-table").length,fluid:a.filter(":not(.fixed-table,.relative-table)").length,relative:a.filter(".relative-table").length,nested:a.find("table.confluenceTable").length})},getInfo:function(){return{longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/tableanalytics/editor_plugin_src",function(d){var b=require("tinymce");b.create("tinymce.plugins.TableAnalytics",d);b.PluginManager.add("tableAnalytics",b.plugins.TableAnalytics)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/placeholder/editor_plugin_src",["jquery","ajs","tinymce"],function(f,d,i){var p={click:!1,keypress:!0},g=i.VK,j=i.dom.Event,q="template"===d.Meta.get("content-type"),m={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};return{init:function(k){k.onInit.add(function(){if(q)d.trigger("cursor-target-refresh"),f("#rte-button-insert-placeholder").click(function(b){b.preventDefault();d.Rte.Placeholder.insertTextPlaceHolder()}),k.onKeyPress.addToTop(function(b,c){if(13===c.keyCode&&
!c.shiftKey){var a=b.selection.getNode(),e=f(a).closest(".text-placeholder");if(e.length&&d.Rte.Cursor.isCursorAtEnd(b,b.selection.getRng(),a))return d.Rte.Cursor.insertParagraph(b,e,!0),i.dom.Event.cancel(c)}});else{var r=function(){var b=f(d.Rte.getEditor().getBody()).find(".text-placeholder.selected");b.length&&d.Rte.getEditor().selection.select(b[0])},l=function(b){b.onKeyDown.remove(n);b.onKeyPress.remove(h);b.onClick.remove(h)},n=function(b,c){var a=f(b.getBody()).find(".text-placeholder.selected");
if(a.length){if(c.keyCode===g.LEFT||c.keyCode===g.UP){for(var a=a[0],e=a.previousSibling;a&&!e;)a=a.parentNode,e=a.previousSibling;if(e){for(a=e;m[a.nodeName]&&a.lastChild;)a=a.lastChild;b.selection.select(a.lastChild||a);b.selection.collapse(!1);b.selection.normalize()}return j.cancel(c)}if(c.keyCode===g.RIGHT||c.keyCode===g.DOWN){a=a[0];for(e=a.nextSibling;a&&!e;)a=a.parentNode,e=a.nextSibling;if(e){for(a=e;m[a.nodeName]&&a.firstChild;)a=a.firstChild;b.selection.select(a.firstChild||a);b.selection.collapse(!0);
b.selection.normalize()}return j.cancel(c)}if(c.keyCode===g.BACKSPACE||c.keyCode===g.DELETE)return d.Rte.Placeholder.removePlaceholder(a),j.cancel(c)}else l(b)},h=function(b,c){if(!i.isGecko||c.isChar||"keypress"!==c.type){var a=f(b.getBody()).find(".text-placeholder.selected");if(a.length){if(a.length){var e=a.attr("data-placeholder-type"),g=c.type,h=d.Rte.Placeholder.getPlaceholderType(e);f.extend({},p,h&&h.activation)[g]&&(d.Rte.Placeholder.removePlaceholder(a),d.trigger("editor.text-placeholder.activated",
{placeholderType:e||"",triggerEvent:c}))}}else l(b)}};k.onNodeChange.addToTop(function(b,c,a){c=f(a).closest(".text-placeholder");f(b.getBody()).find(".text-placeholder.selected").not(c).removeClass("selected");c.length?(c.hasClass("selected")||(c.addClass("selected"),b.onKeyDown.addToTop(n),b.onKeyPress.addToTop(h),b.onClick.addToTop(h)),setTimeout(r,0)):l(b)})}var o=f(d.Rte.getEditor().getDoc()).find("head");f.browser.msie?o.append('<style type="text/css">.wiki-content .text-placeholder { display: inline; }</style>'):
o.append('<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>')})},getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/placeholder/editor_plugin_src",function(f){var d=require("tinymce");d.create("tinymce.plugins.TextPlaceholderPlugin",f);d.PluginManager.add("textplaceholders",d.plugins.TextPlaceholderPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/placeholder.js' */
define("confluence-editor/tinymce3/plugins/placeholder/placeholder",["jquery","ajs","tinymce"],function(e,b,f){var d=[],i={};b.Rte=b.Rte||{};b.Rte.Placeholder=b.Rte.Placeholder||{};var g,h;f.isIE?(g="\ufeff{$caret}",h="<p>{$caret}</p>"):h=g=f.isWebKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";return{insertTextPlaceHolder:function(a){var c=e("<div></div>").append(b.Rte.Placeholder.Templates.textPlaceholder({content:g}));a&&c.find(".text-placeholder").html(a);b.Rte.getEditor().execCommand("mceInsertContent",
false,c.html())},removePlaceholder:function(a){var c=b.Rte.getEditor(),f=e(c.getBody()),d=g;a.parent()[0].nodeName==="LI"&&(d=h);a.replaceWith('<span id="placeholder-cursor">&nbsp;</span>');a=f.find("#placeholder-cursor")[0];c.selection.select(a.firstChild);c.execCommand("mceInsertContent",false,d);c.dom.remove(a,true)},addPlaceholderType:function(a){if(!a||!a.type)b.log("PlaceHolderRegister : unable to register new place holder type !");else{d.push(a);i[a.type]=a}},getPlaceholderTypes:function(){return[].concat(d)},
getPlaceholderType:function(a){return i[a]}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/placeholder/placeholder",function(e){require("jquery").extend(require("ajs").Rte.Placeholder,e)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/property-panel-text-placeholders.js' */
define("confluence-editor/tinymce3/plugins/placeholder/property-panel-text-placeholders",["jquery","ajs","confluence/property-panel"],function(e,a,h){return{name:"textplaceholder",canHandleElement:function(a){return a.hasClass("text-placeholder")},handle:function(b){function i(a,b,c){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-"+a,text:b,tooltip:c,selected:j===a,click:function(){"default"===a?f.removeAttr("data-placeholder-type"):f.attr("data-placeholder-type",
a);var b=e(".text-placeholder-property-panel-type-"+a);b.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected");b.addClass("selected")}}}if(!("click"!==b.e.type&&"mouseup"!==b.e.type)){var k=a.Rte.Placeholder.getPlaceholderTypes(),b=b.containerEl,f=e(b),j=f.attr("data-placeholder-type"),d=[],c=i("default","Text","Instructional text is replaced with empty content when a person types.");c.selected=!j;d.push(c);for(var g=
0,l=k.length;g<l;g++)c=k[g],d.push(i(c.type,c.label,c.tooltip));d.push(null);d.push({className:"text-placeholder-property-panel-remove-button",text:"Remove",click:function(){h.destroy();a.Rte.Placeholder.removePlaceholder(f)}});h.createFromButtonModel("textplaceholder",b,d,{anchorIframe:a.Rte.getEditorFrame()})}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/placeholder/property-panel-text-placeholders","AJS.Confluence.PropertyPanel.TextPlaceholder",function(e){var a=require("ajs");a.bind("init.rte",function(){"template"===a.Meta.get("content-type")&&a.trigger("add-handler.property-panel",e)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/placeholder.soy' */
// This file was automatically generated from placeholder.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace AJS.Rte.Placeholder.Templates.
 */

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Rte == 'undefined') { AJS.Rte = {}; }
if (typeof AJS.Rte.Placeholder == 'undefined') { AJS.Rte.Placeholder = {}; }
if (typeof AJS.Rte.Placeholder.Templates == 'undefined') { AJS.Rte.Placeholder.Templates = {}; }


AJS.Rte.Placeholder.Templates.textPlaceholder = function(opt_data, opt_ignored) {
  return '<span class="text-placeholder">' + opt_data.content + '</span>';
};
if (goog.DEBUG) {
  AJS.Rte.Placeholder.Templates.textPlaceholder.soyTemplateName = 'AJS.Rte.Placeholder.Templates.textPlaceholder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
define("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog",["jquery","ajs","confluence/dialog","confluence/property-panel"],function(d,a,p,l){function m(){f||(f=d("#image-properties-tab-items > div").map(function(){var e=d(this);return{key:e.text(),weight:e.attr("data-weight"),label:this.title}}).sort(function(e,b){return e.weight-b.weight}));return f}function n(){var e=c.popup.element,b=650/60,a=d('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(e.find(".dialog-page-body")),
g=a.find(".loading-data");a.css({width:a.parent().width(),height:e.height()});g.css({marginTop:-60,marginLeft:-60});g.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var e=[],h;for(h in i)b=i[h],(b=b.saveFn&&b.saveFn())&&b.done&&e.push(b);d.when.apply(d,e).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}
function q(){c.hide().remove()}var c,f,i={},o;return{init:function(){o||(f=null,0<m().length&&(o=!0,l.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"Properties",tooltip:"Set additional image properties",click:function(e,b){a.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});l.destroy();d("#image-properties-dialog").remove();c=new p.component({id:"image-properties-dialog",onSubmit:n});
a.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("Image Properties");c.addSubmit("Save",n);c.addCancel("Cancel",q);for(var f=c,g=m(),h=0;h<g.length;h++){var j=g[h],k=i[j.key];k&&f.addPanel(j.label,k.content,k.panelClass,j.key)}1===g.length&&f.popup.element.find(".dialog-page-menu").show();a.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog","Confluence.Editor.ImageProps",function(d){var a=require("ajs");a.toInit(d.init);a.bind("quickedit.success",d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.UnpublishedChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_ignored) {
  return '<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="' + soy.$$escapeHtml(opt_data.tooltip) + '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">' + soy.$$escapeHtml(opt_data.label) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.UnpublishedChanges.lozenge.soyTemplateName = 'Confluence.Templates.UnpublishedChanges.lozenge';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'unpublished-changes/unpublished-changes.js' */
define("confluence-editor/unpublished-changes/unpublished-changes","jquery confluence/templates confluence/legacy-editor-global-AVOID-IF-POSSIBLE ajs underscore tinymce".split(" "),function(d,f,k,g,i,h){return{init:function(a){var e=d(f.UnpublishedChanges.lozenge({tooltip:"This page has unpublished changes",label:"Unpublished"})),h=function(b){b=i.isBoolean(b)?b:true;k.UI.setButtonState(b,d("#rte-button-publish"))},j=function(b,
c){var a=c||function(){};(i.isBoolean(b)?b:1)?e.addClass("visible").fadeIn("fast",a):e.fadeOut("fast",function(){d(this).hide().removeClass("visible");a()})},c={show:function(){e.hasClass("visible")||j(true,h)},hide:function(){j(false);h(false)}};g.bind("rte-ready",function(){var b=d("#content-title-div");c.hide();e.insertBefore(b);e.tooltip();d("#content-title").on("keydown change",c.show);a.onChange.add(c.show);a.onKeyDown.add(c.show);a.onLoad.add(function(){d(a.startContent).text().trim()&&g.Meta.get("draft-id")>
0&&c.show()});e.on("mouseenter.tipsy",function(){g.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});a.addCommand("mceConf.UnpublishedChangesLozenge.show",c.show);a.addCommand("mceConf.UnpublishedChangesLozenge.hide",c.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/unpublished-changes/unpublished-changes",function(d){var f=require("tinymce");f.create("tinymce.plugins.UnpublishedChanges",d);f.PluginManager.add("unpublishedchanges",f.plugins.UnpublishedChanges)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/settings/tinymce-default-settings.js' */
define("confluence-editor/tinymce3/settings/tinymce-default-settings",[],function(){});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'loader/tinymce-adapter.js' */
define("confluence-editor/loader/tinymce-adapter","ajs jquery confluence/performance-session confluence-editor/profiles confluence/api/constants confluence/meta confluence-editor/support/atlassian-editor-support".split(" "),function(b,f,h,g,i,d,j){return function(){var a;a=b.contextPath();var c=["auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","aePaste","cursorTarget",
"confluencecleanupplugin","conftable","confluencepastetableplugin","confluencepastemacroplugin","pagelayoutplugin","highlightnode","iosediting","autoconvert","confluencelist","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics"];b.DarkFeatures.isEnabled("confluence.table.resizable")&&c.push("tableContentWrapper");a={autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:i.BASE_URL+"/",plugins:c.join(","),theme:"atlassian",
theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,confimage,conf_macro_browser,separator,code,customtoolbar,help,monospace,separator,searchreplace,linkbrowserButton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",
theme_advanced_resizing:false,theme_advanced_resize_horizontal:false,theme_advanced_statusbar_location:"none",theme_advanced_path:false,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"wiki-content",popup_css:false,content_css:false,editor_css:false,custom_undo_redo:true,custom_undo_redo_levels:20,context_path:a,plugin_action_base_path:a+"/plugins/tinymce",editor_plugin_action_base_path:a+"/plugins/editor/tinymce",
page_id:b.Meta.get("page-id"),draft_type:null,form_name:b.Meta.get("form-name"),space_key:encodeURI(b.Meta.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea"};if(a.page_id==0){a.page_id=null;a.draft_type=b.Meta.get("draft-type")}b.Rte.BootstrapManager.addBeforeInitCallback(function(a){a.contentCssTags=f("script[title='editor-css']").html();a.language=b.Meta.get("action-locale");var c=b.Meta.get("min-editor-height");if(c)a.autoresize_min_height=c});
if(c=!(b.Meta.get("remote-user")&&b.Meta.get("confluence.prefs.editor.disable.autocomplete")))a.plugins=a.plugins+",autocomplete,autocompletelink,autocompletemedia";if(b.Meta.get("auto-start")){var e=f("#"+a.editor_id);j.isCollaborativeContentType()&&b.trigger("rte-collaborative-content-ready",{title:d.get("page-title")||d.get("original-content-title")||"",editorContent:e.val(),confRev:d.get("conf-revision"),syncRev:f("#syncRev").val(),syncRevSource:d.get("sync-revision-source")});h.debugTime("confluence.editor");
if(c)a.plugins=a.plugins+",autocompletemacro";c=""+b.Meta.get("page-id")==="0";e=b.Meta.get("content-type");c=e==="template"?g.createProfileForTemplateEditor():e==="comment"?g.createProfileForCommentEditor():g.createProfileForPageEditor({versionComment:!c,notifyWatchers:!c});if(c=c.plugins.join(","))a.plugins=a.plugins+(","+c);b.Rte.BootstrapManager.preInitialise(a);b.Rte.BootstrapManager.initialise();h.debugTimeEnd("confluence.editor")}else b.Rte.BootstrapManager.preInitialise(a)}});
require("confluence/module-exporter").safeRequire("confluence-editor/loader/tinymce-adapter",function(b){require("ajs").toInit(b)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
define("confluence-editor/tinymceplugin/tinymce-adapter-deprecated",["ajs","confluence-link-browser/link-adapter","confluence-link-browser/link-object","jquery","tinymce"],function(a,g,h,i,e){return{putCursorAtPostionInElement:function(b,a,c){var d=e.activeEditor,j=d.getDoc(),b=i(b,c||j),b=b.contents().filter(function(){return 3===this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(b,a);c.setEnd(b,a);d.selection.setRng(c)},storeCurrentSelectionState:a.Rte.BookmarkManager.storeBookmark,restoreSelectionState:a.Rte.BookmarkManager.restoreBookmark,
insertLink:function(b,f){f&&a.Rte.getEditor().selection.select(f);g.setLink(b)},getCurrentBaseUrl:a.Rte.getCurrentBaseUrl,addOnInitCallback:function(b){a.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+a.Rte.BootstrapManager);a.Rte.BootstrapManager.addOnInitCallback(b)},bindScroll:function(b,f){a.Rte.bindScroll(b,f)},unbindScroll:function(b){a.Rte.unbindScroll(b)},getTinyMceHasInit:function(){return a.Rte.BootstrapManager.isInitComplete()},getEditor:a.Rte.getEditor,
addTinyMcePluginInit:function(b){a.Rte.BootstrapManager.addTinyMcePluginInit(b)},isExternalLink:function(a){return h.isExternalLink(a)},isInMacroPlaceholder:function(a){return e.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var b=a.Editor.Adapter;e.EditorManager.preInit.apply(e.EditorManager);e.EditorManager.init(b.settings)},offset:function(b){a.Rte.Content.offset(b)},getSelectedText:function(){return a.Rte.Content.getSelectedText()},setEditorValue:function(b){a.Rte.Content.setHtml(b)},
getEditorHTML:function(){return""+a.Rte.getEditor.getContent()},editorHasContentChanged:function(){return a.Rte.getEditor().isDirty()},editorResetContentChanged:function(){a.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,f){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==f)return d;return-1},getMainEditor:function(){return a.Rte.getMainEditor()},getEditorContainer:function(){return a.Rte.getEditorContainer()},getEditorFrame:function(){return a.Rte.getEditorFrame()},getEditorTable:function(){return a.Rte.getEditorTable()},
webResourcePath:a.Rte.webResourcePath,getResourceUrlPrefix:function(){return a.Rte.getResourceUrlPrefix()},getTinyMceBaseUrl:function(){return a.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return a.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(b){return a.Rte.getTinyMceEditorMinHeight(b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymceplugin/tinymce-adapter-deprecated","AJS.Editor.Adapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'analytics/editor-analytics.js' */
define("confluence-editor/analytics/editor-analytics",["ajs","jquery","window","confluence/analytics-support"],function(e,k,l,m){function d(a,i){if(a&&(c[a]?c[a]++:c[a]=1,i)){var b=a+"Size";c[b]=c[b]?c[b]+i:i}}function g(){c.pageID=e.Meta.get("page-id");m.publish("confluence.editor.action",c);c={};clearTimeout(f);f=setTimeout(g,j)}var j=6E4,f,c={},h=0,n={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",
confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",
mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",
mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",
mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"};return{bindAnalyticsToEditorCommands:function(){var a=require("tinymce");clearTimeout(f);f=setTimeout(g,j);a.activeEditor.onExecCommand.add(function(a,b){d(n[b])});a.activeEditor.onKeyPress.add(function(){d("keys")});
a.activeEditor.onKeyUp.add(function(a,b){46===b.keyCode?d("delete",h):8===b.keyCode&&d("backspace",h);h=a.selection.getContent().length});a.activeEditor.onMouseUp.add(function(a){h=a.selection.getContent().length});a.activeEditor.onPaste.add(function(a,b){d("paste",b.clipboardData.getData("text/plain").length)});a.activeEditor.onRemove.add(function(){g();clearTimeout(f)})},bindAnalyticsToIconClicks:function(){k("#rte-button-insert-table").on("click",function(){d("insert.table")})},bindAnalyticsPublishingToWindowUnload:function(){l.addEventListener("beforeunload",
function(){g()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/analytics/editor-analytics",function(e){require("ajs").bind("rte-ready",function(){e.bindAnalyticsToEditorCommands();e.bindAnalyticsToIconClicks();e.bindAnalyticsPublishingToWindowUnload()})});
}catch(e){WRMCB(e)};